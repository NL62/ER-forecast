2025-10-03 17:41:10 - root - INFO - Logging configured successfully
2025-10-03 17:41:10 - root - INFO - Log level: INFO
2025-10-03 17:41:10 - root - INFO - Console logging: enabled
2025-10-03 17:41:10 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 17:41:10 - src.monitoring.metrics_collector - INFO - Initializing metrics with default values...
2025-10-03 17:41:10 - src.monitoring.metrics_collector - INFO - Metrics initialization complete
2025-10-03 17:41:10 - src.monitoring.metrics_collector - INFO - Metrics server started on port 8000
2025-10-03 17:41:10 - src.monitoring.metrics_collector - INFO - Metrics available at http://0.0.0.0:8000/metrics
2025-10-03 17:41:10 - __main__ - INFO - Metrics server started successfully on port 8000
2025-10-03 17:42:32 - root - INFO - Logging configured successfully
2025-10-03 17:42:32 - root - INFO - Log level: INFO
2025-10-03 17:42:32 - root - INFO - Console logging: enabled
2025-10-03 17:42:32 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 17:42:32 - src.monitoring.metrics_collector - INFO - Initializing metrics with default values...
2025-10-03 17:42:32 - src.monitoring.metrics_collector - INFO - Metrics initialization complete
2025-10-03 17:42:32 - src.monitoring.metrics_collector - INFO - Metrics server started on port 8000
2025-10-03 17:42:32 - src.monitoring.metrics_collector - INFO - Metrics available at http://0.0.0.0:8000/metrics
2025-10-03 17:42:32 - __main__ - INFO - Metrics server running. Press Ctrl+C to stop.
2025-10-03 17:47:22 - root - INFO - Logging configured successfully
2025-10-03 17:47:22 - root - INFO - Log level: INFO
2025-10-03 17:47:22 - root - INFO - Console logging: enabled
2025-10-03 17:47:22 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 17:48:09 - root - INFO - Logging configured successfully
2025-10-03 17:48:09 - root - INFO - Log level: INFO
2025-10-03 17:48:09 - root - INFO - Console logging: enabled
2025-10-03 17:48:09 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 17:48:09 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 17:48:09 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=1cde1122-5616-46c2-bd30-946375fe163c "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:48:09 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 17:48:09 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 17:48:09 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/4084e352-3363-40d4-92f3-c71fbc72c5b3/set_state "HTTP/1.1 201 Created"
2025-10-03 17:48:09 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/4084e352-3363-40d4-92f3-c71fbc72c5b3 "HTTP/1.1 200 OK"
2025-10-03 17:48:09 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:48:09 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 17:48:09 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:48:10 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:48:10 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:48:10 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:48:10 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:48:10 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:48:10 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:48:10 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:48:10 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:48:10 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:48:10 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:48:10 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:48:10 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:48:10 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:48:10 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 17:48:10 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:48:10 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 17:48:10 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:48:10 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:48:10 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 17:48:10 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:48:10 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:48:10 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 17:48:11 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 17:48:11 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 17:48:11 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:48:11 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 17:48:11 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 17:48:11 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 17:48:11 - src.models.train - INFO - Features: 47
2025-10-03 17:48:11 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:48:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:48:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:48:12 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:48:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:48:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:48:12 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:48:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:48:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:48:12 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:48:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:48:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:48:13 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:48:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:48:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:48:13 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:48:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:48:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:48:13 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:48:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:48:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:48:14 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:48:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:48:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:48:14 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:48:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:48:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:48:15 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:48:15 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 17:48:15 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:48:15 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:48:15 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:48:15 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 17:48:15 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 17:48:15 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:48:15 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 17:48:15 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 17:48:15 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 17:48:15 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 17:48:15 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 17:48:15 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:48:15 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 17:48:15 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 17:48:15 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 17:48:15 - prefect.flow_runs - ERROR - Training flow failed: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:48:15 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - failure
2025-10-03 17:48:15 - prefect.flow_runs - ERROR - Encountered exception during execution: OSError(30, 'Read-only file system')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/training_flow.py", line 251, in training_flow
    mlflow.log_artifact(str(model_path))
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/fluent.py", line 1429, in log_artifact
    MlflowClient().log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/client.py", line 2497, in log_artifact
    self._tracking_client.log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/_tracking_service/client.py", line 674, in log_artifact
    artifact_repo.log_artifact(local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/store/artifact/local_artifact_repo.py", line 44, in log_artifact
    mkdir(artifact_dir)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 209, in mkdir
    raise e
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 206, in mkdir
    os.makedirs(target, exist_ok=True)
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  [Previous line repeated 1 more time]
  File "<frozen os>", line 225, in makedirs
OSError: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:48:15 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:48:15 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/4084e352-3363-40d4-92f3-c71fbc72c5b3/set_state "HTTP/1.1 201 Created"
2025-10-03 17:48:15 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/4084e352-3363-40d4-92f3-c71fbc72c5b3/set_state "HTTP/1.1 200 OK"
2025-10-03 17:48:17 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=50ad395f-d86d-4b07-b9fc-49d3f6712f5b "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:48:17 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:49:20 - root - INFO - Logging configured successfully
2025-10-03 17:49:20 - root - INFO - Log level: INFO
2025-10-03 17:49:20 - root - INFO - Console logging: enabled
2025-10-03 17:49:20 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 17:49:20 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 17:49:20 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=ddad605a-3f84-47e4-ac0b-7ff44b32deab "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:49:20 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 17:49:20 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 17:49:20 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/f747ec6a-e60e-44f8-833c-3ed33a642c5d/set_state "HTTP/1.1 201 Created"
2025-10-03 17:49:20 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/f747ec6a-e60e-44f8-833c-3ed33a642c5d "HTTP/1.1 200 OK"
2025-10-03 17:49:20 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:49:20 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 17:49:20 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:49:20 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:49:20 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:49:20 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:49:21 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:49:21 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:49:21 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:49:21 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:49:21 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:49:21 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:49:21 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:49:21 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:49:21 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:49:21 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:49:21 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 17:49:21 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:49:21 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 17:49:21 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:49:21 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:49:21 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 17:49:21 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:49:21 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:49:21 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 17:49:21 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 17:49:21 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 17:49:21 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:49:21 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 17:49:21 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 17:49:21 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 17:49:21 - src.models.train - INFO - Features: 47
2025-10-03 17:49:21 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:49:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:49:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:49:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:49:23 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:49:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:49:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:49:23 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:49:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:49:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:49:24 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:49:24 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 17:49:24 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:49:24 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:49:24 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:49:24 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:49:24 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 17:49:24 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 17:49:24 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:49:24 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 17:49:24 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 17:49:24 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 17:49:24 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 17:49:24 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 17:49:25 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:49:25 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 17:49:25 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 17:49:25 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 17:49:25 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 17:49:25 - prefect.flow_runs - ERROR - Training flow failed: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:49:25 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - failure
2025-10-03 17:49:25 - prefect.flow_runs - ERROR - Encountered exception during execution: OSError(30, 'Read-only file system')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/training_flow.py", line 251, in training_flow
    mlflow.log_artifact(str(model_path))
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/fluent.py", line 1429, in log_artifact
    MlflowClient().log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/client.py", line 2497, in log_artifact
    self._tracking_client.log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/_tracking_service/client.py", line 674, in log_artifact
    artifact_repo.log_artifact(local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/store/artifact/local_artifact_repo.py", line 44, in log_artifact
    mkdir(artifact_dir)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 209, in mkdir
    raise e
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 206, in mkdir
    os.makedirs(target, exist_ok=True)
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  [Previous line repeated 1 more time]
  File "<frozen os>", line 225, in makedirs
OSError: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:49:25 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:49:25 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/f747ec6a-e60e-44f8-833c-3ed33a642c5d/set_state "HTTP/1.1 201 Created"
2025-10-03 17:49:25 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/f747ec6a-e60e-44f8-833c-3ed33a642c5d/set_state "HTTP/1.1 200 OK"
2025-10-03 17:49:27 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=b960c849-07a1-4182-9ce6-1a630573c22e "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:49:27 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:50:44 - root - INFO - Logging configured successfully
2025-10-03 17:50:44 - root - INFO - Log level: INFO
2025-10-03 17:50:44 - root - INFO - Console logging: enabled
2025-10-03 17:50:44 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 17:50:44 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 17:50:44 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=c2b83fe7-cd25-409c-92ea-cc352402c6ec "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:50:44 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 17:50:44 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 17:50:44 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/eec0ff88-793c-4b0b-8c07-b3bef3569932/set_state "HTTP/1.1 201 Created"
2025-10-03 17:50:44 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/eec0ff88-793c-4b0b-8c07-b3bef3569932 "HTTP/1.1 200 OK"
2025-10-03 17:50:44 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:50:44 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 17:50:45 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:50:45 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:50:45 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:50:45 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:50:45 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:50:45 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:50:45 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:50:45 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:50:45 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:50:45 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:50:45 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:50:45 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:50:45 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:50:45 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:50:45 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 17:50:45 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:50:45 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 17:50:45 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:50:45 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:50:45 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 17:50:45 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:50:45 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:50:45 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 17:50:45 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 17:50:46 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 17:50:46 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:50:46 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 17:50:46 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 17:50:46 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 17:50:46 - src.models.train - INFO - Features: 47
2025-10-03 17:50:46 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:50:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:46 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:50:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:46 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:50:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:46 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:50:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:47 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:50:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:47 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:50:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:47 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:50:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:48 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:50:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:48 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:50:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:48 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:50:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:49 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:50:49 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:50:49 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 17:50:49 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:50:49 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:50:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:49 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:50:49 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:50:49 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:50:49 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:50:49 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:50:49 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 17:50:49 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 17:50:49 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:50:49 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 17:50:49 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 17:50:49 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 17:50:49 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 17:50:49 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 17:50:49 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:50:49 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 17:50:49 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 17:50:49 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 17:50:49 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 17:50:49 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:50:49 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_1
2025-10-03 17:50:49 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:50:49 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:50:49 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 1, stage Staging
2025-10-03 17:50:49 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:50:49 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:50:49 - src.models.model_promotion - INFO - Test MAE: 7.3256, Threshold: 15.0000
2025-10-03 17:50:49 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.3256 < 15.0000)
2025-10-03 17:50:49 - src.models.train - INFO - Starting training for horizon 2 days
2025-10-03 17:50:49 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:50:49 - src.models.train - INFO - Creating shifted target for horizon=2 days
2025-10-03 17:50:49 - src.models.train - INFO - Created target for horizon 2: 1188 samples (2 rows removed due to shifting)
2025-10-03 17:50:49 - src.models.train - INFO - Data split: Train=712 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 17:50:49 - src.models.train - INFO - Features: 47
2025-10-03 17:50:49 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:50:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:51 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:51 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=f547adaf-0102-4e07-8a88-90f78c70296b "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:50:51 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:50:51 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:51 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:52 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:50:52 - src.models.train - INFO - Best validation MAE: 6.2331
2025-10-03 17:50:52 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 7, 'num_leaves': 20, 'learning_rate': 0.1788532743297921, 'min_child_samples': 30, 'subsample': 0.8500000000000001, 'colsample_bytree': 0.65, 'reg_alpha': 5.2, 'reg_lambda': 5.5, 'min_child_weight': 0.0054880470007660455}
2025-10-03 17:50:52 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=2)
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:52 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:50:52 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 17:50:52 - src.models.evaluation - INFO - Evaluation: MAE=8.66, RMSE=11.60, Coverage=89.6%, Width=31.71
2025-10-03 17:50:52 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:50:52 - src.models.train - INFO -   MAE: 8.6611
2025-10-03 17:50:52 - src.models.train - INFO -   RMSE: 11.5989
2025-10-03 17:50:52 - src.models.train - INFO -   Coverage: 89.58%
2025-10-03 17:50:52 - src.models.train - INFO -   Interval Width: 31.71
2025-10-03 17:50:52 - src.models.train - INFO - Training complete for horizon 2
2025-10-03 17:50:52 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:50:52 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.2331, test_mae=8.6611, test_rmse=11.5989, test_coverage=0.8958, test_interval_width=31.7143
2025-10-03 17:50:52 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 2: MAE=8.66, RMSE=11.60
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_2.pkl
2025-10-03 17:50:52 - src.models.lightgbm_model - INFO - Model saved successfully (204.9 KB)
2025-10-03 17:50:52 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:50:52 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_2
2025-10-03 17:50:52 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:50:52 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:50:52 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 2, stage Staging
2025-10-03 17:50:52 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:50:52 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:50:52 - src.models.model_promotion - INFO - Test MAE: 8.6611, Threshold: 15.0000
2025-10-03 17:50:52 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.6611 < 15.0000)
2025-10-03 17:50:53 - src.models.train - INFO - Starting training for horizon 3 days
2025-10-03 17:50:53 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:50:53 - src.models.train - INFO - Creating shifted target for horizon=3 days
2025-10-03 17:50:53 - src.models.train - INFO - Created target for horizon 3: 1187 samples (3 rows removed due to shifting)
2025-10-03 17:50:53 - src.models.train - INFO - Data split: Train=712 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.1%)
2025-10-03 17:50:53 - src.models.train - INFO - Features: 47
2025-10-03 17:50:53 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:50:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:53 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:50:53 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:53 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:54 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:54 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:54 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:55 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:55 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:55 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:56 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:50:56 - src.models.train - INFO - Best validation MAE: 6.5140
2025-10-03 17:50:56 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:50:56 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=3)
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:50:56 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:50:56 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 17:50:56 - src.models.evaluation - INFO - Evaluation: MAE=7.54, RMSE=10.88, Coverage=94.6%, Width=40.68
2025-10-03 17:50:56 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:50:56 - src.models.train - INFO -   MAE: 7.5393
2025-10-03 17:50:56 - src.models.train - INFO -   RMSE: 10.8759
2025-10-03 17:50:56 - src.models.train - INFO -   Coverage: 94.56%
2025-10-03 17:50:56 - src.models.train - INFO -   Interval Width: 40.68
2025-10-03 17:50:56 - src.models.train - INFO - Training complete for horizon 3
2025-10-03 17:50:56 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:50:56 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5140, test_mae=7.5393, test_rmse=10.8759, test_coverage=0.9456, test_interval_width=40.6843
2025-10-03 17:50:56 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 3: MAE=7.54, RMSE=10.88
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_3.pkl
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Model saved successfully (188.8 KB)
2025-10-03 17:50:56 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:50:56 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_3
2025-10-03 17:50:56 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:50:56 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:50:56 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 3, stage Staging
2025-10-03 17:50:56 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:50:56 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:50:56 - src.models.model_promotion - INFO - Test MAE: 7.5393, Threshold: 15.0000
2025-10-03 17:50:56 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5393 < 15.0000)
2025-10-03 17:50:56 - src.models.train - INFO - Starting training for horizon 4 days
2025-10-03 17:50:56 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:50:56 - src.models.train - INFO - Creating shifted target for horizon=4 days
2025-10-03 17:50:56 - src.models.train - INFO - Created target for horizon 4: 1186 samples (4 rows removed due to shifting)
2025-10-03 17:50:56 - src.models.train - INFO - Data split: Train=711 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.2%)
2025-10-03 17:50:56 - src.models.train - INFO - Features: 47
2025-10-03 17:50:56 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:57 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:50:57 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:50:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:57 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:50:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:57 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:50:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:59 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:50:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:59 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:50:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:50:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:50:59 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:50:59 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:50:59 - src.models.train - INFO - Best validation MAE: 6.6654
2025-10-03 17:50:59 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 17:50:59 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:50:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 17:50:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=4)
2025-10-03 17:51:00 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:00 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:51:00 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:51:00 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:51:00 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:51:00 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 17:51:00 - src.models.evaluation - INFO - Evaluation: MAE=7.57, RMSE=11.08, Coverage=95.4%, Width=38.35
2025-10-03 17:51:00 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:51:00 - src.models.train - INFO -   MAE: 7.5740
2025-10-03 17:51:00 - src.models.train - INFO -   RMSE: 11.0843
2025-10-03 17:51:00 - src.models.train - INFO -   Coverage: 95.40%
2025-10-03 17:51:00 - src.models.train - INFO -   Interval Width: 38.35
2025-10-03 17:51:00 - src.models.train - INFO - Training complete for horizon 4
2025-10-03 17:51:00 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:51:00 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.6654, test_mae=7.5740, test_rmse=11.0843, test_coverage=0.9540, test_interval_width=38.3513
2025-10-03 17:51:00 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 4: MAE=7.57, RMSE=11.08
2025-10-03 17:51:00 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_4.pkl
2025-10-03 17:51:00 - src.models.lightgbm_model - INFO - Model saved successfully (663.3 KB)
2025-10-03 17:51:00 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:51:00 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_4
2025-10-03 17:51:00 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:51:00 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:51:00 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 4, stage Staging
2025-10-03 17:51:00 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:51:00 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:51:00 - src.models.model_promotion - INFO - Test MAE: 7.5740, Threshold: 15.0000
2025-10-03 17:51:00 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5740 < 15.0000)
2025-10-03 17:51:00 - src.models.train - INFO - Starting training for horizon 5 days
2025-10-03 17:51:00 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:51:00 - src.models.train - INFO - Creating shifted target for horizon=5 days
2025-10-03 17:51:00 - src.models.train - INFO - Created target for horizon 5: 1185 samples (5 rows removed due to shifting)
2025-10-03 17:51:00 - src.models.train - INFO - Data split: Train=711 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:51:00 - src.models.train - INFO - Features: 47
2025-10-03 17:51:00 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:51:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:01 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:02 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:02 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:02 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:03 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:03 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:03 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:03 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:51:03 - src.models.train - INFO - Best validation MAE: 6.5851
2025-10-03 17:51:03 - src.models.train - INFO - Best parameters: {'n_estimators': 220, 'max_depth': 12, 'num_leaves': 150, 'learning_rate': 0.030405325392865647, 'min_child_samples': 20, 'subsample': 0.55, 'colsample_bytree': 0.5, 'reg_alpha': 8.700000000000001, 'reg_lambda': 6.0, 'min_child_weight': 0.6796578090758157}
2025-10-03 17:51:03 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:51:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 17:51:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=5)
2025-10-03 17:51:04 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:51:04 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:51:04 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:51:04 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:51:04 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:51:04 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:51:04 - src.models.evaluation - INFO - Evaluation: MAE=8.03, RMSE=11.11, Coverage=95.8%, Width=46.27
2025-10-03 17:51:04 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:51:04 - src.models.train - INFO -   MAE: 8.0314
2025-10-03 17:51:04 - src.models.train - INFO -   RMSE: 11.1115
2025-10-03 17:51:04 - src.models.train - INFO -   Coverage: 95.80%
2025-10-03 17:51:04 - src.models.train - INFO -   Interval Width: 46.27
2025-10-03 17:51:04 - src.models.train - INFO - Training complete for horizon 5
2025-10-03 17:51:04 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:51:04 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5851, test_mae=8.0314, test_rmse=11.1115, test_coverage=0.9580, test_interval_width=46.2685
2025-10-03 17:51:04 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 5: MAE=8.03, RMSE=11.11
2025-10-03 17:51:04 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_5.pkl
2025-10-03 17:51:04 - src.models.lightgbm_model - INFO - Model saved successfully (492.5 KB)
2025-10-03 17:51:04 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:51:04 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_5
2025-10-03 17:51:04 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:51:04 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:51:04 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 5, stage Staging
2025-10-03 17:51:04 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:51:04 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:51:04 - src.models.model_promotion - INFO - Test MAE: 8.0314, Threshold: 15.0000
2025-10-03 17:51:04 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.0314 < 15.0000)
2025-10-03 17:51:04 - src.models.train - INFO - Starting training for horizon 6 days
2025-10-03 17:51:04 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:51:04 - src.models.train - INFO - Creating shifted target for horizon=6 days
2025-10-03 17:51:04 - src.models.train - INFO - Created target for horizon 6: 1184 samples (6 rows removed due to shifting)
2025-10-03 17:51:04 - src.models.train - INFO - Data split: Train=710 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:51:04 - src.models.train - INFO - Features: 47
2025-10-03 17:51:04 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:51:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:05 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:06 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:51:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:06 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:51:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:06 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:51:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:51:07 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:51:07 - src.models.train - INFO - Best validation MAE: 6.5153
2025-10-03 17:51:07 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:51:07 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=6)
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:51:07 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:51:07 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:51:07 - src.models.evaluation - INFO - Evaluation: MAE=7.51, RMSE=10.84, Coverage=94.1%, Width=42.82
2025-10-03 17:51:07 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:51:07 - src.models.train - INFO -   MAE: 7.5070
2025-10-03 17:51:07 - src.models.train - INFO -   RMSE: 10.8431
2025-10-03 17:51:07 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 17:51:07 - src.models.train - INFO -   Interval Width: 42.82
2025-10-03 17:51:07 - src.models.train - INFO - Training complete for horizon 6
2025-10-03 17:51:07 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:51:07 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5153, test_mae=7.5070, test_rmse=10.8431, test_coverage=0.9412, test_interval_width=42.8245
2025-10-03 17:51:07 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 6: MAE=7.51, RMSE=10.84
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_6.pkl
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Model saved successfully (187.9 KB)
2025-10-03 17:51:07 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:51:07 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_6
2025-10-03 17:51:07 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:51:07 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:51:07 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 6, stage Staging
2025-10-03 17:51:07 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:51:07 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:51:07 - src.models.model_promotion - INFO - Test MAE: 7.5070, Threshold: 15.0000
2025-10-03 17:51:07 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5070 < 15.0000)
2025-10-03 17:51:07 - src.models.train - INFO - Starting training for horizon 7 days
2025-10-03 17:51:07 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:51:07 - src.models.train - INFO - Creating shifted target for horizon=7 days
2025-10-03 17:51:07 - src.models.train - INFO - Created target for horizon 7: 1183 samples (7 rows removed due to shifting)
2025-10-03 17:51:07 - src.models.train - INFO - Data split: Train=709 (59.9%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:51:07 - src.models.train - INFO - Features: 47
2025-10-03 17:51:07 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:08 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:51:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:08 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:51:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:08 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:51:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:09 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:51:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:09 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:51:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:09 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:51:09 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:51:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:10 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:51:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:10 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:51:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:10 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:51:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:51:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:51:10 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:51:11 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:51:11 - src.models.train - INFO - Best validation MAE: 6.3625
2025-10-03 17:51:11 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 17:51:11 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:51:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 17:51:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=7)
2025-10-03 17:51:11 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:51:11 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:51:11 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:51:11 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:51:11 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:51:11 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:51:11 - src.models.evaluation - INFO - Evaluation: MAE=7.62, RMSE=10.94, Coverage=94.1%, Width=38.87
2025-10-03 17:51:11 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:51:11 - src.models.train - INFO -   MAE: 7.6238
2025-10-03 17:51:11 - src.models.train - INFO -   RMSE: 10.9354
2025-10-03 17:51:11 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 17:51:11 - src.models.train - INFO -   Interval Width: 38.87
2025-10-03 17:51:11 - src.models.train - INFO - Training complete for horizon 7
2025-10-03 17:51:11 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:51:11 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3625, test_mae=7.6238, test_rmse=10.9354, test_coverage=0.9412, test_interval_width=38.8694
2025-10-03 17:51:11 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 7: MAE=7.62, RMSE=10.94
2025-10-03 17:51:11 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_7.pkl
2025-10-03 17:51:11 - src.models.lightgbm_model - INFO - Model saved successfully (640.7 KB)
2025-10-03 17:51:11 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:51:11 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_7
2025-10-03 17:51:11 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:51:11 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:51:11 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 7, stage Staging
2025-10-03 17:51:11 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Test MAE: 7.6238, Threshold: 15.0000
2025-10-03 17:51:11 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.6238 < 15.0000)
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_1
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_2
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_3
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_4
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_5
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_6
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_7
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:51:11 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:51:11 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/artifacts/ "HTTP/1.1 201 Created"
2025-10-03 17:51:11 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - success
2025-10-03 17:51:11 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/eec0ff88-793c-4b0b-8c07-b3bef3569932/set_state "HTTP/1.1 201 Created"
2025-10-03 17:51:11 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 17:51:11 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=b44b253d-5791-4181-8502-2e92181471d6 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:51:11 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 17:51:11 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 17:51:11 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/6ca240f2-f6fa-473d-b480-86811bb984c7/set_state "HTTP/1.1 201 Created"
2025-10-03 17:51:11 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/6ca240f2-f6fa-473d-b480-86811bb984c7 "HTTP/1.1 200 OK"
2025-10-03 17:51:11 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:51:11 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/aba95944-47d3-4eb7-86a2-fc3b3f1ba70e "HTTP/1.1 200 OK"
2025-10-03 17:51:12 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:51:12 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:51:12 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:51:12 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:51:12 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:51:12 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:51:12 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:51:12 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:51:12 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:51:12 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:51:12 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:51:12 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:51:12 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:51:12 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:51:12 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 17:51:12 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:51:12 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 17:51:12 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:51:12 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:51:12 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 17:51:12 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:51:12 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:51:12 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:51:12 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:51:12 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:51:12 - src.models.predict - ERROR - Failed to load model for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:51:13 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:51:22 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:51:22 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:51:22 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:51:22 - src.models.predict - ERROR - Failed to load model for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:51:32 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:51:32 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:51:32 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:51:32 - src.models.predict - ERROR - Failed to load model for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:51:42 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:51:42 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:51:42 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:51:42 - src.models.predict - ERROR - Failed to load model for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:51:42 - prefect.task_runs - ERROR - Task run failed with exception: Exception("Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.") - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 57, in load_production_models
    model = get_latest_production_model(model_name)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/utils/mlflow_utils.py", line 218, in get_latest_production_model
    raise MlflowException(
mlflow.exceptions.MlflowException: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 68, in load_production_models
    raise Exception(
Exception: Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.
2025-10-03 17:51:42 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:51:42 - prefect.task_runs - ERROR - Finished in state Failed("Task run encountered an exception Exception: Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.")
2025-10-03 17:51:42 - prefect.flow_runs - ERROR - Prediction flow failed: Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.
2025-10-03 17:51:42 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 17:51:42 - prefect.flow_runs - ERROR - Encountered exception during execution: Exception("Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.")
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 57, in load_production_models
    model = get_latest_production_model(model_name)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/utils/mlflow_utils.py", line 218, in get_latest_production_model
    raise MlflowException(
mlflow.exceptions.MlflowException: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 171, in prediction_flow
    models = load_production_models()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 68, in load_production_models
    raise Exception(
Exception: Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.
2025-10-03 17:51:42 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:51:42 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/6ca240f2-f6fa-473d-b480-86811bb984c7/set_state "HTTP/1.1 201 Created"
2025-10-03 17:51:42 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/6ca240f2-f6fa-473d-b480-86811bb984c7/set_state "HTTP/1.1 200 OK"
2025-10-03 17:51:43 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:52:42 - root - INFO - Logging configured successfully
2025-10-03 17:52:42 - root - INFO - Log level: INFO
2025-10-03 17:52:42 - root - INFO - Console logging: enabled
2025-10-03 17:52:42 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 17:52:42 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 17:52:42 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=6cd9b4e4-f371-43be-8a27-4cabb826bfd6 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:52:42 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 17:52:42 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 17:52:42 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/7fa34dbe-e6b0-4fff-b0de-65dbd45a8095/set_state "HTTP/1.1 201 Created"
2025-10-03 17:52:42 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/7fa34dbe-e6b0-4fff-b0de-65dbd45a8095 "HTTP/1.1 200 OK"
2025-10-03 17:52:42 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:52:42 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 17:52:42 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/6ca240f2-f6fa-473d-b480-86811bb984c7/set_state "HTTP/1.1 201 Created"
2025-10-03 17:52:42 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/6ca240f2-f6fa-473d-b480-86811bb984c7 "HTTP/1.1 200 OK"
2025-10-03 17:52:42 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:52:43 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:52:43 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:52:43 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:52:43 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:52:43 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:52:43 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:52:43 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 17:52:43 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:52:43 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 17:52:43 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:52:43 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 17:52:43 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:52:43 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:52:44 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 17:52:44 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:52:44 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 17:52:44 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 17:52:44 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 17:52:44 - src.models.train - INFO - Features: 47
2025-10-03 17:52:44 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:52:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:44 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:52:44 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:52:44 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:52:44 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:52:44 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:52:44 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:52:44 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:52:44 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:52:44 - src.models.predict - ERROR - Failed to load model for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:52:44 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:52:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:44 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:52:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:44 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:52:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:45 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:52:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:45 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:52:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:45 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:52:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:46 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:52:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:46 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:52:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:52:47 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:52:47 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 17:52:47 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:52:47 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:52:47 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:52:47 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 17:52:47 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 17:52:47 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:52:47 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 17:52:47 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 17:52:47 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 17:52:47 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 17:52:47 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 17:52:47 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:52:47 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 17:52:47 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 17:52:47 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:52:47 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_1
2025-10-03 17:52:47 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:52:47 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:52:47 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 1, stage Staging
2025-10-03 17:52:47 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:52:47 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:52:47 - src.models.model_promotion - INFO - Test MAE: 7.3256, Threshold: 15.0000
2025-10-03 17:52:47 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.3256 < 15.0000)
2025-10-03 17:52:47 - src.models.train - INFO - Starting training for horizon 2 days
2025-10-03 17:52:47 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:52:47 - src.models.train - INFO - Creating shifted target for horizon=2 days
2025-10-03 17:52:47 - src.models.train - INFO - Created target for horizon 2: 1188 samples (2 rows removed due to shifting)
2025-10-03 17:52:47 - src.models.train - INFO - Data split: Train=712 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 17:52:47 - src.models.train - INFO - Features: 47
2025-10-03 17:52:47 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:49 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:49 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=a320a5ea-ac39-4dbd-9b1f-a56d1fc57103 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:52:49 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:52:49 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:50 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:50 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:50 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:51 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:52:51 - src.models.train - INFO - Best validation MAE: 6.2331
2025-10-03 17:52:51 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 7, 'num_leaves': 20, 'learning_rate': 0.1788532743297921, 'min_child_samples': 30, 'subsample': 0.8500000000000001, 'colsample_bytree': 0.65, 'reg_alpha': 5.2, 'reg_lambda': 5.5, 'min_child_weight': 0.0054880470007660455}
2025-10-03 17:52:51 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=2)
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:51 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:52:51 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 17:52:51 - src.models.evaluation - INFO - Evaluation: MAE=8.66, RMSE=11.60, Coverage=89.6%, Width=31.71
2025-10-03 17:52:51 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:52:51 - src.models.train - INFO -   MAE: 8.6611
2025-10-03 17:52:51 - src.models.train - INFO -   RMSE: 11.5989
2025-10-03 17:52:51 - src.models.train - INFO -   Coverage: 89.58%
2025-10-03 17:52:51 - src.models.train - INFO -   Interval Width: 31.71
2025-10-03 17:52:51 - src.models.train - INFO - Training complete for horizon 2
2025-10-03 17:52:51 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:52:51 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.2331, test_mae=8.6611, test_rmse=11.5989, test_coverage=0.8958, test_interval_width=31.7143
2025-10-03 17:52:51 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 2: MAE=8.66, RMSE=11.60
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_2.pkl
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Model saved successfully (204.9 KB)
2025-10-03 17:52:51 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:52:51 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_2
2025-10-03 17:52:51 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:52:51 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:52:51 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 2, stage Staging
2025-10-03 17:52:51 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:52:51 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:52:51 - src.models.model_promotion - INFO - Test MAE: 8.6611, Threshold: 15.0000
2025-10-03 17:52:51 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.6611 < 15.0000)
2025-10-03 17:52:51 - src.models.train - INFO - Starting training for horizon 3 days
2025-10-03 17:52:51 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:52:51 - src.models.train - INFO - Creating shifted target for horizon=3 days
2025-10-03 17:52:51 - src.models.train - INFO - Created target for horizon 3: 1187 samples (3 rows removed due to shifting)
2025-10-03 17:52:51 - src.models.train - INFO - Data split: Train=712 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.1%)
2025-10-03 17:52:51 - src.models.train - INFO - Features: 47
2025-10-03 17:52:51 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:51 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:52:51 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:53 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:53 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:53 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:54 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:52:54 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:52:54 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:52:54 - src.models.predict - ERROR - Failed to load model for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:54 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:52:54 - src.models.train - INFO - Best validation MAE: 6.5140
2025-10-03 17:52:54 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:52:54 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=3)
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:52:54 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:52:54 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 17:52:54 - src.models.evaluation - INFO - Evaluation: MAE=7.54, RMSE=10.88, Coverage=94.6%, Width=40.68
2025-10-03 17:52:54 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:52:54 - src.models.train - INFO -   MAE: 7.5393
2025-10-03 17:52:54 - src.models.train - INFO -   RMSE: 10.8759
2025-10-03 17:52:54 - src.models.train - INFO -   Coverage: 94.56%
2025-10-03 17:52:54 - src.models.train - INFO -   Interval Width: 40.68
2025-10-03 17:52:54 - src.models.train - INFO - Training complete for horizon 3
2025-10-03 17:52:54 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:52:54 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5140, test_mae=7.5393, test_rmse=10.8759, test_coverage=0.9456, test_interval_width=40.6843
2025-10-03 17:52:54 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 3: MAE=7.54, RMSE=10.88
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_3.pkl
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Model saved successfully (188.8 KB)
2025-10-03 17:52:54 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:52:54 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_3
2025-10-03 17:52:54 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:52:54 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:52:54 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 3, stage Staging
2025-10-03 17:52:54 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:52:54 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:52:54 - src.models.model_promotion - INFO - Test MAE: 7.5393, Threshold: 15.0000
2025-10-03 17:52:54 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5393 < 15.0000)
2025-10-03 17:52:54 - src.models.train - INFO - Starting training for horizon 4 days
2025-10-03 17:52:54 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:52:54 - src.models.train - INFO - Creating shifted target for horizon=4 days
2025-10-03 17:52:54 - src.models.train - INFO - Created target for horizon 4: 1186 samples (4 rows removed due to shifting)
2025-10-03 17:52:54 - src.models.train - INFO - Data split: Train=711 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.2%)
2025-10-03 17:52:54 - src.models.train - INFO - Features: 47
2025-10-03 17:52:54 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:55 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:55 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:52:55 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:55 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:56 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:56 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:56 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:57 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:57 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:58 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:52:58 - src.models.train - INFO - Best validation MAE: 6.6654
2025-10-03 17:52:58 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 17:52:58 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=4)
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:58 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:52:58 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 17:52:58 - src.models.evaluation - INFO - Evaluation: MAE=7.57, RMSE=11.08, Coverage=95.4%, Width=38.35
2025-10-03 17:52:58 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:52:58 - src.models.train - INFO -   MAE: 7.5740
2025-10-03 17:52:58 - src.models.train - INFO -   RMSE: 11.0843
2025-10-03 17:52:58 - src.models.train - INFO -   Coverage: 95.40%
2025-10-03 17:52:58 - src.models.train - INFO -   Interval Width: 38.35
2025-10-03 17:52:58 - src.models.train - INFO - Training complete for horizon 4
2025-10-03 17:52:58 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:52:58 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.6654, test_mae=7.5740, test_rmse=11.0843, test_coverage=0.9540, test_interval_width=38.3513
2025-10-03 17:52:58 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 4: MAE=7.57, RMSE=11.08
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_4.pkl
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Model saved successfully (663.3 KB)
2025-10-03 17:52:58 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:52:58 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_4
2025-10-03 17:52:58 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:52:58 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:52:58 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 4, stage Staging
2025-10-03 17:52:58 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:52:58 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:52:58 - src.models.model_promotion - INFO - Test MAE: 7.5740, Threshold: 15.0000
2025-10-03 17:52:58 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5740 < 15.0000)
2025-10-03 17:52:58 - src.models.train - INFO - Starting training for horizon 5 days
2025-10-03 17:52:58 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:52:58 - src.models.train - INFO - Creating shifted target for horizon=5 days
2025-10-03 17:52:58 - src.models.train - INFO - Created target for horizon 5: 1185 samples (5 rows removed due to shifting)
2025-10-03 17:52:58 - src.models.train - INFO - Data split: Train=711 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:52:58 - src.models.train - INFO - Features: 47
2025-10-03 17:52:58 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:59 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:59 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:52:59 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:52:59 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:52:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:52:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:00 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:00 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:00 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:01 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:01 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:02 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:53:02 - src.models.train - INFO - Best validation MAE: 6.5851
2025-10-03 17:53:02 - src.models.train - INFO - Best parameters: {'n_estimators': 220, 'max_depth': 12, 'num_leaves': 150, 'learning_rate': 0.030405325392865647, 'min_child_samples': 20, 'subsample': 0.55, 'colsample_bytree': 0.5, 'reg_alpha': 8.700000000000001, 'reg_lambda': 6.0, 'min_child_weight': 0.6796578090758157}
2025-10-03 17:53:02 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=5)
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:02 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:53:02 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:53:02 - src.models.evaluation - INFO - Evaluation: MAE=8.03, RMSE=11.11, Coverage=95.8%, Width=46.27
2025-10-03 17:53:02 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:53:02 - src.models.train - INFO -   MAE: 8.0314
2025-10-03 17:53:02 - src.models.train - INFO -   RMSE: 11.1115
2025-10-03 17:53:02 - src.models.train - INFO -   Coverage: 95.80%
2025-10-03 17:53:02 - src.models.train - INFO -   Interval Width: 46.27
2025-10-03 17:53:02 - src.models.train - INFO - Training complete for horizon 5
2025-10-03 17:53:02 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:53:02 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5851, test_mae=8.0314, test_rmse=11.1115, test_coverage=0.9580, test_interval_width=46.2685
2025-10-03 17:53:02 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 5: MAE=8.03, RMSE=11.11
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_5.pkl
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Model saved successfully (492.5 KB)
2025-10-03 17:53:02 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:53:02 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_5
2025-10-03 17:53:02 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:02 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:02 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 5, stage Staging
2025-10-03 17:53:02 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:53:02 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:53:02 - src.models.model_promotion - INFO - Test MAE: 8.0314, Threshold: 15.0000
2025-10-03 17:53:02 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.0314 < 15.0000)
2025-10-03 17:53:02 - src.models.train - INFO - Starting training for horizon 6 days
2025-10-03 17:53:02 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:53:02 - src.models.train - INFO - Creating shifted target for horizon=6 days
2025-10-03 17:53:02 - src.models.train - INFO - Created target for horizon 6: 1184 samples (6 rows removed due to shifting)
2025-10-03 17:53:02 - src.models.train - INFO - Data split: Train=710 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:53:02 - src.models.train - INFO - Features: 47
2025-10-03 17:53:02 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:03 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:03 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:03 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:03 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:04 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:53:04 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:53:04 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:53:04 - src.models.predict - ERROR - Failed to load model for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:53:04 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:04 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:04 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:05 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:05 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:05 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:06 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:53:06 - src.models.train - INFO - Best validation MAE: 6.5153
2025-10-03 17:53:06 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:53:06 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=6)
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:06 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:53:06 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:53:06 - src.models.evaluation - INFO - Evaluation: MAE=7.51, RMSE=10.84, Coverage=94.1%, Width=42.82
2025-10-03 17:53:06 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:53:06 - src.models.train - INFO -   MAE: 7.5070
2025-10-03 17:53:06 - src.models.train - INFO -   RMSE: 10.8431
2025-10-03 17:53:06 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 17:53:06 - src.models.train - INFO -   Interval Width: 42.82
2025-10-03 17:53:06 - src.models.train - INFO - Training complete for horizon 6
2025-10-03 17:53:06 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:53:06 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5153, test_mae=7.5070, test_rmse=10.8431, test_coverage=0.9412, test_interval_width=42.8245
2025-10-03 17:53:06 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 6: MAE=7.51, RMSE=10.84
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_6.pkl
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Model saved successfully (187.9 KB)
2025-10-03 17:53:06 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:53:06 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_6
2025-10-03 17:53:06 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:06 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:06 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 6, stage Staging
2025-10-03 17:53:06 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:53:06 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:53:06 - src.models.model_promotion - INFO - Test MAE: 7.5070, Threshold: 15.0000
2025-10-03 17:53:06 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5070 < 15.0000)
2025-10-03 17:53:06 - src.models.train - INFO - Starting training for horizon 7 days
2025-10-03 17:53:06 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:53:06 - src.models.train - INFO - Creating shifted target for horizon=7 days
2025-10-03 17:53:06 - src.models.train - INFO - Created target for horizon 7: 1183 samples (7 rows removed due to shifting)
2025-10-03 17:53:06 - src.models.train - INFO - Data split: Train=709 (59.9%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:53:06 - src.models.train - INFO - Features: 47
2025-10-03 17:53:06 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:07 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:08 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:08 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:09 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:09 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:09 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:09 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:53:09 - src.models.train - INFO - Best validation MAE: 6.3625
2025-10-03 17:53:09 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 17:53:09 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:53:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 17:53:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=7)
2025-10-03 17:53:09 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:09 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:53:10 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:53:10 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:53:10 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:53:10 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:53:10 - src.models.evaluation - INFO - Evaluation: MAE=7.62, RMSE=10.94, Coverage=94.1%, Width=38.87
2025-10-03 17:53:10 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:53:10 - src.models.train - INFO -   MAE: 7.6238
2025-10-03 17:53:10 - src.models.train - INFO -   RMSE: 10.9354
2025-10-03 17:53:10 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 17:53:10 - src.models.train - INFO -   Interval Width: 38.87
2025-10-03 17:53:10 - src.models.train - INFO - Training complete for horizon 7
2025-10-03 17:53:10 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:53:10 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3625, test_mae=7.6238, test_rmse=10.9354, test_coverage=0.9412, test_interval_width=38.8694
2025-10-03 17:53:10 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 7: MAE=7.62, RMSE=10.94
2025-10-03 17:53:10 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_7.pkl
2025-10-03 17:53:10 - src.models.lightgbm_model - INFO - Model saved successfully (640.7 KB)
2025-10-03 17:53:10 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:53:10 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_7
2025-10-03 17:53:10 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:10 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:10 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 7, stage Staging
2025-10-03 17:53:10 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Test MAE: 7.6238, Threshold: 15.0000
2025-10-03 17:53:10 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.6238 < 15.0000)
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_1
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_2
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_3
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_4
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_5
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_6
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_7
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:53:10 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:53:10 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/artifacts/ "HTTP/1.1 201 Created"
2025-10-03 17:53:10 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - success
2025-10-03 17:53:10 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/7fa34dbe-e6b0-4fff-b0de-65dbd45a8095/set_state "HTTP/1.1 201 Created"
2025-10-03 17:53:10 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 17:53:10 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=c2bd92c4-6beb-4f63-aca7-e6e7bb633aff "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:53:10 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 17:53:10 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:10 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/01a691ff-e029-4e79-84d7-e148e7a3bbae/set_state "HTTP/1.1 201 Created"
2025-10-03 17:53:10 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/01a691ff-e029-4e79-84d7-e148e7a3bbae "HTTP/1.1 200 OK"
2025-10-03 17:53:10 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:53:10 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/aba95944-47d3-4eb7-86a2-fc3b3f1ba70e "HTTP/1.1 200 OK"
2025-10-03 17:53:11 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:53:11 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:53:11 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:53:11 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:53:11 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:53:11 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:53:11 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:53:11 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:53:11 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:53:11 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:53:11 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:53:11 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:53:11 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:53:11 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:53:11 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 17:53:11 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:53:11 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 17:53:11 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:53:11 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:53:11 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 17:53:11 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:53:11 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:53:11 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:53:11 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:53:11 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:53:11 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:53:11 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:53:14 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:53:14 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:53:14 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:53:14 - src.models.predict - ERROR - Failed to load model for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:53:14 - prefect.task_runs - ERROR - Task run failed with exception: Exception("Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.") - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 57, in load_production_models
    logger.debug(f"Loading production model: {model_name}")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/utils/mlflow_utils.py", line 218, in get_latest_production_model
    raise MlflowException(
mlflow.exceptions.MlflowException: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 68, in load_production_models
    logger.warning(f"Failed to load model from MLflow for horizon {horizon}: {e}")
Exception: Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.
2025-10-03 17:53:14 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:53:14 - prefect.task_runs - ERROR - Finished in state Failed("Task run encountered an exception Exception: Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.")
2025-10-03 17:53:14 - prefect.flow_runs - ERROR - Prediction flow failed: Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.
2025-10-03 17:53:14 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 17:53:14 - prefect.flow_runs - ERROR - Encountered exception during execution: Exception("Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.")
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 57, in load_production_models
    logger.debug(f"Loading production model: {model_name}")
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/utils/mlflow_utils.py", line 218, in get_latest_production_model
    raise MlflowException(
mlflow.exceptions.MlflowException: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 171, in prediction_flow
    models = load_production_models()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 68, in load_production_models
    logger.warning(f"Failed to load model from MLflow for horizon {horizon}: {e}")
Exception: Cannot load production model for horizon 1. Ensure model 'er_forecast_horizon_1' is registered and in Production stage.
2025-10-03 17:53:14 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:53:14 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/6ca240f2-f6fa-473d-b480-86811bb984c7/set_state "HTTP/1.1 201 Created"
2025-10-03 17:53:14 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/6ca240f2-f6fa-473d-b480-86811bb984c7/set_state "HTTP/1.1 200 OK"
2025-10-03 17:53:15 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:15 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/4084e352-3363-40d4-92f3-c71fbc72c5b3/set_state "HTTP/1.1 201 Created"
2025-10-03 17:53:15 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/4084e352-3363-40d4-92f3-c71fbc72c5b3 "HTTP/1.1 200 OK"
2025-10-03 17:53:15 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:53:16 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:53:16 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:53:16 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:53:16 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:53:16 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:53:16 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:53:16 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:53:16 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:53:16 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:53:16 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:53:16 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:53:16 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:53:16 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:53:16 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:53:16 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 17:53:16 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:53:16 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 17:53:16 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:53:16 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:53:16 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 17:53:16 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:53:16 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:53:16 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 17:53:16 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 17:53:16 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 17:53:16 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:53:16 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 17:53:16 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 17:53:16 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 17:53:16 - src.models.train - INFO - Features: 47
2025-10-03 17:53:16 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:53:16 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:16 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:17 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:17 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:19 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:19 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:20 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:53:20 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 17:53:20 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:53:20 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:20 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:53:20 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 17:53:20 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 17:53:20 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:53:20 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 17:53:20 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 17:53:20 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 17:53:20 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 17:53:20 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 17:53:20 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:53:20 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 17:53:20 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 17:53:20 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 17:53:20 - prefect.flow_runs - ERROR - Training flow failed: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:53:20 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - failure
2025-10-03 17:53:20 - prefect.flow_runs - ERROR - Encountered exception during execution: OSError(30, 'Read-only file system')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/training_flow.py", line 251, in training_flow
    try:
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/fluent.py", line 1429, in log_artifact
    MlflowClient().log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/client.py", line 2497, in log_artifact
    self._tracking_client.log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/_tracking_service/client.py", line 674, in log_artifact
    artifact_repo.log_artifact(local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/store/artifact/local_artifact_repo.py", line 44, in log_artifact
    mkdir(artifact_dir)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 209, in mkdir
    raise e
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 206, in mkdir
    os.makedirs(target, exist_ok=True)
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  [Previous line repeated 1 more time]
  File "<frozen os>", line 225, in makedirs
OSError: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:53:20 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:53:20 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/4084e352-3363-40d4-92f3-c71fbc72c5b3/set_state "HTTP/1.1 201 Created"
2025-10-03 17:53:20 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:21 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:53:21 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:53:21 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:53:21 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:53:24 - prefect.task_runs - ERROR - Crash detected! Execution was aborted by a termination signal.
2025-10-03 17:53:24 - prefect.task_runs - ERROR - Finished in state Crashed('Execution was aborted by a termination signal.')
2025-10-03 17:53:24 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 17:53:32 - root - INFO - Logging configured successfully
2025-10-03 17:53:32 - root - INFO - Log level: INFO
2025-10-03 17:53:32 - root - INFO - Console logging: enabled
2025-10-03 17:53:32 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 17:53:32 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 17:53:33 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=35d36e77-e74a-40fe-9d6d-e36a18c86fc4 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:53:33 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 17:53:33 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:33 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/737e4606-7ced-4562-96ab-5b41f0e6d86d/set_state "HTTP/1.1 201 Created"
2025-10-03 17:53:33 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/737e4606-7ced-4562-96ab-5b41f0e6d86d "HTTP/1.1 200 OK"
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:53:33 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:53:33 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:53:33 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:53:33 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:53:33 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:53:33 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 17:53:33 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:53:34 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 17:53:34 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:53:34 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:53:34 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 17:53:34 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:53:34 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:53:34 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 17:53:34 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 17:53:34 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 17:53:34 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:53:34 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 17:53:34 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 17:53:34 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 17:53:34 - src.models.train - INFO - Features: 47
2025-10-03 17:53:34 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:53:34 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:34 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:36 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:36 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:36 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:36 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:37 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:53:37 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 17:53:37 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:53:37 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:53:37 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:53:37 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:53:37 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 17:53:37 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 17:53:37 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:53:37 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 17:53:37 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 17:53:37 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 17:53:37 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 17:53:37 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 17:53:37 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:53:38 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 17:53:38 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 17:53:38 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 17:53:38 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 17:53:38 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:53:38 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_1
2025-10-03 17:53:38 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:38 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:38 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 1, stage Staging
2025-10-03 17:53:38 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:53:38 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:53:38 - src.models.model_promotion - INFO - Test MAE: 7.3256, Threshold: 15.0000
2025-10-03 17:53:38 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.3256 < 15.0000)
2025-10-03 17:53:38 - src.models.train - INFO - Starting training for horizon 2 days
2025-10-03 17:53:38 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:53:38 - src.models.train - INFO - Creating shifted target for horizon=2 days
2025-10-03 17:53:38 - src.models.train - INFO - Created target for horizon 2: 1188 samples (2 rows removed due to shifting)
2025-10-03 17:53:38 - src.models.train - INFO - Data split: Train=712 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 17:53:38 - src.models.train - INFO - Features: 47
2025-10-03 17:53:38 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:53:38 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:38 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:38 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:38 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:38 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:38 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:38 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:38 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:39 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:39 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:39 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:40 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=1f73ce31-3036-42f2-996d-d96d2e8931eb "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:53:40 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:40 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:40 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:40 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:40 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:40 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:40 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:40 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:40 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:40 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:41 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:41 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:41 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:41 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:41 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:53:41 - src.models.train - INFO - Best validation MAE: 6.2331
2025-10-03 17:53:41 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 7, 'num_leaves': 20, 'learning_rate': 0.1788532743297921, 'min_child_samples': 30, 'subsample': 0.8500000000000001, 'colsample_bytree': 0.65, 'reg_alpha': 5.2, 'reg_lambda': 5.5, 'min_child_weight': 0.0054880470007660455}
2025-10-03 17:53:41 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:53:41 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 17:53:41 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=2)
2025-10-03 17:53:41 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:41 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:53:41 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:53:41 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:53:41 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:53:41 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 17:53:41 - src.models.evaluation - INFO - Evaluation: MAE=8.66, RMSE=11.60, Coverage=89.6%, Width=31.71
2025-10-03 17:53:41 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:53:41 - src.models.train - INFO -   MAE: 8.6611
2025-10-03 17:53:41 - src.models.train - INFO -   RMSE: 11.5989
2025-10-03 17:53:41 - src.models.train - INFO -   Coverage: 89.58%
2025-10-03 17:53:41 - src.models.train - INFO -   Interval Width: 31.71
2025-10-03 17:53:41 - src.models.train - INFO - Training complete for horizon 2
2025-10-03 17:53:41 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:53:42 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.2331, test_mae=8.6611, test_rmse=11.5989, test_coverage=0.8958, test_interval_width=31.7143
2025-10-03 17:53:42 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 2: MAE=8.66, RMSE=11.60
2025-10-03 17:53:42 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_2.pkl
2025-10-03 17:53:42 - src.models.lightgbm_model - INFO - Model saved successfully (204.9 KB)
2025-10-03 17:53:42 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:53:42 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_2
2025-10-03 17:53:42 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:42 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:42 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 2, stage Staging
2025-10-03 17:53:42 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:42 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:53:42 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:53:42 - src.models.model_promotion - INFO - Test MAE: 8.6611, Threshold: 15.0000
2025-10-03 17:53:42 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.6611 < 15.0000)
2025-10-03 17:53:42 - src.models.train - INFO - Starting training for horizon 3 days
2025-10-03 17:53:42 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:53:42 - src.models.train - INFO - Creating shifted target for horizon=3 days
2025-10-03 17:53:42 - src.models.train - INFO - Created target for horizon 3: 1187 samples (3 rows removed due to shifting)
2025-10-03 17:53:42 - src.models.train - INFO - Data split: Train=712 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.1%)
2025-10-03 17:53:42 - src.models.train - INFO - Features: 47
2025-10-03 17:53:42 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:53:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:42 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:42 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:43 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:43 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:43 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:44 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:44 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:44 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:45 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:53:45 - src.models.train - INFO - Best validation MAE: 6.5140
2025-10-03 17:53:45 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:53:45 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=3)
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:53:45 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:53:45 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 17:53:45 - src.models.evaluation - INFO - Evaluation: MAE=7.54, RMSE=10.88, Coverage=94.6%, Width=40.68
2025-10-03 17:53:45 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:53:45 - src.models.train - INFO -   MAE: 7.5393
2025-10-03 17:53:45 - src.models.train - INFO -   RMSE: 10.8759
2025-10-03 17:53:45 - src.models.train - INFO -   Coverage: 94.56%
2025-10-03 17:53:45 - src.models.train - INFO -   Interval Width: 40.68
2025-10-03 17:53:45 - src.models.train - INFO - Training complete for horizon 3
2025-10-03 17:53:45 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:53:45 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5140, test_mae=7.5393, test_rmse=10.8759, test_coverage=0.9456, test_interval_width=40.6843
2025-10-03 17:53:45 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 3: MAE=7.54, RMSE=10.88
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_3.pkl
2025-10-03 17:53:45 - src.models.lightgbm_model - INFO - Model saved successfully (188.8 KB)
2025-10-03 17:53:45 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:53:45 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_3
2025-10-03 17:53:45 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:45 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:45 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 3, stage Staging
2025-10-03 17:53:45 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:53:45 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:53:45 - src.models.model_promotion - INFO - Test MAE: 7.5393, Threshold: 15.0000
2025-10-03 17:53:45 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5393 < 15.0000)
2025-10-03 17:53:46 - src.models.train - INFO - Starting training for horizon 4 days
2025-10-03 17:53:46 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:53:46 - src.models.train - INFO - Creating shifted target for horizon=4 days
2025-10-03 17:53:46 - src.models.train - INFO - Created target for horizon 4: 1186 samples (4 rows removed due to shifting)
2025-10-03 17:53:46 - src.models.train - INFO - Data split: Train=711 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.2%)
2025-10-03 17:53:46 - src.models.train - INFO - Features: 47
2025-10-03 17:53:46 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:53:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:46 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:46 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:46 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:46 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:47 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:47 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:47 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:48 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:48 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:49 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:53:49 - src.models.train - INFO - Best validation MAE: 6.6654
2025-10-03 17:53:49 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 17:53:49 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=4)
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:49 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:53:49 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 17:53:49 - src.models.evaluation - INFO - Evaluation: MAE=7.57, RMSE=11.08, Coverage=95.4%, Width=38.35
2025-10-03 17:53:49 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:53:49 - src.models.train - INFO -   MAE: 7.5740
2025-10-03 17:53:49 - src.models.train - INFO -   RMSE: 11.0843
2025-10-03 17:53:49 - src.models.train - INFO -   Coverage: 95.40%
2025-10-03 17:53:49 - src.models.train - INFO -   Interval Width: 38.35
2025-10-03 17:53:49 - src.models.train - INFO - Training complete for horizon 4
2025-10-03 17:53:49 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:53:49 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.6654, test_mae=7.5740, test_rmse=11.0843, test_coverage=0.9540, test_interval_width=38.3513
2025-10-03 17:53:49 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 4: MAE=7.57, RMSE=11.08
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_4.pkl
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Model saved successfully (663.3 KB)
2025-10-03 17:53:49 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:53:49 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_4
2025-10-03 17:53:49 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:49 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:49 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 4, stage Staging
2025-10-03 17:53:49 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:53:49 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:53:49 - src.models.model_promotion - INFO - Test MAE: 7.5740, Threshold: 15.0000
2025-10-03 17:53:49 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5740 < 15.0000)
2025-10-03 17:53:49 - src.models.train - INFO - Starting training for horizon 5 days
2025-10-03 17:53:49 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:53:49 - src.models.train - INFO - Creating shifted target for horizon=5 days
2025-10-03 17:53:49 - src.models.train - INFO - Created target for horizon 5: 1185 samples (5 rows removed due to shifting)
2025-10-03 17:53:49 - src.models.train - INFO - Data split: Train=711 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:53:49 - src.models.train - INFO - Features: 47
2025-10-03 17:53:49 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:50 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:50 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:50 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:52 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:52 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:53 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:53:53 - src.models.train - INFO - Best validation MAE: 6.5851
2025-10-03 17:53:53 - src.models.train - INFO - Best parameters: {'n_estimators': 220, 'max_depth': 12, 'num_leaves': 150, 'learning_rate': 0.030405325392865647, 'min_child_samples': 20, 'subsample': 0.55, 'colsample_bytree': 0.5, 'reg_alpha': 8.700000000000001, 'reg_lambda': 6.0, 'min_child_weight': 0.6796578090758157}
2025-10-03 17:53:53 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=5)
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:53:53 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:53:53 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:53:53 - src.models.evaluation - INFO - Evaluation: MAE=8.03, RMSE=11.11, Coverage=95.8%, Width=46.27
2025-10-03 17:53:53 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:53:53 - src.models.train - INFO -   MAE: 8.0314
2025-10-03 17:53:53 - src.models.train - INFO -   RMSE: 11.1115
2025-10-03 17:53:53 - src.models.train - INFO -   Coverage: 95.80%
2025-10-03 17:53:53 - src.models.train - INFO -   Interval Width: 46.27
2025-10-03 17:53:53 - src.models.train - INFO - Training complete for horizon 5
2025-10-03 17:53:53 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:53:53 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5851, test_mae=8.0314, test_rmse=11.1115, test_coverage=0.9580, test_interval_width=46.2685
2025-10-03 17:53:53 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 5: MAE=8.03, RMSE=11.11
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_5.pkl
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Model saved successfully (492.5 KB)
2025-10-03 17:53:53 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:53:53 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_5
2025-10-03 17:53:53 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:53 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:53 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 5, stage Staging
2025-10-03 17:53:53 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:53:53 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:53:53 - src.models.model_promotion - INFO - Test MAE: 8.0314, Threshold: 15.0000
2025-10-03 17:53:53 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.0314 < 15.0000)
2025-10-03 17:53:53 - src.models.train - INFO - Starting training for horizon 6 days
2025-10-03 17:53:53 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:53:53 - src.models.train - INFO - Creating shifted target for horizon=6 days
2025-10-03 17:53:53 - src.models.train - INFO - Created target for horizon 6: 1184 samples (6 rows removed due to shifting)
2025-10-03 17:53:53 - src.models.train - INFO - Data split: Train=710 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:53:53 - src.models.train - INFO - Features: 47
2025-10-03 17:53:53 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:54 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:55 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:55 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:55 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:56 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:53:56 - src.models.train - INFO - Best validation MAE: 6.5153
2025-10-03 17:53:56 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:53:56 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=6)
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:53:56 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:53:56 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:53:57 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:53:57 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:53:57 - src.models.evaluation - INFO - Evaluation: MAE=7.51, RMSE=10.84, Coverage=94.1%, Width=42.82
2025-10-03 17:53:57 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:53:57 - src.models.train - INFO -   MAE: 7.5070
2025-10-03 17:53:57 - src.models.train - INFO -   RMSE: 10.8431
2025-10-03 17:53:57 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 17:53:57 - src.models.train - INFO -   Interval Width: 42.82
2025-10-03 17:53:57 - src.models.train - INFO - Training complete for horizon 6
2025-10-03 17:53:57 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:53:57 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5153, test_mae=7.5070, test_rmse=10.8431, test_coverage=0.9412, test_interval_width=42.8245
2025-10-03 17:53:57 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 6: MAE=7.51, RMSE=10.84
2025-10-03 17:53:57 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_6.pkl
2025-10-03 17:53:57 - src.models.lightgbm_model - INFO - Model saved successfully (187.9 KB)
2025-10-03 17:53:57 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:53:57 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_6
2025-10-03 17:53:57 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:57 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:53:57 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 6, stage Staging
2025-10-03 17:53:57 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:53:57 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:53:57 - src.models.model_promotion - INFO - Test MAE: 7.5070, Threshold: 15.0000
2025-10-03 17:53:57 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5070 < 15.0000)
2025-10-03 17:53:57 - src.models.train - INFO - Starting training for horizon 7 days
2025-10-03 17:53:57 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:53:57 - src.models.train - INFO - Creating shifted target for horizon=7 days
2025-10-03 17:53:57 - src.models.train - INFO - Created target for horizon 7: 1183 samples (7 rows removed due to shifting)
2025-10-03 17:53:57 - src.models.train - INFO - Data split: Train=709 (59.9%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:53:57 - src.models.train - INFO - Features: 47
2025-10-03 17:53:57 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:53:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:57 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:58 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:59 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:53:59 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:53:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:53:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:54:00 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:54:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:54:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:54:00 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:54:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:54:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:54:00 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:54:00 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:54:00 - src.models.train - INFO - Best validation MAE: 6.3625
2025-10-03 17:54:00 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 17:54:00 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:54:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 17:54:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=7)
2025-10-03 17:54:01 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:54:01 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:54:01 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:54:01 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:54:01 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:54:01 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:54:01 - src.models.evaluation - INFO - Evaluation: MAE=7.62, RMSE=10.94, Coverage=94.1%, Width=38.87
2025-10-03 17:54:01 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:54:01 - src.models.train - INFO -   MAE: 7.6238
2025-10-03 17:54:01 - src.models.train - INFO -   RMSE: 10.9354
2025-10-03 17:54:01 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 17:54:01 - src.models.train - INFO -   Interval Width: 38.87
2025-10-03 17:54:01 - src.models.train - INFO - Training complete for horizon 7
2025-10-03 17:54:01 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:54:01 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3625, test_mae=7.6238, test_rmse=10.9354, test_coverage=0.9412, test_interval_width=38.8694
2025-10-03 17:54:01 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 7: MAE=7.62, RMSE=10.94
2025-10-03 17:54:01 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_7.pkl
2025-10-03 17:54:01 - src.models.lightgbm_model - INFO - Model saved successfully (640.7 KB)
2025-10-03 17:54:01 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:54:01 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_7
2025-10-03 17:54:01 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:54:01 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:54:01 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 7, stage Staging
2025-10-03 17:54:01 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Test MAE: 7.6238, Threshold: 15.0000
2025-10-03 17:54:01 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.6238 < 15.0000)
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_1
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_2
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_3
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_4
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_5
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_6
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_7
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:54:01 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:54:01 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/artifacts/ "HTTP/1.1 201 Created"
2025-10-03 17:54:01 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - success
2025-10-03 17:54:01 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/737e4606-7ced-4562-96ab-5b41f0e6d86d/set_state "HTTP/1.1 201 Created"
2025-10-03 17:54:01 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 17:54:01 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=90ef8ada-e353-4935-8dac-edcffb43d372 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:54:01 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 17:54:01 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 17:54:01 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/86b4b547-64e3-4d86-9fe3-bab88a184590/set_state "HTTP/1.1 201 Created"
2025-10-03 17:54:01 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/86b4b547-64e3-4d86-9fe3-bab88a184590 "HTTP/1.1 200 OK"
2025-10-03 17:54:01 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:54:01 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/aba95944-47d3-4eb7-86a2-fc3b3f1ba70e "HTTP/1.1 200 OK"
2025-10-03 17:54:02 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:54:02 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:54:02 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:54:02 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:54:02 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:54:02 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:54:02 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:54:02 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:54:02 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:54:02 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:54:02 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:54:02 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:54:02 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:54:02 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:54:02 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:54:02 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 17:54:02 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:54:02 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 17:54:02 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:54:02 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:54:02 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 17:54:02 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:54:02 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:54:02 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:54:02 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:54:02 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:54:02 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:54:12 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:54:12 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:54:12 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:54:12 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:54:22 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:54:22 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:54:22 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:54:22 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:54:32 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:54:32 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:54:32 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:54:32 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:54:32 - prefect.task_runs - ERROR - Task run failed with exception: NameError("name 'Path' is not defined") - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 58, in load_production_models
    model = get_latest_production_model(model_name)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/utils/mlflow_utils.py", line 218, in get_latest_production_model
    raise MlflowException(
mlflow.exceptions.MlflowException: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 71, in load_production_models
    local_model_path = Path(f"models/forecaster_horizon_{horizon}.pkl")
                       ^^^^
NameError: name 'Path' is not defined
2025-10-03 17:54:32 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:54:32 - prefect.task_runs - ERROR - Finished in state Failed("Task run encountered an exception NameError: name 'Path' is not defined")
2025-10-03 17:54:32 - prefect.flow_runs - ERROR - Prediction flow failed: name 'Path' is not defined
2025-10-03 17:54:32 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 17:54:32 - prefect.flow_runs - ERROR - Encountered exception during execution: NameError("name 'Path' is not defined")
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 58, in load_production_models
    model = get_latest_production_model(model_name)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/utils/mlflow_utils.py", line 218, in get_latest_production_model
    raise MlflowException(
mlflow.exceptions.MlflowException: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 171, in prediction_flow
    models = load_production_models()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 71, in load_production_models
    local_model_path = Path(f"models/forecaster_horizon_{horizon}.pkl")
                       ^^^^
NameError: name 'Path' is not defined
2025-10-03 17:54:32 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:54:32 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/86b4b547-64e3-4d86-9fe3-bab88a184590/set_state "HTTP/1.1 201 Created"
2025-10-03 17:54:32 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/86b4b547-64e3-4d86-9fe3-bab88a184590/set_state "HTTP/1.1 200 OK"
2025-10-03 17:54:34 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:55:32 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/86b4b547-64e3-4d86-9fe3-bab88a184590/set_state "HTTP/1.1 201 Created"
2025-10-03 17:55:32 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/86b4b547-64e3-4d86-9fe3-bab88a184590 "HTTP/1.1 200 OK"
2025-10-03 17:55:32 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:55:33 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:55:33 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:55:33 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:55:33 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:55:33 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:55:33 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:55:33 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:55:33 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:55:33 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:55:33 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:55:33 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:55:33 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:55:33 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:55:33 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:55:33 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 17:55:33 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:55:33 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 17:55:33 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:55:33 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:55:33 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 17:55:33 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:55:33 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:55:33 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:55:33 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:55:33 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:55:33 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:55:43 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:55:43 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:55:43 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:55:43 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:55:53 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:55:53 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:55:53 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:55:53 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:56:03 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:56:03 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:56:03 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:56:03 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:56:03 - prefect.task_runs - ERROR - Task run failed with exception: NameError("name 'Path' is not defined") - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 58, in load_production_models
    model = get_latest_production_model(model_name)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/utils/mlflow_utils.py", line 218, in get_latest_production_model
    raise MlflowException(
mlflow.exceptions.MlflowException: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 71, in load_production_models
    local_model_path = Path(f"models/forecaster_horizon_{horizon}.pkl")
                       ^^^^
NameError: name 'Path' is not defined
2025-10-03 17:56:03 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:56:03 - prefect.task_runs - ERROR - Finished in state Failed("Task run encountered an exception NameError: name 'Path' is not defined")
2025-10-03 17:56:03 - prefect.flow_runs - ERROR - Prediction flow failed: name 'Path' is not defined
2025-10-03 17:56:03 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 17:56:03 - prefect.flow_runs - ERROR - Encountered exception during execution: NameError("name 'Path' is not defined")
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 58, in load_production_models
    model = get_latest_production_model(model_name)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/utils/mlflow_utils.py", line 218, in get_latest_production_model
    raise MlflowException(
mlflow.exceptions.MlflowException: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 171, in prediction_flow
    models = load_production_models()
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 71, in load_production_models
    local_model_path = Path(f"models/forecaster_horizon_{horizon}.pkl")
                       ^^^^
NameError: name 'Path' is not defined
2025-10-03 17:56:03 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:56:03 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/86b4b547-64e3-4d86-9fe3-bab88a184590/set_state "HTTP/1.1 201 Created"
2025-10-03 17:56:03 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/86b4b547-64e3-4d86-9fe3-bab88a184590/set_state "HTTP/1.1 200 OK"
2025-10-03 17:56:04 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:56:28 - prefect.flow_runs - ERROR - Crash detected! Execution was aborted by a termination signal.
2025-10-03 17:56:28 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/86b4b547-64e3-4d86-9fe3-bab88a184590/set_state "HTTP/1.1 201 Created"
2025-10-03 17:56:28 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:56:34 - root - INFO - Logging configured successfully
2025-10-03 17:56:34 - root - INFO - Log level: INFO
2025-10-03 17:56:34 - root - INFO - Console logging: enabled
2025-10-03 17:56:34 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 17:56:34 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 17:56:34 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=6c135290-7c4c-4d2a-89a7-7a4507ec7c8f "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:56:34 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 17:56:34 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 17:56:34 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/f8ae940a-936d-498f-9b0c-96065e7f4bf2/set_state "HTTP/1.1 201 Created"
2025-10-03 17:56:34 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/f8ae940a-936d-498f-9b0c-96065e7f4bf2 "HTTP/1.1 200 OK"
2025-10-03 17:56:34 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:56:34 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 17:56:34 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:56:34 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:56:34 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:56:34 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:56:35 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:56:35 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:56:35 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:56:35 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:56:35 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:56:35 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:56:35 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:56:35 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:56:35 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:56:35 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:56:35 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 17:56:35 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:56:35 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 17:56:35 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:56:35 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:56:35 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 17:56:35 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:56:35 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:56:35 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 17:56:35 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 17:56:35 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 17:56:35 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:56:35 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 17:56:35 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 17:56:35 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 17:56:35 - src.models.train - INFO - Features: 47
2025-10-03 17:56:35 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:56:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:36 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:56:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:36 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:36 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:56:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:36 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:36 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:56:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:36 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:37 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:56:37 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:37 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:37 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:56:37 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:37 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:37 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:56:37 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:37 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:38 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:56:38 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:38 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:38 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:56:38 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:38 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:56:39 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:56:39 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 17:56:39 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:56:39 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 17:56:39 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:56:39 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 17:56:39 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 17:56:39 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:56:39 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 17:56:39 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 17:56:39 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 17:56:39 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 17:56:39 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 17:56:39 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:56:39 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 17:56:39 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 17:56:39 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:56:39 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_1
2025-10-03 17:56:39 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:39 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:39 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 1, stage Staging
2025-10-03 17:56:39 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:56:39 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:56:39 - src.models.model_promotion - INFO - Test MAE: 7.3256, Threshold: 15.0000
2025-10-03 17:56:39 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.3256 < 15.0000)
2025-10-03 17:56:39 - src.models.train - INFO - Starting training for horizon 2 days
2025-10-03 17:56:39 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:56:39 - src.models.train - INFO - Creating shifted target for horizon=2 days
2025-10-03 17:56:39 - src.models.train - INFO - Created target for horizon 2: 1188 samples (2 rows removed due to shifting)
2025-10-03 17:56:39 - src.models.train - INFO - Data split: Train=712 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 17:56:39 - src.models.train - INFO - Features: 47
2025-10-03 17:56:39 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:40 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:40 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:40 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:40 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:40 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:40 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:40 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:40 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:40 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:41 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:41 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:41 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:41 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:41 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:41 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:41 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=9869f243-d775-4ba4-8d7e-61815abea743 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:56:41 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:56:41 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:41 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:41 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:42 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:42 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:43 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:56:43 - src.models.train - INFO - Best validation MAE: 6.2331
2025-10-03 17:56:43 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 7, 'num_leaves': 20, 'learning_rate': 0.1788532743297921, 'min_child_samples': 30, 'subsample': 0.8500000000000001, 'colsample_bytree': 0.65, 'reg_alpha': 5.2, 'reg_lambda': 5.5, 'min_child_weight': 0.0054880470007660455}
2025-10-03 17:56:43 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=2)
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:43 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:56:43 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 17:56:43 - src.models.evaluation - INFO - Evaluation: MAE=8.66, RMSE=11.60, Coverage=89.6%, Width=31.71
2025-10-03 17:56:43 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:56:43 - src.models.train - INFO -   MAE: 8.6611
2025-10-03 17:56:43 - src.models.train - INFO -   RMSE: 11.5989
2025-10-03 17:56:43 - src.models.train - INFO -   Coverage: 89.58%
2025-10-03 17:56:43 - src.models.train - INFO -   Interval Width: 31.71
2025-10-03 17:56:43 - src.models.train - INFO - Training complete for horizon 2
2025-10-03 17:56:43 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:56:43 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.2331, test_mae=8.6611, test_rmse=11.5989, test_coverage=0.8958, test_interval_width=31.7143
2025-10-03 17:56:43 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 2: MAE=8.66, RMSE=11.60
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_2.pkl
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Model saved successfully (204.9 KB)
2025-10-03 17:56:43 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:56:43 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_2
2025-10-03 17:56:43 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:43 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:43 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 2, stage Staging
2025-10-03 17:56:43 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:56:43 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:56:43 - src.models.model_promotion - INFO - Test MAE: 8.6611, Threshold: 15.0000
2025-10-03 17:56:43 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.6611 < 15.0000)
2025-10-03 17:56:43 - src.models.train - INFO - Starting training for horizon 3 days
2025-10-03 17:56:43 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:56:43 - src.models.train - INFO - Creating shifted target for horizon=3 days
2025-10-03 17:56:43 - src.models.train - INFO - Created target for horizon 3: 1187 samples (3 rows removed due to shifting)
2025-10-03 17:56:43 - src.models.train - INFO - Data split: Train=712 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.1%)
2025-10-03 17:56:43 - src.models.train - INFO - Features: 47
2025-10-03 17:56:43 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:43 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:45 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:45 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:45 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:46 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:56:46 - src.models.train - INFO - Best validation MAE: 6.5140
2025-10-03 17:56:46 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:56:46 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=3)
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 17:56:46 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:56:46 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 17:56:46 - src.models.evaluation - INFO - Evaluation: MAE=7.54, RMSE=10.88, Coverage=94.6%, Width=40.68
2025-10-03 17:56:46 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:56:46 - src.models.train - INFO -   MAE: 7.5393
2025-10-03 17:56:46 - src.models.train - INFO -   RMSE: 10.8759
2025-10-03 17:56:46 - src.models.train - INFO -   Coverage: 94.56%
2025-10-03 17:56:46 - src.models.train - INFO -   Interval Width: 40.68
2025-10-03 17:56:46 - src.models.train - INFO - Training complete for horizon 3
2025-10-03 17:56:46 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:56:46 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5140, test_mae=7.5393, test_rmse=10.8759, test_coverage=0.9456, test_interval_width=40.6843
2025-10-03 17:56:46 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 3: MAE=7.54, RMSE=10.88
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_3.pkl
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Model saved successfully (188.8 KB)
2025-10-03 17:56:46 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:56:46 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_3
2025-10-03 17:56:46 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:46 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:46 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 3, stage Staging
2025-10-03 17:56:46 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:56:46 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:56:46 - src.models.model_promotion - INFO - Test MAE: 7.5393, Threshold: 15.0000
2025-10-03 17:56:46 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5393 < 15.0000)
2025-10-03 17:56:46 - src.models.train - INFO - Starting training for horizon 4 days
2025-10-03 17:56:46 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:56:46 - src.models.train - INFO - Creating shifted target for horizon=4 days
2025-10-03 17:56:46 - src.models.train - INFO - Created target for horizon 4: 1186 samples (4 rows removed due to shifting)
2025-10-03 17:56:46 - src.models.train - INFO - Data split: Train=711 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.2%)
2025-10-03 17:56:46 - src.models.train - INFO - Features: 47
2025-10-03 17:56:46 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:47 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:47 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:47 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:56:47 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:48 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:48 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:48 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:49 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:49 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:50 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:56:50 - src.models.train - INFO - Best validation MAE: 6.6654
2025-10-03 17:56:50 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 17:56:50 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=4)
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:50 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:56:50 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 17:56:50 - src.models.evaluation - INFO - Evaluation: MAE=7.57, RMSE=11.08, Coverage=95.4%, Width=38.35
2025-10-03 17:56:50 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:56:50 - src.models.train - INFO -   MAE: 7.5740
2025-10-03 17:56:50 - src.models.train - INFO -   RMSE: 11.0843
2025-10-03 17:56:50 - src.models.train - INFO -   Coverage: 95.40%
2025-10-03 17:56:50 - src.models.train - INFO -   Interval Width: 38.35
2025-10-03 17:56:50 - src.models.train - INFO - Training complete for horizon 4
2025-10-03 17:56:50 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:56:50 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.6654, test_mae=7.5740, test_rmse=11.0843, test_coverage=0.9540, test_interval_width=38.3513
2025-10-03 17:56:50 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 4: MAE=7.57, RMSE=11.08
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_4.pkl
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Model saved successfully (663.3 KB)
2025-10-03 17:56:50 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:56:50 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_4
2025-10-03 17:56:50 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:50 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:50 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 4, stage Staging
2025-10-03 17:56:50 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:56:50 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:56:50 - src.models.model_promotion - INFO - Test MAE: 7.5740, Threshold: 15.0000
2025-10-03 17:56:50 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5740 < 15.0000)
2025-10-03 17:56:50 - src.models.train - INFO - Starting training for horizon 5 days
2025-10-03 17:56:50 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:56:50 - src.models.train - INFO - Creating shifted target for horizon=5 days
2025-10-03 17:56:50 - src.models.train - INFO - Created target for horizon 5: 1185 samples (5 rows removed due to shifting)
2025-10-03 17:56:50 - src.models.train - INFO - Data split: Train=711 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:56:50 - src.models.train - INFO - Features: 47
2025-10-03 17:56:50 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:51 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:51 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:51 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:53 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:53 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:54 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:56:54 - src.models.train - INFO - Best validation MAE: 6.5851
2025-10-03 17:56:54 - src.models.train - INFO - Best parameters: {'n_estimators': 220, 'max_depth': 12, 'num_leaves': 150, 'learning_rate': 0.030405325392865647, 'min_child_samples': 20, 'subsample': 0.55, 'colsample_bytree': 0.5, 'reg_alpha': 8.700000000000001, 'reg_lambda': 6.0, 'min_child_weight': 0.6796578090758157}
2025-10-03 17:56:54 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=5)
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 17:56:54 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:56:54 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:56:54 - src.models.evaluation - INFO - Evaluation: MAE=8.03, RMSE=11.11, Coverage=95.8%, Width=46.27
2025-10-03 17:56:54 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:56:54 - src.models.train - INFO -   MAE: 8.0314
2025-10-03 17:56:54 - src.models.train - INFO -   RMSE: 11.1115
2025-10-03 17:56:54 - src.models.train - INFO -   Coverage: 95.80%
2025-10-03 17:56:54 - src.models.train - INFO -   Interval Width: 46.27
2025-10-03 17:56:54 - src.models.train - INFO - Training complete for horizon 5
2025-10-03 17:56:54 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:56:54 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5851, test_mae=8.0314, test_rmse=11.1115, test_coverage=0.9580, test_interval_width=46.2685
2025-10-03 17:56:54 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 5: MAE=8.03, RMSE=11.11
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_5.pkl
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Model saved successfully (492.5 KB)
2025-10-03 17:56:54 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:56:54 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_5
2025-10-03 17:56:54 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:54 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:54 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 5, stage Staging
2025-10-03 17:56:54 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:56:54 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:56:54 - src.models.model_promotion - INFO - Test MAE: 8.0314, Threshold: 15.0000
2025-10-03 17:56:54 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.0314 < 15.0000)
2025-10-03 17:56:54 - src.models.train - INFO - Starting training for horizon 6 days
2025-10-03 17:56:54 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:56:54 - src.models.train - INFO - Creating shifted target for horizon=6 days
2025-10-03 17:56:54 - src.models.train - INFO - Created target for horizon 6: 1184 samples (6 rows removed due to shifting)
2025-10-03 17:56:54 - src.models.train - INFO - Data split: Train=710 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:56:54 - src.models.train - INFO - Features: 47
2025-10-03 17:56:54 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:55 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:56:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:55 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:56:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:55 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:56:55 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:56:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:56 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:56:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:56 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:56:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:56 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:56:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:56:57 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:56:57 - src.models.train - INFO - Best validation MAE: 6.5153
2025-10-03 17:56:57 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 17:56:57 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 17:56:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=6)
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 17:56:58 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:56:58 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:56:58 - src.models.evaluation - INFO - Evaluation: MAE=7.51, RMSE=10.84, Coverage=94.1%, Width=42.82
2025-10-03 17:56:58 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:56:58 - src.models.train - INFO -   MAE: 7.5070
2025-10-03 17:56:58 - src.models.train - INFO -   RMSE: 10.8431
2025-10-03 17:56:58 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 17:56:58 - src.models.train - INFO -   Interval Width: 42.82
2025-10-03 17:56:58 - src.models.train - INFO - Training complete for horizon 6
2025-10-03 17:56:58 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:56:58 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5153, test_mae=7.5070, test_rmse=10.8431, test_coverage=0.9412, test_interval_width=42.8245
2025-10-03 17:56:58 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 6: MAE=7.51, RMSE=10.84
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_6.pkl
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Model saved successfully (187.9 KB)
2025-10-03 17:56:58 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:56:58 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_6
2025-10-03 17:56:58 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:58 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:56:58 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 6, stage Staging
2025-10-03 17:56:58 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:56:58 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:56:58 - src.models.model_promotion - INFO - Test MAE: 7.5070, Threshold: 15.0000
2025-10-03 17:56:58 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5070 < 15.0000)
2025-10-03 17:56:58 - src.models.train - INFO - Starting training for horizon 7 days
2025-10-03 17:56:58 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 17:56:58 - src.models.train - INFO - Creating shifted target for horizon=7 days
2025-10-03 17:56:58 - src.models.train - INFO - Created target for horizon 7: 1183 samples (7 rows removed due to shifting)
2025-10-03 17:56:58 - src.models.train - INFO - Data split: Train=709 (59.9%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 17:56:58 - src.models.train - INFO - Features: 47
2025-10-03 17:56:58 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:59 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:56:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:59 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:56:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:59 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:56:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:56:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:56:59 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:57:00 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:57:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:57:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:57:00 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:57:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:57:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:57:00 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:57:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:57:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:57:01 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:57:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:57:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 17:57:01 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:57:01 - src.models.train - INFO - Optuna search complete!
2025-10-03 17:57:01 - src.models.train - INFO - Best validation MAE: 6.3625
2025-10-03 17:57:01 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 17:57:01 - src.models.train - INFO - Training final model with best parameters
2025-10-03 17:57:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 17:57:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=7)
2025-10-03 17:57:01 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 17:57:01 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 17:57:01 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 17:57:01 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 17:57:02 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 17:57:02 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 17:57:02 - src.models.evaluation - INFO - Evaluation: MAE=7.62, RMSE=10.94, Coverage=94.1%, Width=38.87
2025-10-03 17:57:02 - src.models.train - INFO - Test set evaluation:
2025-10-03 17:57:02 - src.models.train - INFO -   MAE: 7.6238
2025-10-03 17:57:02 - src.models.train - INFO -   RMSE: 10.9354
2025-10-03 17:57:02 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 17:57:02 - src.models.train - INFO -   Interval Width: 38.87
2025-10-03 17:57:02 - src.models.train - INFO - Training complete for horizon 7
2025-10-03 17:57:02 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 17:57:02 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3625, test_mae=7.6238, test_rmse=10.9354, test_coverage=0.9412, test_interval_width=38.8694
2025-10-03 17:57:02 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 7: MAE=7.62, RMSE=10.94
2025-10-03 17:57:02 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_7.pkl
2025-10-03 17:57:02 - src.models.lightgbm_model - INFO - Model saved successfully (640.7 KB)
2025-10-03 17:57:02 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 17:57:02 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_7
2025-10-03 17:57:02 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:57:02 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 17:57:02 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 7, stage Staging
2025-10-03 17:57:02 - src.models.model_promotion - INFO - No production model found
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Test MAE: 7.6238, Threshold: 15.0000
2025-10-03 17:57:02 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.6238 < 15.0000)
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_1
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_2
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_3
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_4
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_5
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_6
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_7
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 17:57:02 - src.models.model_promotion - INFO - No models to archive
2025-10-03 17:57:02 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/artifacts/ "HTTP/1.1 201 Created"
2025-10-03 17:57:02 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - success
2025-10-03 17:57:02 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/f8ae940a-936d-498f-9b0c-96065e7f4bf2/set_state "HTTP/1.1 201 Created"
2025-10-03 17:57:02 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 17:57:02 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=e4dea2d0-e752-4aff-ae16-9422cfcd9583 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 17:57:02 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 17:57:02 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 17:57:02 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d2f88615-b8fc-4cf6-af1d-d714fed69179/set_state "HTTP/1.1 201 Created"
2025-10-03 17:57:02 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/d2f88615-b8fc-4cf6-af1d-d714fed69179 "HTTP/1.1 200 OK"
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:57:02 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/aba95944-47d3-4eb7-86a2-fc3b3f1ba70e "HTTP/1.1 200 OK"
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:57:02 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:57:02 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:57:02 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:57:02 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:57:02 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 17:57:02 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:57:03 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 17:57:03 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:57:03 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:57:03 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 17:57:03 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:57:03 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:57:03 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:57:03 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_1.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_1.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=1)
2025-10-03 17:57:03 - src.models.predict - INFO - âœ“ Loaded model for horizon 1 from local file
2025-10-03 17:57:03 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_2
2025-10-03 17:57:03 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 2: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_2.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_2.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=2)
2025-10-03 17:57:03 - src.models.predict - INFO - âœ“ Loaded model for horizon 2 from local file
2025-10-03 17:57:03 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_3
2025-10-03 17:57:03 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 3: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_3.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_3.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=3)
2025-10-03 17:57:03 - src.models.predict - INFO - âœ“ Loaded model for horizon 3 from local file
2025-10-03 17:57:03 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_4
2025-10-03 17:57:03 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 4: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_4.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_4.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=4)
2025-10-03 17:57:03 - src.models.predict - INFO - âœ“ Loaded model for horizon 4 from local file
2025-10-03 17:57:03 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_5
2025-10-03 17:57:03 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 5: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_5.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_5.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=5)
2025-10-03 17:57:03 - src.models.predict - INFO - âœ“ Loaded model for horizon 5 from local file
2025-10-03 17:57:03 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_6
2025-10-03 17:57:03 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 6: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_6.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_6.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=6)
2025-10-03 17:57:03 - src.models.predict - INFO - âœ“ Loaded model for horizon 6 from local file
2025-10-03 17:57:03 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_7
2025-10-03 17:57:03 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 7: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 17:57:03 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_7.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_7.pkl
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 17:57:03 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=7)
2025-10-03 17:57:03 - src.models.predict - INFO - âœ“ Loaded model for horizon 7 from local file
2025-10-03 17:57:03 - src.models.predict - WARNING - Used local file fallback for model loading (running in local/test mode)
2025-10-03 17:57:03 - src.models.predict - INFO - Preparing features for prediction
2025-10-03 17:57:03 - src.models.predict - INFO - Base date for predictions: 2025-10-03
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Added 32 date/time features
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:57:03 - src.data.feature_engineering - INFO - Weekend days: 2/7 (28.6%)
2025-10-03 17:57:03 - src.models.predict - INFO - Prepared features for 7 prediction days
2025-10-03 17:57:03 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:57:03 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:57:08 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:57:13 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:57:18 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:57:18 - prefect.task_runs - ERROR - Task run failed with exception: LightGBMError('The number of features in data (65) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.') - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 222, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (65) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 17:57:18 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:57:18 - prefect.task_runs - ERROR - Finished in state Failed('Task run encountered an exception LightGBMError: The number of features in data (65) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
2025-10-03 17:57:18 - prefect.flow_runs - ERROR - Prediction flow failed: The number of features in data (65) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 17:57:18 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 17:57:18 - prefect.flow_runs - ERROR - Encountered exception during execution: LightGBMError('The number of features in data (65) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 194, in prediction_flow
    predictions = generate_predictions(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 222, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (65) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 17:57:18 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:57:18 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d2f88615-b8fc-4cf6-af1d-d714fed69179/set_state "HTTP/1.1 201 Created"
2025-10-03 17:57:18 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d2f88615-b8fc-4cf6-af1d-d714fed69179/set_state "HTTP/1.1 200 OK"
2025-10-03 17:57:19 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:58:18 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d2f88615-b8fc-4cf6-af1d-d714fed69179/set_state "HTTP/1.1 201 Created"
2025-10-03 17:58:18 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/d2f88615-b8fc-4cf6-af1d-d714fed69179 "HTTP/1.1 200 OK"
2025-10-03 17:58:18 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:58:19 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:58:19 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:58:19 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:58:19 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:58:19 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:58:19 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:58:19 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:58:19 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:58:19 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:58:19 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:58:19 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:58:19 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:58:19 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:58:19 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:58:19 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 17:58:19 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:58:19 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 17:58:19 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:58:19 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:58:19 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 17:58:19 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:58:19 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:58:19 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:58:19 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_1.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_1.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=1)
2025-10-03 17:58:19 - src.models.predict - INFO - âœ“ Loaded model for horizon 1 from local file
2025-10-03 17:58:19 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_2
2025-10-03 17:58:19 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 2: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_2.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_2.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=2)
2025-10-03 17:58:19 - src.models.predict - INFO - âœ“ Loaded model for horizon 2 from local file
2025-10-03 17:58:19 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_3
2025-10-03 17:58:19 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 3: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_3.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_3.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=3)
2025-10-03 17:58:19 - src.models.predict - INFO - âœ“ Loaded model for horizon 3 from local file
2025-10-03 17:58:19 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_4
2025-10-03 17:58:19 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 4: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_4.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_4.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=4)
2025-10-03 17:58:19 - src.models.predict - INFO - âœ“ Loaded model for horizon 4 from local file
2025-10-03 17:58:19 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_5
2025-10-03 17:58:19 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 5: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_5.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_5.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=5)
2025-10-03 17:58:19 - src.models.predict - INFO - âœ“ Loaded model for horizon 5 from local file
2025-10-03 17:58:19 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_6
2025-10-03 17:58:19 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 6: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_6.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_6.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=6)
2025-10-03 17:58:19 - src.models.predict - INFO - âœ“ Loaded model for horizon 6 from local file
2025-10-03 17:58:19 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_7
2025-10-03 17:58:19 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 7: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 17:58:19 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_7.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_7.pkl
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 17:58:19 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=7)
2025-10-03 17:58:19 - src.models.predict - INFO - âœ“ Loaded model for horizon 7 from local file
2025-10-03 17:58:19 - src.models.predict - WARNING - Used local file fallback for model loading (running in local/test mode)
2025-10-03 17:58:19 - src.models.predict - INFO - Preparing features for prediction
2025-10-03 17:58:19 - src.models.predict - INFO - Base date for predictions: 2025-10-03
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Added 32 date/time features
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:58:19 - src.data.feature_engineering - INFO - Weekend days: 2/7 (28.6%)
2025-10-03 17:58:19 - src.models.predict - INFO - Prepared features for 7 prediction days
2025-10-03 17:58:20 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:58:25 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:58:30 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:58:35 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:58:35 - prefect.task_runs - ERROR - Task run failed with exception: LightGBMError('The number of features in data (65) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.') - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 222, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (65) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 17:58:35 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:58:35 - prefect.task_runs - ERROR - Finished in state Failed('Task run encountered an exception LightGBMError: The number of features in data (65) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
2025-10-03 17:58:35 - prefect.flow_runs - ERROR - Prediction flow failed: The number of features in data (65) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 17:58:35 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 17:58:35 - prefect.flow_runs - ERROR - Encountered exception during execution: LightGBMError('The number of features in data (65) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 194, in prediction_flow
    predictions = generate_predictions(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 222, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (65) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 17:58:35 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:58:35 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d2f88615-b8fc-4cf6-af1d-d714fed69179/set_state "HTTP/1.1 201 Created"
2025-10-03 17:58:35 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d2f88615-b8fc-4cf6-af1d-d714fed69179/set_state "HTTP/1.1 200 OK"
2025-10-03 17:58:36 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 17:59:35 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d2f88615-b8fc-4cf6-af1d-d714fed69179/set_state "HTTP/1.1 201 Created"
2025-10-03 17:59:35 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/d2f88615-b8fc-4cf6-af1d-d714fed69179 "HTTP/1.1 200 OK"
2025-10-03 17:59:35 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 17:59:35 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 17:59:36 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 17:59:36 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 17:59:36 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 17:59:36 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 17:59:36 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 17:59:36 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 17:59:36 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 17:59:36 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 17:59:36 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 17:59:36 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 17:59:36 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 17:59:36 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 17:59:36 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 17:59:36 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 17:59:36 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 17:59:36 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 17:59:36 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 17:59:36 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 17:59:36 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 17:59:36 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Added change features
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 17:59:36 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 17:59:36 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 17:59:36 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_1.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_1.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=1)
2025-10-03 17:59:36 - src.models.predict - INFO - âœ“ Loaded model for horizon 1 from local file
2025-10-03 17:59:36 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_2
2025-10-03 17:59:36 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 2: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_2.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_2.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=2)
2025-10-03 17:59:36 - src.models.predict - INFO - âœ“ Loaded model for horizon 2 from local file
2025-10-03 17:59:36 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_3
2025-10-03 17:59:36 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 3: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_3.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_3.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=3)
2025-10-03 17:59:36 - src.models.predict - INFO - âœ“ Loaded model for horizon 3 from local file
2025-10-03 17:59:36 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_4
2025-10-03 17:59:36 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 4: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_4.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_4.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=4)
2025-10-03 17:59:36 - src.models.predict - INFO - âœ“ Loaded model for horizon 4 from local file
2025-10-03 17:59:36 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_5
2025-10-03 17:59:36 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 5: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_5.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_5.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=5)
2025-10-03 17:59:36 - src.models.predict - INFO - âœ“ Loaded model for horizon 5 from local file
2025-10-03 17:59:36 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_6
2025-10-03 17:59:36 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 6: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_6.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_6.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=6)
2025-10-03 17:59:36 - src.models.predict - INFO - âœ“ Loaded model for horizon 6 from local file
2025-10-03 17:59:36 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_7
2025-10-03 17:59:36 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 7: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 17:59:36 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_7.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_7.pkl
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 17:59:36 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=7)
2025-10-03 17:59:36 - src.models.predict - INFO - âœ“ Loaded model for horizon 7 from local file
2025-10-03 17:59:36 - src.models.predict - WARNING - Used local file fallback for model loading (running in local/test mode)
2025-10-03 17:59:36 - src.models.predict - INFO - Preparing features for prediction
2025-10-03 17:59:36 - src.models.predict - INFO - Base date for predictions: 2025-10-03
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Added 32 date/time features
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 17:59:36 - src.data.feature_engineering - INFO - Weekend days: 2/7 (28.6%)
2025-10-03 17:59:36 - src.models.predict - INFO - Prepared features for 7 prediction days
2025-10-03 17:59:36 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:59:41 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:59:46 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:59:52 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 17:59:52 - prefect.task_runs - ERROR - Task run failed with exception: LightGBMError('The number of features in data (65) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.') - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 222, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (65) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 17:59:52 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:59:52 - prefect.task_runs - ERROR - Finished in state Failed('Task run encountered an exception LightGBMError: The number of features in data (65) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
2025-10-03 17:59:52 - prefect.flow_runs - ERROR - Prediction flow failed: The number of features in data (65) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 17:59:52 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 17:59:52 - prefect.flow_runs - ERROR - Encountered exception during execution: LightGBMError('The number of features in data (65) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 194, in prediction_flow
    predictions = generate_predictions(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 222, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (65) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 17:59:52 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 17:59:52 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d2f88615-b8fc-4cf6-af1d-d714fed69179/set_state "HTTP/1.1 201 Created"
2025-10-03 17:59:52 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:03:17 - root - INFO - Logging configured successfully
2025-10-03 18:03:17 - root - INFO - Log level: INFO
2025-10-03 18:03:17 - root - INFO - Console logging: enabled
2025-10-03 18:03:17 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 18:03:17 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:03:18 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=e5a705de-bbd2-44fe-9c98-983c9d926a36 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:03:18 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:03:18 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:03:18 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d13fd2e5-50f4-4d0f-a267-24ef65121ed4/set_state "HTTP/1.1 201 Created"
2025-10-03 18:03:18 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/d13fd2e5-50f4-4d0f-a267-24ef65121ed4 "HTTP/1.1 200 OK"
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:03:18 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:03:18 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:03:18 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:03:18 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:03:18 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:03:18 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 18:03:18 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:03:19 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 18:03:19 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:03:19 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:03:19 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 18:03:19 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:03:19 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:03:19 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 18:03:19 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 18:03:19 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 18:03:19 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:03:19 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 18:03:19 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 18:03:19 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:03:19 - src.models.train - INFO - Features: 47
2025-10-03 18:03:19 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:03:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:19 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:03:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:19 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:03:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:20 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:03:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:20 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:03:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:20 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:03:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:21 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:03:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:21 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:03:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:21 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:03:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:03:22 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:03:22 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 18:03:22 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:03:22 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:03:22 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:03:22 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:03:22 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 18:03:22 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:03:22 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 18:03:22 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 18:03:22 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 18:03:22 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 18:03:22 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 18:03:22 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:03:22 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 18:03:22 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 18:03:22 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:03:22 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_1
2025-10-03 18:03:22 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:22 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:22 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 1, stage Staging
2025-10-03 18:03:22 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:03:22 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:03:22 - src.models.model_promotion - INFO - Test MAE: 7.3256, Threshold: 15.0000
2025-10-03 18:03:22 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.3256 < 15.0000)
2025-10-03 18:03:22 - src.models.train - INFO - Starting training for horizon 2 days
2025-10-03 18:03:22 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:03:22 - src.models.train - INFO - Creating shifted target for horizon=2 days
2025-10-03 18:03:22 - src.models.train - INFO - Created target for horizon 2: 1188 samples (2 rows removed due to shifting)
2025-10-03 18:03:22 - src.models.train - INFO - Data split: Train=712 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:03:22 - src.models.train - INFO - Features: 47
2025-10-03 18:03:22 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:24 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:24 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=eda6c570-7e04-496d-9a7d-f45175657465 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:03:24 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:03:24 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:25 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:03:25 - src.models.train - INFO - Best validation MAE: 6.2331
2025-10-03 18:03:25 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 7, 'num_leaves': 20, 'learning_rate': 0.1788532743297921, 'min_child_samples': 30, 'subsample': 0.8500000000000001, 'colsample_bytree': 0.65, 'reg_alpha': 5.2, 'reg_lambda': 5.5, 'min_child_weight': 0.0054880470007660455}
2025-10-03 18:03:25 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=2)
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:25 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:03:25 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:03:25 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:03:25 - src.models.evaluation - INFO - Evaluation: MAE=8.66, RMSE=11.60, Coverage=89.6%, Width=31.71
2025-10-03 18:03:25 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:03:25 - src.models.train - INFO -   MAE: 8.6611
2025-10-03 18:03:25 - src.models.train - INFO -   RMSE: 11.5989
2025-10-03 18:03:25 - src.models.train - INFO -   Coverage: 89.58%
2025-10-03 18:03:25 - src.models.train - INFO -   Interval Width: 31.71
2025-10-03 18:03:25 - src.models.train - INFO - Training complete for horizon 2
2025-10-03 18:03:25 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:03:26 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.2331, test_mae=8.6611, test_rmse=11.5989, test_coverage=0.8958, test_interval_width=31.7143
2025-10-03 18:03:26 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 2: MAE=8.66, RMSE=11.60
2025-10-03 18:03:26 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_2.pkl
2025-10-03 18:03:26 - src.models.lightgbm_model - INFO - Model saved successfully (204.9 KB)
2025-10-03 18:03:26 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:03:26 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_2
2025-10-03 18:03:26 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:26 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:26 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 2, stage Staging
2025-10-03 18:03:26 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:03:26 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:03:26 - src.models.model_promotion - INFO - Test MAE: 8.6611, Threshold: 15.0000
2025-10-03 18:03:26 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.6611 < 15.0000)
2025-10-03 18:03:26 - src.models.train - INFO - Starting training for horizon 3 days
2025-10-03 18:03:26 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:03:26 - src.models.train - INFO - Creating shifted target for horizon=3 days
2025-10-03 18:03:26 - src.models.train - INFO - Created target for horizon 3: 1187 samples (3 rows removed due to shifting)
2025-10-03 18:03:26 - src.models.train - INFO - Data split: Train=712 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.1%)
2025-10-03 18:03:26 - src.models.train - INFO - Features: 47
2025-10-03 18:03:26 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:03:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:26 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:26 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:03:26 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:26 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:26 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:26 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:27 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:27 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:27 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:27 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:27 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:27 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:27 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:27 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:27 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:28 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:28 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:28 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:28 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:28 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:28 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:28 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:28 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:28 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:29 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:03:29 - src.models.train - INFO - Best validation MAE: 6.5140
2025-10-03 18:03:29 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:03:29 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=3)
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:03:29 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:03:29 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:03:29 - src.models.evaluation - INFO - Evaluation: MAE=7.54, RMSE=10.88, Coverage=94.6%, Width=40.68
2025-10-03 18:03:29 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:03:29 - src.models.train - INFO -   MAE: 7.5393
2025-10-03 18:03:29 - src.models.train - INFO -   RMSE: 10.8759
2025-10-03 18:03:29 - src.models.train - INFO -   Coverage: 94.56%
2025-10-03 18:03:29 - src.models.train - INFO -   Interval Width: 40.68
2025-10-03 18:03:29 - src.models.train - INFO - Training complete for horizon 3
2025-10-03 18:03:29 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:03:29 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5140, test_mae=7.5393, test_rmse=10.8759, test_coverage=0.9456, test_interval_width=40.6843
2025-10-03 18:03:29 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 3: MAE=7.54, RMSE=10.88
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_3.pkl
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Model saved successfully (188.8 KB)
2025-10-03 18:03:29 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:03:29 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_3
2025-10-03 18:03:29 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:29 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:29 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 3, stage Staging
2025-10-03 18:03:29 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:03:29 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:03:29 - src.models.model_promotion - INFO - Test MAE: 7.5393, Threshold: 15.0000
2025-10-03 18:03:29 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5393 < 15.0000)
2025-10-03 18:03:29 - src.models.train - INFO - Starting training for horizon 4 days
2025-10-03 18:03:29 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:03:29 - src.models.train - INFO - Creating shifted target for horizon=4 days
2025-10-03 18:03:29 - src.models.train - INFO - Created target for horizon 4: 1186 samples (4 rows removed due to shifting)
2025-10-03 18:03:29 - src.models.train - INFO - Data split: Train=711 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.2%)
2025-10-03 18:03:29 - src.models.train - INFO - Features: 47
2025-10-03 18:03:29 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:29 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:30 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:30 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:31 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:31 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:31 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:31 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:31 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:31 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:32 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:03:32 - src.models.train - INFO - Best validation MAE: 6.6654
2025-10-03 18:03:32 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:03:32 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=4)
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:32 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:03:32 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:03:33 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:03:33 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:03:33 - src.models.evaluation - INFO - Evaluation: MAE=7.57, RMSE=11.08, Coverage=95.4%, Width=38.35
2025-10-03 18:03:33 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:03:33 - src.models.train - INFO -   MAE: 7.5740
2025-10-03 18:03:33 - src.models.train - INFO -   RMSE: 11.0843
2025-10-03 18:03:33 - src.models.train - INFO -   Coverage: 95.40%
2025-10-03 18:03:33 - src.models.train - INFO -   Interval Width: 38.35
2025-10-03 18:03:33 - src.models.train - INFO - Training complete for horizon 4
2025-10-03 18:03:33 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:03:33 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.6654, test_mae=7.5740, test_rmse=11.0843, test_coverage=0.9540, test_interval_width=38.3513
2025-10-03 18:03:33 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 4: MAE=7.57, RMSE=11.08
2025-10-03 18:03:33 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_4.pkl
2025-10-03 18:03:33 - src.models.lightgbm_model - INFO - Model saved successfully (663.3 KB)
2025-10-03 18:03:33 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:03:33 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_4
2025-10-03 18:03:33 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:33 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:33 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 4, stage Staging
2025-10-03 18:03:33 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:03:33 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:03:33 - src.models.model_promotion - INFO - Test MAE: 7.5740, Threshold: 15.0000
2025-10-03 18:03:33 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5740 < 15.0000)
2025-10-03 18:03:33 - src.models.train - INFO - Starting training for horizon 5 days
2025-10-03 18:03:33 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:03:33 - src.models.train - INFO - Creating shifted target for horizon=5 days
2025-10-03 18:03:33 - src.models.train - INFO - Created target for horizon 5: 1185 samples (5 rows removed due to shifting)
2025-10-03 18:03:33 - src.models.train - INFO - Data split: Train=711 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:03:33 - src.models.train - INFO - Features: 47
2025-10-03 18:03:33 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:03:33 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:33 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:34 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:34 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:35 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:35 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:36 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:36 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:37 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:37 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:37 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:37 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:37 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:03:37 - src.models.train - INFO - Best validation MAE: 6.5851
2025-10-03 18:03:37 - src.models.train - INFO - Best parameters: {'n_estimators': 220, 'max_depth': 12, 'num_leaves': 150, 'learning_rate': 0.030405325392865647, 'min_child_samples': 20, 'subsample': 0.55, 'colsample_bytree': 0.5, 'reg_alpha': 8.700000000000001, 'reg_lambda': 6.0, 'min_child_weight': 0.6796578090758157}
2025-10-03 18:03:37 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:03:37 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:03:37 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=5)
2025-10-03 18:03:37 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:03:37 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:03:37 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:03:37 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:03:38 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:03:38 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:03:38 - src.models.evaluation - INFO - Evaluation: MAE=8.03, RMSE=11.11, Coverage=95.8%, Width=46.27
2025-10-03 18:03:38 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:03:38 - src.models.train - INFO -   MAE: 8.0314
2025-10-03 18:03:38 - src.models.train - INFO -   RMSE: 11.1115
2025-10-03 18:03:38 - src.models.train - INFO -   Coverage: 95.80%
2025-10-03 18:03:38 - src.models.train - INFO -   Interval Width: 46.27
2025-10-03 18:03:38 - src.models.train - INFO - Training complete for horizon 5
2025-10-03 18:03:38 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:03:38 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5851, test_mae=8.0314, test_rmse=11.1115, test_coverage=0.9580, test_interval_width=46.2685
2025-10-03 18:03:38 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 5: MAE=8.03, RMSE=11.11
2025-10-03 18:03:38 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_5.pkl
2025-10-03 18:03:38 - src.models.lightgbm_model - INFO - Model saved successfully (492.5 KB)
2025-10-03 18:03:38 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:03:38 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_5
2025-10-03 18:03:38 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:38 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:38 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 5, stage Staging
2025-10-03 18:03:38 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:03:38 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:03:38 - src.models.model_promotion - INFO - Test MAE: 8.0314, Threshold: 15.0000
2025-10-03 18:03:38 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.0314 < 15.0000)
2025-10-03 18:03:38 - src.models.train - INFO - Starting training for horizon 6 days
2025-10-03 18:03:38 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:03:38 - src.models.train - INFO - Creating shifted target for horizon=6 days
2025-10-03 18:03:38 - src.models.train - INFO - Created target for horizon 6: 1184 samples (6 rows removed due to shifting)
2025-10-03 18:03:38 - src.models.train - INFO - Data split: Train=710 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:03:38 - src.models.train - INFO - Features: 47
2025-10-03 18:03:38 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:03:38 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:38 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:38 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:40 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:03:40 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:40 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:40 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:03:40 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:40 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:41 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:03:41 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:41 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:41 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:03:41 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:41 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:03:42 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:03:42 - src.models.train - INFO - Best validation MAE: 6.5153
2025-10-03 18:03:42 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:03:42 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=6)
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:03:42 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:03:42 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:03:42 - src.models.evaluation - INFO - Evaluation: MAE=7.51, RMSE=10.84, Coverage=94.1%, Width=42.82
2025-10-03 18:03:42 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:03:42 - src.models.train - INFO -   MAE: 7.5070
2025-10-03 18:03:42 - src.models.train - INFO -   RMSE: 10.8431
2025-10-03 18:03:42 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:03:42 - src.models.train - INFO -   Interval Width: 42.82
2025-10-03 18:03:42 - src.models.train - INFO - Training complete for horizon 6
2025-10-03 18:03:42 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:03:42 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5153, test_mae=7.5070, test_rmse=10.8431, test_coverage=0.9412, test_interval_width=42.8245
2025-10-03 18:03:42 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 6: MAE=7.51, RMSE=10.84
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_6.pkl
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Model saved successfully (187.9 KB)
2025-10-03 18:03:42 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:03:42 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_6
2025-10-03 18:03:42 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:42 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:42 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 6, stage Staging
2025-10-03 18:03:42 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:03:42 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:03:42 - src.models.model_promotion - INFO - Test MAE: 7.5070, Threshold: 15.0000
2025-10-03 18:03:42 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5070 < 15.0000)
2025-10-03 18:03:42 - src.models.train - INFO - Starting training for horizon 7 days
2025-10-03 18:03:42 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:03:42 - src.models.train - INFO - Creating shifted target for horizon=7 days
2025-10-03 18:03:42 - src.models.train - INFO - Created target for horizon 7: 1183 samples (7 rows removed due to shifting)
2025-10-03 18:03:42 - src.models.train - INFO - Data split: Train=709 (59.9%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:03:42 - src.models.train - INFO - Features: 47
2025-10-03 18:03:42 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:42 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:03:43 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:03:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:43 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:03:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:43 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:03:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:45 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:03:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:45 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:03:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:03:45 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:03:45 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:03:45 - src.models.train - INFO - Best validation MAE: 6.3625
2025-10-03 18:03:45 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:03:45 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:03:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:03:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=7)
2025-10-03 18:03:46 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:03:46 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:03:46 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:03:46 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:03:46 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:03:46 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:03:46 - src.models.evaluation - INFO - Evaluation: MAE=7.62, RMSE=10.94, Coverage=94.1%, Width=38.87
2025-10-03 18:03:46 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:03:46 - src.models.train - INFO -   MAE: 7.6238
2025-10-03 18:03:46 - src.models.train - INFO -   RMSE: 10.9354
2025-10-03 18:03:46 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:03:46 - src.models.train - INFO -   Interval Width: 38.87
2025-10-03 18:03:46 - src.models.train - INFO - Training complete for horizon 7
2025-10-03 18:03:46 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:03:46 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3625, test_mae=7.6238, test_rmse=10.9354, test_coverage=0.9412, test_interval_width=38.8694
2025-10-03 18:03:46 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 7: MAE=7.62, RMSE=10.94
2025-10-03 18:03:46 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_7.pkl
2025-10-03 18:03:46 - src.models.lightgbm_model - INFO - Model saved successfully (640.7 KB)
2025-10-03 18:03:46 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:03:46 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_7
2025-10-03 18:03:46 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:46 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:03:46 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 7, stage Staging
2025-10-03 18:03:46 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Test MAE: 7.6238, Threshold: 15.0000
2025-10-03 18:03:46 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.6238 < 15.0000)
2025-10-03 18:03:46 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_1
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_2
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_3
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_4
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_5
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_6
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_7
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:03:46 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:03:46 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/artifacts/ "HTTP/1.1 201 Created"
2025-10-03 18:03:46 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - success
2025-10-03 18:03:46 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d13fd2e5-50f4-4d0f-a267-24ef65121ed4/set_state "HTTP/1.1 201 Created"
2025-10-03 18:03:46 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:03:46 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=3d2d250b-0de9-4720-9e06-6d62ac9efd67 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:03:46 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:03:46 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:03:46 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d3cb71bc-cfe3-4603-98e4-56b76444a8fe/set_state "HTTP/1.1 201 Created"
2025-10-03 18:03:46 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/d3cb71bc-cfe3-4603-98e4-56b76444a8fe "HTTP/1.1 200 OK"
2025-10-03 18:03:46 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:03:46 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/aba95944-47d3-4eb7-86a2-fc3b3f1ba70e "HTTP/1.1 200 OK"
2025-10-03 18:03:47 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:03:47 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:03:47 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:03:47 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:03:47 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:03:47 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:03:47 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:03:47 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:03:47 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:03:47 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:03:47 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:03:47 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:03:47 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:03:47 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:03:47 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 18:03:47 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:03:47 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 18:03:47 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:03:47 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:03:47 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 18:03:47 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:03:47 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:03:47 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 18:03:47 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 18:03:47 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_1.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_1.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=1)
2025-10-03 18:03:47 - src.models.predict - INFO - âœ“ Loaded model for horizon 1 from local file
2025-10-03 18:03:47 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_2
2025-10-03 18:03:47 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 2: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_2.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_2.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=2)
2025-10-03 18:03:47 - src.models.predict - INFO - âœ“ Loaded model for horizon 2 from local file
2025-10-03 18:03:47 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_3
2025-10-03 18:03:47 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 3: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_3.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_3.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=3)
2025-10-03 18:03:47 - src.models.predict - INFO - âœ“ Loaded model for horizon 3 from local file
2025-10-03 18:03:47 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_4
2025-10-03 18:03:47 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 4: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_4.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_4.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=4)
2025-10-03 18:03:47 - src.models.predict - INFO - âœ“ Loaded model for horizon 4 from local file
2025-10-03 18:03:47 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_5
2025-10-03 18:03:47 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 5: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_5.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_5.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=5)
2025-10-03 18:03:47 - src.models.predict - INFO - âœ“ Loaded model for horizon 5 from local file
2025-10-03 18:03:47 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_6
2025-10-03 18:03:47 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 6: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_6.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_6.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=6)
2025-10-03 18:03:47 - src.models.predict - INFO - âœ“ Loaded model for horizon 6 from local file
2025-10-03 18:03:47 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_7
2025-10-03 18:03:47 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 7: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:03:47 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_7.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_7.pkl
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:03:47 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=7)
2025-10-03 18:03:47 - src.models.predict - INFO - âœ“ Loaded model for horizon 7 from local file
2025-10-03 18:03:47 - src.models.predict - WARNING - Used local file fallback for model loading (running in local/test mode)
2025-10-03 18:03:47 - src.models.predict - INFO - Preparing features for prediction
2025-10-03 18:03:47 - src.models.predict - INFO - Base date for predictions: 2025-10-03
2025-10-03 18:03:47 - src.models.predict - INFO - Prepared features for 7 prediction days
2025-10-03 18:03:47 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:03:52 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:03:58 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:04:03 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:04:03 - prefect.task_runs - ERROR - Task run failed with exception: LightGBMError('The number of features in data (56) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.') - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 237, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (56) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 18:04:03 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:04:03 - prefect.task_runs - ERROR - Finished in state Failed('Task run encountered an exception LightGBMError: The number of features in data (56) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
2025-10-03 18:04:03 - prefect.flow_runs - ERROR - Prediction flow failed: The number of features in data (56) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 18:04:03 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 18:04:03 - prefect.flow_runs - ERROR - Encountered exception during execution: LightGBMError('The number of features in data (56) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 194, in prediction_flow
    predictions = generate_predictions(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 237, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (56) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 18:04:03 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:04:03 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d3cb71bc-cfe3-4603-98e4-56b76444a8fe/set_state "HTTP/1.1 201 Created"
2025-10-03 18:04:03 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/d3cb71bc-cfe3-4603-98e4-56b76444a8fe/set_state "HTTP/1.1 200 OK"
2025-10-03 18:04:04 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:05:05 - root - INFO - Logging configured successfully
2025-10-03 18:05:05 - root - INFO - Log level: INFO
2025-10-03 18:05:05 - root - INFO - Console logging: enabled
2025-10-03 18:05:05 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 18:05:05 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:05:05 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=6746bde1-b3e7-49ff-8273-53a9734445b2 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:05:05 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:05:05 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:05:05 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/8959160e-0480-45af-8ce0-8cf446a40da0/set_state "HTTP/1.1 201 Created"
2025-10-03 18:05:05 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/8959160e-0480-45af-8ce0-8cf446a40da0 "HTTP/1.1 200 OK"
2025-10-03 18:05:05 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:05:05 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 18:05:05 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:05:05 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:05:05 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:05:05 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:05:05 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:05:05 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:05:05 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:05:05 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:05:05 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:05:05 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:05:05 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:05:05 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:05:06 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:05:06 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:05:06 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 18:05:06 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:05:06 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 18:05:06 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:05:06 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:05:06 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 18:05:06 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:05:06 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:05:06 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 18:05:06 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 18:05:06 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 18:05:06 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:05:06 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 18:05:06 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 18:05:06 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:05:06 - src.models.train - INFO - Features: 47
2025-10-03 18:05:06 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:05:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:08 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:05:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:08 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:05:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:08 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:05:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:05:09 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:05:09 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 18:05:09 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:05:09 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:05:09 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:05:09 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:05:10 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:05:10 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:05:10 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 18:05:10 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:05:10 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 18:05:10 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 18:05:10 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 18:05:10 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 18:05:10 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 18:05:10 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:05:10 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 18:05:10 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 18:05:10 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 18:05:10 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 18:05:10 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:05:10 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_1
2025-10-03 18:05:10 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:10 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:10 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 1, stage Staging
2025-10-03 18:05:10 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:05:10 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:05:10 - src.models.model_promotion - INFO - Test MAE: 7.3256, Threshold: 15.0000
2025-10-03 18:05:10 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.3256 < 15.0000)
2025-10-03 18:05:10 - src.models.train - INFO - Starting training for horizon 2 days
2025-10-03 18:05:10 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:05:10 - src.models.train - INFO - Creating shifted target for horizon=2 days
2025-10-03 18:05:10 - src.models.train - INFO - Created target for horizon 2: 1188 samples (2 rows removed due to shifting)
2025-10-03 18:05:10 - src.models.train - INFO - Data split: Train=712 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:05:10 - src.models.train - INFO - Features: 47
2025-10-03 18:05:10 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:05:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:10 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:10 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:11 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:11 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:11 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:12 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:12 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=c2104081-dded-4b1b-846c-073c6d4cda63 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:05:12 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:05:12 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:12 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:13 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:05:13 - src.models.train - INFO - Best validation MAE: 6.2331
2025-10-03 18:05:13 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 7, 'num_leaves': 20, 'learning_rate': 0.1788532743297921, 'min_child_samples': 30, 'subsample': 0.8500000000000001, 'colsample_bytree': 0.65, 'reg_alpha': 5.2, 'reg_lambda': 5.5, 'min_child_weight': 0.0054880470007660455}
2025-10-03 18:05:13 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=2)
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:13 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:05:13 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:05:13 - src.models.evaluation - INFO - Evaluation: MAE=8.66, RMSE=11.60, Coverage=89.6%, Width=31.71
2025-10-03 18:05:13 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:05:13 - src.models.train - INFO -   MAE: 8.6611
2025-10-03 18:05:13 - src.models.train - INFO -   RMSE: 11.5989
2025-10-03 18:05:13 - src.models.train - INFO -   Coverage: 89.58%
2025-10-03 18:05:13 - src.models.train - INFO -   Interval Width: 31.71
2025-10-03 18:05:13 - src.models.train - INFO - Training complete for horizon 2
2025-10-03 18:05:13 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:05:13 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.2331, test_mae=8.6611, test_rmse=11.5989, test_coverage=0.8958, test_interval_width=31.7143
2025-10-03 18:05:13 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 2: MAE=8.66, RMSE=11.60
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_2.pkl
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Model saved successfully (204.9 KB)
2025-10-03 18:05:13 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:05:13 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_2
2025-10-03 18:05:13 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:13 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:13 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 2, stage Staging
2025-10-03 18:05:13 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:05:13 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:05:13 - src.models.model_promotion - INFO - Test MAE: 8.6611, Threshold: 15.0000
2025-10-03 18:05:13 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.6611 < 15.0000)
2025-10-03 18:05:13 - src.models.train - INFO - Starting training for horizon 3 days
2025-10-03 18:05:13 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:05:13 - src.models.train - INFO - Creating shifted target for horizon=3 days
2025-10-03 18:05:13 - src.models.train - INFO - Created target for horizon 3: 1187 samples (3 rows removed due to shifting)
2025-10-03 18:05:13 - src.models.train - INFO - Data split: Train=712 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.1%)
2025-10-03 18:05:13 - src.models.train - INFO - Features: 47
2025-10-03 18:05:13 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:14 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:15 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:15 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:15 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:16 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:16 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:16 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:16 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:16 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:16 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:16 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:16 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:05:16 - src.models.train - INFO - Best validation MAE: 6.5140
2025-10-03 18:05:16 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:05:16 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:05:16 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:05:16 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=3)
2025-10-03 18:05:17 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:05:17 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:05:17 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:05:17 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:05:17 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:05:17 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:05:17 - src.models.evaluation - INFO - Evaluation: MAE=7.54, RMSE=10.88, Coverage=94.6%, Width=40.68
2025-10-03 18:05:17 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:05:17 - src.models.train - INFO -   MAE: 7.5393
2025-10-03 18:05:17 - src.models.train - INFO -   RMSE: 10.8759
2025-10-03 18:05:17 - src.models.train - INFO -   Coverage: 94.56%
2025-10-03 18:05:17 - src.models.train - INFO -   Interval Width: 40.68
2025-10-03 18:05:17 - src.models.train - INFO - Training complete for horizon 3
2025-10-03 18:05:17 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:05:17 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5140, test_mae=7.5393, test_rmse=10.8759, test_coverage=0.9456, test_interval_width=40.6843
2025-10-03 18:05:17 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 3: MAE=7.54, RMSE=10.88
2025-10-03 18:05:17 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_3.pkl
2025-10-03 18:05:17 - src.models.lightgbm_model - INFO - Model saved successfully (188.8 KB)
2025-10-03 18:05:17 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:05:17 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_3
2025-10-03 18:05:17 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:17 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:17 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 3, stage Staging
2025-10-03 18:05:17 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:05:17 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:05:17 - src.models.model_promotion - INFO - Test MAE: 7.5393, Threshold: 15.0000
2025-10-03 18:05:17 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5393 < 15.0000)
2025-10-03 18:05:17 - src.models.train - INFO - Starting training for horizon 4 days
2025-10-03 18:05:17 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:05:17 - src.models.train - INFO - Creating shifted target for horizon=4 days
2025-10-03 18:05:17 - src.models.train - INFO - Created target for horizon 4: 1186 samples (4 rows removed due to shifting)
2025-10-03 18:05:17 - src.models.train - INFO - Data split: Train=711 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.2%)
2025-10-03 18:05:17 - src.models.train - INFO - Features: 47
2025-10-03 18:05:17 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:05:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:17 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:18 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:19 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:19 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:19 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:20 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:20 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:20 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:05:20 - src.models.train - INFO - Best validation MAE: 6.6654
2025-10-03 18:05:20 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:05:20 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:05:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:05:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=4)
2025-10-03 18:05:20 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:20 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:05:20 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:05:20 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:05:21 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:05:21 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:05:21 - src.models.evaluation - INFO - Evaluation: MAE=7.57, RMSE=11.08, Coverage=95.4%, Width=38.35
2025-10-03 18:05:21 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:05:21 - src.models.train - INFO -   MAE: 7.5740
2025-10-03 18:05:21 - src.models.train - INFO -   RMSE: 11.0843
2025-10-03 18:05:21 - src.models.train - INFO -   Coverage: 95.40%
2025-10-03 18:05:21 - src.models.train - INFO -   Interval Width: 38.35
2025-10-03 18:05:21 - src.models.train - INFO - Training complete for horizon 4
2025-10-03 18:05:21 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:05:21 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.6654, test_mae=7.5740, test_rmse=11.0843, test_coverage=0.9540, test_interval_width=38.3513
2025-10-03 18:05:21 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 4: MAE=7.57, RMSE=11.08
2025-10-03 18:05:21 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_4.pkl
2025-10-03 18:05:21 - src.models.lightgbm_model - INFO - Model saved successfully (663.3 KB)
2025-10-03 18:05:21 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:05:21 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_4
2025-10-03 18:05:21 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:21 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:21 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 4, stage Staging
2025-10-03 18:05:21 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:05:21 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:05:21 - src.models.model_promotion - INFO - Test MAE: 7.5740, Threshold: 15.0000
2025-10-03 18:05:21 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5740 < 15.0000)
2025-10-03 18:05:21 - src.models.train - INFO - Starting training for horizon 5 days
2025-10-03 18:05:21 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:05:21 - src.models.train - INFO - Creating shifted target for horizon=5 days
2025-10-03 18:05:21 - src.models.train - INFO - Created target for horizon 5: 1185 samples (5 rows removed due to shifting)
2025-10-03 18:05:21 - src.models.train - INFO - Data split: Train=711 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:05:21 - src.models.train - INFO - Features: 47
2025-10-03 18:05:21 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:05:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:21 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:22 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:23 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:23 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:23 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:24 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:24 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:24 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:05:24 - src.models.train - INFO - Best validation MAE: 6.5851
2025-10-03 18:05:24 - src.models.train - INFO - Best parameters: {'n_estimators': 220, 'max_depth': 12, 'num_leaves': 150, 'learning_rate': 0.030405325392865647, 'min_child_samples': 20, 'subsample': 0.55, 'colsample_bytree': 0.5, 'reg_alpha': 8.700000000000001, 'reg_lambda': 6.0, 'min_child_weight': 0.6796578090758157}
2025-10-03 18:05:24 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:05:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:05:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=5)
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:05:25 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:05:25 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:05:25 - src.models.evaluation - INFO - Evaluation: MAE=8.03, RMSE=11.11, Coverage=95.8%, Width=46.27
2025-10-03 18:05:25 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:05:25 - src.models.train - INFO -   MAE: 8.0314
2025-10-03 18:05:25 - src.models.train - INFO -   RMSE: 11.1115
2025-10-03 18:05:25 - src.models.train - INFO -   Coverage: 95.80%
2025-10-03 18:05:25 - src.models.train - INFO -   Interval Width: 46.27
2025-10-03 18:05:25 - src.models.train - INFO - Training complete for horizon 5
2025-10-03 18:05:25 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:05:25 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5851, test_mae=8.0314, test_rmse=11.1115, test_coverage=0.9580, test_interval_width=46.2685
2025-10-03 18:05:25 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 5: MAE=8.03, RMSE=11.11
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_5.pkl
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Model saved successfully (492.5 KB)
2025-10-03 18:05:25 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:05:25 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_5
2025-10-03 18:05:25 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:25 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:25 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 5, stage Staging
2025-10-03 18:05:25 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:05:25 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:05:25 - src.models.model_promotion - INFO - Test MAE: 8.0314, Threshold: 15.0000
2025-10-03 18:05:25 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.0314 < 15.0000)
2025-10-03 18:05:25 - src.models.train - INFO - Starting training for horizon 6 days
2025-10-03 18:05:25 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:05:25 - src.models.train - INFO - Creating shifted target for horizon=6 days
2025-10-03 18:05:25 - src.models.train - INFO - Created target for horizon 6: 1184 samples (6 rows removed due to shifting)
2025-10-03 18:05:25 - src.models.train - INFO - Data split: Train=710 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:05:25 - src.models.train - INFO - Features: 47
2025-10-03 18:05:25 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:25 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:26 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:05:26 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:05:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:26 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:26 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:05:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:26 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:26 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:05:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:26 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:27 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:05:27 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:27 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:27 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:05:27 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:27 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:27 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:05:27 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:27 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:05:28 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:05:28 - src.models.train - INFO - Best validation MAE: 6.5153
2025-10-03 18:05:28 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:05:28 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=6)
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:05:28 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:05:28 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:05:28 - src.models.evaluation - INFO - Evaluation: MAE=7.51, RMSE=10.84, Coverage=94.1%, Width=42.82
2025-10-03 18:05:28 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:05:28 - src.models.train - INFO -   MAE: 7.5070
2025-10-03 18:05:28 - src.models.train - INFO -   RMSE: 10.8431
2025-10-03 18:05:28 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:05:28 - src.models.train - INFO -   Interval Width: 42.82
2025-10-03 18:05:28 - src.models.train - INFO - Training complete for horizon 6
2025-10-03 18:05:28 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:05:28 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5153, test_mae=7.5070, test_rmse=10.8431, test_coverage=0.9412, test_interval_width=42.8245
2025-10-03 18:05:28 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 6: MAE=7.51, RMSE=10.84
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_6.pkl
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Model saved successfully (187.9 KB)
2025-10-03 18:05:28 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:05:28 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_6
2025-10-03 18:05:28 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:28 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:28 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 6, stage Staging
2025-10-03 18:05:28 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:05:28 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:05:28 - src.models.model_promotion - INFO - Test MAE: 7.5070, Threshold: 15.0000
2025-10-03 18:05:28 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5070 < 15.0000)
2025-10-03 18:05:28 - src.models.train - INFO - Starting training for horizon 7 days
2025-10-03 18:05:28 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:05:28 - src.models.train - INFO - Creating shifted target for horizon=7 days
2025-10-03 18:05:28 - src.models.train - INFO - Created target for horizon 7: 1183 samples (7 rows removed due to shifting)
2025-10-03 18:05:28 - src.models.train - INFO - Data split: Train=709 (59.9%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:05:28 - src.models.train - INFO - Features: 47
2025-10-03 18:05:28 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:28 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:29 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:05:29 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:29 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:29 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:05:29 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:29 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:29 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:05:29 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:29 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:30 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:05:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:30 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:30 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:05:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:30 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:30 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:05:30 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:05:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:30 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:30 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:05:31 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:31 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:31 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:05:31 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:31 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:31 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:05:31 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:31 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:05:31 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:05:31 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:05:31 - src.models.train - INFO - Best validation MAE: 6.3625
2025-10-03 18:05:31 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:05:31 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:05:31 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:05:31 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=7)
2025-10-03 18:05:32 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:05:32 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:05:32 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:05:32 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:05:32 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:05:32 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:05:32 - src.models.evaluation - INFO - Evaluation: MAE=7.62, RMSE=10.94, Coverage=94.1%, Width=38.87
2025-10-03 18:05:32 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:05:32 - src.models.train - INFO -   MAE: 7.6238
2025-10-03 18:05:32 - src.models.train - INFO -   RMSE: 10.9354
2025-10-03 18:05:32 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:05:32 - src.models.train - INFO -   Interval Width: 38.87
2025-10-03 18:05:32 - src.models.train - INFO - Training complete for horizon 7
2025-10-03 18:05:32 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:05:32 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3625, test_mae=7.6238, test_rmse=10.9354, test_coverage=0.9412, test_interval_width=38.8694
2025-10-03 18:05:32 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 7: MAE=7.62, RMSE=10.94
2025-10-03 18:05:32 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_7.pkl
2025-10-03 18:05:32 - src.models.lightgbm_model - INFO - Model saved successfully (640.7 KB)
2025-10-03 18:05:32 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:05:32 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_7
2025-10-03 18:05:32 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:32 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:05:32 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 7, stage Staging
2025-10-03 18:05:32 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Test MAE: 7.6238, Threshold: 15.0000
2025-10-03 18:05:32 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.6238 < 15.0000)
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_1
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_2
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_3
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_4
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_5
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_6
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_7
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:05:32 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:05:32 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/artifacts/ "HTTP/1.1 201 Created"
2025-10-03 18:05:32 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - success
2025-10-03 18:05:32 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/8959160e-0480-45af-8ce0-8cf446a40da0/set_state "HTTP/1.1 201 Created"
2025-10-03 18:05:32 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:05:32 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=cf04e80b-902d-4e11-beaf-5b8c5675c5e8 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:05:32 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:05:32 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:05:32 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/21b9093f-b803-41a9-9e17-e0bcca9e40d7/set_state "HTTP/1.1 201 Created"
2025-10-03 18:05:32 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/21b9093f-b803-41a9-9e17-e0bcca9e40d7 "HTTP/1.1 200 OK"
2025-10-03 18:05:32 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:05:32 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/aba95944-47d3-4eb7-86a2-fc3b3f1ba70e "HTTP/1.1 200 OK"
2025-10-03 18:05:33 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:05:33 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:05:33 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:05:33 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:05:33 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:05:33 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:05:33 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:05:33 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:05:33 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:05:33 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:05:33 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:05:33 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:05:33 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:05:33 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:05:33 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 18:05:33 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:05:33 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 18:05:33 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:05:33 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:05:33 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 18:05:33 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:05:33 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:05:33 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 18:05:33 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 18:05:33 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_1.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_1.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=1)
2025-10-03 18:05:33 - src.models.predict - INFO - âœ“ Loaded model for horizon 1 from local file
2025-10-03 18:05:33 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_2
2025-10-03 18:05:33 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 2: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_2.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_2.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=2)
2025-10-03 18:05:33 - src.models.predict - INFO - âœ“ Loaded model for horizon 2 from local file
2025-10-03 18:05:33 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_3
2025-10-03 18:05:33 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 3: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_3.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_3.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=3)
2025-10-03 18:05:33 - src.models.predict - INFO - âœ“ Loaded model for horizon 3 from local file
2025-10-03 18:05:33 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_4
2025-10-03 18:05:33 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 4: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_4.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_4.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=4)
2025-10-03 18:05:33 - src.models.predict - INFO - âœ“ Loaded model for horizon 4 from local file
2025-10-03 18:05:33 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_5
2025-10-03 18:05:33 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 5: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_5.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_5.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=5)
2025-10-03 18:05:33 - src.models.predict - INFO - âœ“ Loaded model for horizon 5 from local file
2025-10-03 18:05:33 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_6
2025-10-03 18:05:33 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 6: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_6.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_6.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=6)
2025-10-03 18:05:33 - src.models.predict - INFO - âœ“ Loaded model for horizon 6 from local file
2025-10-03 18:05:33 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_7
2025-10-03 18:05:33 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 7: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:05:33 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_7.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_7.pkl
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:05:33 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=7)
2025-10-03 18:05:33 - src.models.predict - INFO - âœ“ Loaded model for horizon 7 from local file
2025-10-03 18:05:33 - src.models.predict - WARNING - Used local file fallback for model loading (running in local/test mode)
2025-10-03 18:05:33 - src.models.predict - INFO - Preparing features for prediction
2025-10-03 18:05:33 - src.models.predict - INFO - Base date for predictions: 2025-10-03
2025-10-03 18:05:33 - src.models.predict - INFO - Prepared features for 7 prediction days
2025-10-03 18:05:33 - src.models.predict - INFO - Total columns in prediction features: 58
2025-10-03 18:05:33 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:05:33 - src.models.predict - INFO - Feature columns selected: 56 features
2025-10-03 18:05:34 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:05:38 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:05:38 - src.models.predict - INFO - Feature columns selected: 56 features
2025-10-03 18:05:44 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:05:44 - src.models.predict - INFO - Feature columns selected: 56 features
2025-10-03 18:05:49 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:05:49 - src.models.predict - INFO - Feature columns selected: 56 features
2025-10-03 18:05:49 - prefect.task_runs - ERROR - Task run failed with exception: LightGBMError('The number of features in data (56) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.') - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 244, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (56) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 18:05:49 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:05:49 - prefect.task_runs - ERROR - Finished in state Failed('Task run encountered an exception LightGBMError: The number of features in data (56) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
2025-10-03 18:05:49 - prefect.flow_runs - ERROR - Prediction flow failed: The number of features in data (56) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 18:05:49 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 18:05:49 - prefect.flow_runs - ERROR - Encountered exception during execution: LightGBMError('The number of features in data (56) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 194, in prediction_flow
    predictions = generate_predictions(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 244, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (56) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 18:05:49 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:05:49 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/21b9093f-b803-41a9-9e17-e0bcca9e40d7/set_state "HTTP/1.1 201 Created"
2025-10-03 18:05:49 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/21b9093f-b803-41a9-9e17-e0bcca9e40d7/set_state "HTTP/1.1 200 OK"
2025-10-03 18:05:50 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:06:49 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/21b9093f-b803-41a9-9e17-e0bcca9e40d7/set_state "HTTP/1.1 201 Created"
2025-10-03 18:06:49 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/21b9093f-b803-41a9-9e17-e0bcca9e40d7 "HTTP/1.1 200 OK"
2025-10-03 18:06:49 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:06:49 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:06:49 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:06:49 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:06:49 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:06:49 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:06:49 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:06:49 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:06:49 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:06:49 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:06:49 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:06:49 - prefect.task_runs - ERROR - Crash detected! Execution was aborted by a termination signal.
2025-10-03 18:06:49 - prefect.task_runs - ERROR - Finished in state Crashed('Execution was aborted by a termination signal.')
2025-10-03 18:06:49 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 18:06:54 - root - INFO - Logging configured successfully
2025-10-03 18:06:54 - root - INFO - Log level: INFO
2025-10-03 18:06:54 - root - INFO - Console logging: enabled
2025-10-03 18:06:54 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 18:06:54 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:06:54 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=270b24f4-7227-42fb-95a4-3620bcf8c34b "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:06:54 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:06:54 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:06:54 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/0eb16e45-efae-4f49-936e-a662fab68890/set_state "HTTP/1.1 201 Created"
2025-10-03 18:06:54 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/0eb16e45-efae-4f49-936e-a662fab68890 "HTTP/1.1 200 OK"
2025-10-03 18:06:54 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:06:54 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 18:06:55 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:06:55 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:06:55 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:06:55 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:06:55 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:06:55 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:06:55 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:06:55 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:06:55 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:06:55 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:06:55 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:06:55 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:06:55 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:06:55 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:06:55 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 18:06:55 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:06:55 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 18:06:55 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:06:55 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:06:55 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 18:06:55 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:06:55 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:06:55 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 18:06:55 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 18:06:56 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 18:06:56 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:06:56 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 18:06:56 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 18:06:56 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:06:56 - src.models.train - INFO - Features: 47
2025-10-03 18:06:56 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:06:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:06:56 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:06:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:06:56 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:06:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:06:56 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:06:56 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:56 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:06:57 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:06:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:06:57 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:06:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:06:57 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:06:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:57 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:06:58 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:06:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:06:58 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:06:58 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:58 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:06:59 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:06:59 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 18:06:59 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:06:59 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:06:59 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:06:59 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:06:59 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 18:06:59 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:06:59 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 18:06:59 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 18:06:59 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 18:06:59 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 18:06:59 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 18:06:59 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:06:59 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 18:06:59 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 18:06:59 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:06:59 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_1
2025-10-03 18:06:59 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:06:59 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:06:59 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 1, stage Staging
2025-10-03 18:06:59 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:06:59 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:06:59 - src.models.model_promotion - INFO - Test MAE: 7.3256, Threshold: 15.0000
2025-10-03 18:06:59 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.3256 < 15.0000)
2025-10-03 18:06:59 - src.models.train - INFO - Starting training for horizon 2 days
2025-10-03 18:06:59 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:06:59 - src.models.train - INFO - Creating shifted target for horizon=2 days
2025-10-03 18:06:59 - src.models.train - INFO - Created target for horizon 2: 1188 samples (2 rows removed due to shifting)
2025-10-03 18:06:59 - src.models.train - INFO - Data split: Train=712 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:06:59 - src.models.train - INFO - Features: 47
2025-10-03 18:06:59 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:06:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:01 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:01 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=22f17824-5952-476d-ba04-2d7922ff09b2 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:07:01 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:07:01 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:01 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:02 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:07:02 - src.models.train - INFO - Best validation MAE: 6.2331
2025-10-03 18:07:02 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 7, 'num_leaves': 20, 'learning_rate': 0.1788532743297921, 'min_child_samples': 30, 'subsample': 0.8500000000000001, 'colsample_bytree': 0.65, 'reg_alpha': 5.2, 'reg_lambda': 5.5, 'min_child_weight': 0.0054880470007660455}
2025-10-03 18:07:02 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=2)
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:02 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:07:02 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:07:02 - src.models.evaluation - INFO - Evaluation: MAE=8.66, RMSE=11.60, Coverage=89.6%, Width=31.71
2025-10-03 18:07:02 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:07:02 - src.models.train - INFO -   MAE: 8.6611
2025-10-03 18:07:02 - src.models.train - INFO -   RMSE: 11.5989
2025-10-03 18:07:02 - src.models.train - INFO -   Coverage: 89.58%
2025-10-03 18:07:02 - src.models.train - INFO -   Interval Width: 31.71
2025-10-03 18:07:02 - src.models.train - INFO - Training complete for horizon 2
2025-10-03 18:07:02 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:07:02 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.2331, test_mae=8.6611, test_rmse=11.5989, test_coverage=0.8958, test_interval_width=31.7143
2025-10-03 18:07:02 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 2: MAE=8.66, RMSE=11.60
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_2.pkl
2025-10-03 18:07:02 - src.models.lightgbm_model - INFO - Model saved successfully (204.9 KB)
2025-10-03 18:07:02 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:07:02 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_2
2025-10-03 18:07:02 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:02 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:02 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 2, stage Staging
2025-10-03 18:07:02 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:07:02 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:07:02 - src.models.model_promotion - INFO - Test MAE: 8.6611, Threshold: 15.0000
2025-10-03 18:07:02 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.6611 < 15.0000)
2025-10-03 18:07:03 - src.models.train - INFO - Starting training for horizon 3 days
2025-10-03 18:07:03 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:07:03 - src.models.train - INFO - Creating shifted target for horizon=3 days
2025-10-03 18:07:03 - src.models.train - INFO - Created target for horizon 3: 1187 samples (3 rows removed due to shifting)
2025-10-03 18:07:03 - src.models.train - INFO - Data split: Train=712 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.1%)
2025-10-03 18:07:03 - src.models.train - INFO - Features: 47
2025-10-03 18:07:03 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:07:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:03 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:07:03 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:03 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:03 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:04 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:04 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:04 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:05 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:05 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:05 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:06 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:07:06 - src.models.train - INFO - Best validation MAE: 6.5140
2025-10-03 18:07:06 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:07:06 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=3)
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:07:06 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:07:06 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:07:06 - src.models.evaluation - INFO - Evaluation: MAE=7.54, RMSE=10.88, Coverage=94.6%, Width=40.68
2025-10-03 18:07:06 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:07:06 - src.models.train - INFO -   MAE: 7.5393
2025-10-03 18:07:06 - src.models.train - INFO -   RMSE: 10.8759
2025-10-03 18:07:06 - src.models.train - INFO -   Coverage: 94.56%
2025-10-03 18:07:06 - src.models.train - INFO -   Interval Width: 40.68
2025-10-03 18:07:06 - src.models.train - INFO - Training complete for horizon 3
2025-10-03 18:07:06 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:07:06 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5140, test_mae=7.5393, test_rmse=10.8759, test_coverage=0.9456, test_interval_width=40.6843
2025-10-03 18:07:06 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 3: MAE=7.54, RMSE=10.88
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_3.pkl
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Model saved successfully (188.8 KB)
2025-10-03 18:07:06 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:07:06 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_3
2025-10-03 18:07:06 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:06 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:06 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 3, stage Staging
2025-10-03 18:07:06 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:07:06 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:07:06 - src.models.model_promotion - INFO - Test MAE: 7.5393, Threshold: 15.0000
2025-10-03 18:07:06 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5393 < 15.0000)
2025-10-03 18:07:06 - src.models.train - INFO - Starting training for horizon 4 days
2025-10-03 18:07:06 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:07:06 - src.models.train - INFO - Creating shifted target for horizon=4 days
2025-10-03 18:07:06 - src.models.train - INFO - Created target for horizon 4: 1186 samples (4 rows removed due to shifting)
2025-10-03 18:07:06 - src.models.train - INFO - Data split: Train=711 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.2%)
2025-10-03 18:07:06 - src.models.train - INFO - Features: 47
2025-10-03 18:07:06 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:07 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:08 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:08 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:08 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:09 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:09 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:09 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:07:09 - src.models.train - INFO - Best validation MAE: 6.6654
2025-10-03 18:07:09 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:07:09 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:07:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:07:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=4)
2025-10-03 18:07:09 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:09 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:07:09 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:07:09 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:07:10 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:07:10 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:07:10 - src.models.evaluation - INFO - Evaluation: MAE=7.57, RMSE=11.08, Coverage=95.4%, Width=38.35
2025-10-03 18:07:10 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:07:10 - src.models.train - INFO -   MAE: 7.5740
2025-10-03 18:07:10 - src.models.train - INFO -   RMSE: 11.0843
2025-10-03 18:07:10 - src.models.train - INFO -   Coverage: 95.40%
2025-10-03 18:07:10 - src.models.train - INFO -   Interval Width: 38.35
2025-10-03 18:07:10 - src.models.train - INFO - Training complete for horizon 4
2025-10-03 18:07:10 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:07:10 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.6654, test_mae=7.5740, test_rmse=11.0843, test_coverage=0.9540, test_interval_width=38.3513
2025-10-03 18:07:10 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 4: MAE=7.57, RMSE=11.08
2025-10-03 18:07:10 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_4.pkl
2025-10-03 18:07:10 - src.models.lightgbm_model - INFO - Model saved successfully (663.3 KB)
2025-10-03 18:07:10 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:07:10 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_4
2025-10-03 18:07:10 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:10 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:10 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 4, stage Staging
2025-10-03 18:07:10 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:07:10 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:07:10 - src.models.model_promotion - INFO - Test MAE: 7.5740, Threshold: 15.0000
2025-10-03 18:07:10 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5740 < 15.0000)
2025-10-03 18:07:10 - src.models.train - INFO - Starting training for horizon 5 days
2025-10-03 18:07:10 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:07:10 - src.models.train - INFO - Creating shifted target for horizon=5 days
2025-10-03 18:07:10 - src.models.train - INFO - Created target for horizon 5: 1185 samples (5 rows removed due to shifting)
2025-10-03 18:07:10 - src.models.train - INFO - Data split: Train=711 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:07:10 - src.models.train - INFO - Features: 47
2025-10-03 18:07:10 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:07:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:10 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:10 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:11 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:11 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:07:11 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:11 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:12 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:12 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:12 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:13 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:13 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:13 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:07:13 - src.models.train - INFO - Best validation MAE: 6.5851
2025-10-03 18:07:13 - src.models.train - INFO - Best parameters: {'n_estimators': 220, 'max_depth': 12, 'num_leaves': 150, 'learning_rate': 0.030405325392865647, 'min_child_samples': 20, 'subsample': 0.55, 'colsample_bytree': 0.5, 'reg_alpha': 8.700000000000001, 'reg_lambda': 6.0, 'min_child_weight': 0.6796578090758157}
2025-10-03 18:07:13 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:07:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:07:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=5)
2025-10-03 18:07:13 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:07:13 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:07:13 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:07:13 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:07:14 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:07:14 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:07:14 - src.models.evaluation - INFO - Evaluation: MAE=8.03, RMSE=11.11, Coverage=95.8%, Width=46.27
2025-10-03 18:07:14 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:07:14 - src.models.train - INFO -   MAE: 8.0314
2025-10-03 18:07:14 - src.models.train - INFO -   RMSE: 11.1115
2025-10-03 18:07:14 - src.models.train - INFO -   Coverage: 95.80%
2025-10-03 18:07:14 - src.models.train - INFO -   Interval Width: 46.27
2025-10-03 18:07:14 - src.models.train - INFO - Training complete for horizon 5
2025-10-03 18:07:14 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:07:14 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5851, test_mae=8.0314, test_rmse=11.1115, test_coverage=0.9580, test_interval_width=46.2685
2025-10-03 18:07:14 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 5: MAE=8.03, RMSE=11.11
2025-10-03 18:07:14 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_5.pkl
2025-10-03 18:07:14 - src.models.lightgbm_model - INFO - Model saved successfully (492.5 KB)
2025-10-03 18:07:14 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:07:14 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_5
2025-10-03 18:07:14 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:14 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:14 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 5, stage Staging
2025-10-03 18:07:14 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:07:14 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:07:14 - src.models.model_promotion - INFO - Test MAE: 8.0314, Threshold: 15.0000
2025-10-03 18:07:14 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.0314 < 15.0000)
2025-10-03 18:07:14 - src.models.train - INFO - Starting training for horizon 6 days
2025-10-03 18:07:14 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:07:14 - src.models.train - INFO - Creating shifted target for horizon=6 days
2025-10-03 18:07:14 - src.models.train - INFO - Created target for horizon 6: 1184 samples (6 rows removed due to shifting)
2025-10-03 18:07:14 - src.models.train - INFO - Data split: Train=710 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:07:14 - src.models.train - INFO - Features: 47
2025-10-03 18:07:14 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:07:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:14 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:07:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:14 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:07:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:15 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:16 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:07:16 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:16 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:16 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:07:16 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:16 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:07:17 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:07:17 - src.models.train - INFO - Best validation MAE: 6.5153
2025-10-03 18:07:17 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:07:17 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=6)
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:07:17 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:07:17 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:07:17 - src.models.evaluation - INFO - Evaluation: MAE=7.51, RMSE=10.84, Coverage=94.1%, Width=42.82
2025-10-03 18:07:17 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:07:17 - src.models.train - INFO -   MAE: 7.5070
2025-10-03 18:07:17 - src.models.train - INFO -   RMSE: 10.8431
2025-10-03 18:07:17 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:07:17 - src.models.train - INFO -   Interval Width: 42.82
2025-10-03 18:07:17 - src.models.train - INFO - Training complete for horizon 6
2025-10-03 18:07:17 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:07:17 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5153, test_mae=7.5070, test_rmse=10.8431, test_coverage=0.9412, test_interval_width=42.8245
2025-10-03 18:07:17 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 6: MAE=7.51, RMSE=10.84
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_6.pkl
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Model saved successfully (187.9 KB)
2025-10-03 18:07:17 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:07:17 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_6
2025-10-03 18:07:17 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:17 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:17 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 6, stage Staging
2025-10-03 18:07:17 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:07:17 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:07:17 - src.models.model_promotion - INFO - Test MAE: 7.5070, Threshold: 15.0000
2025-10-03 18:07:17 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5070 < 15.0000)
2025-10-03 18:07:17 - src.models.train - INFO - Starting training for horizon 7 days
2025-10-03 18:07:17 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:07:17 - src.models.train - INFO - Creating shifted target for horizon=7 days
2025-10-03 18:07:17 - src.models.train - INFO - Created target for horizon 7: 1183 samples (7 rows removed due to shifting)
2025-10-03 18:07:17 - src.models.train - INFO - Data split: Train=709 (59.9%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:07:17 - src.models.train - INFO - Features: 47
2025-10-03 18:07:17 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:19 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:07:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:19 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:07:19 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:07:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:19 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:07:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:20 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:07:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:07:20 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:07:20 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:07:20 - src.models.train - INFO - Best validation MAE: 6.3625
2025-10-03 18:07:20 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:07:20 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:07:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:07:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=7)
2025-10-03 18:07:20 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:07:20 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:07:20 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:07:20 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:07:21 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:07:21 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:07:21 - src.models.evaluation - INFO - Evaluation: MAE=7.62, RMSE=10.94, Coverage=94.1%, Width=38.87
2025-10-03 18:07:21 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:07:21 - src.models.train - INFO -   MAE: 7.6238
2025-10-03 18:07:21 - src.models.train - INFO -   RMSE: 10.9354
2025-10-03 18:07:21 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:07:21 - src.models.train - INFO -   Interval Width: 38.87
2025-10-03 18:07:21 - src.models.train - INFO - Training complete for horizon 7
2025-10-03 18:07:21 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:07:21 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3625, test_mae=7.6238, test_rmse=10.9354, test_coverage=0.9412, test_interval_width=38.8694
2025-10-03 18:07:21 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 7: MAE=7.62, RMSE=10.94
2025-10-03 18:07:21 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_7.pkl
2025-10-03 18:07:21 - src.models.lightgbm_model - INFO - Model saved successfully (640.7 KB)
2025-10-03 18:07:21 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:07:21 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_7
2025-10-03 18:07:21 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:21 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:07:21 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 7, stage Staging
2025-10-03 18:07:21 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Test MAE: 7.6238, Threshold: 15.0000
2025-10-03 18:07:21 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.6238 < 15.0000)
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_1
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_2
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_3
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_4
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_5
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_6
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_7
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:07:21 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:07:21 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/artifacts/ "HTTP/1.1 201 Created"
2025-10-03 18:07:21 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - success
2025-10-03 18:07:21 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:07:21 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/0eb16e45-efae-4f49-936e-a662fab68890/set_state "HTTP/1.1 201 Created"
2025-10-03 18:07:21 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:07:21 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=5fbf529e-1001-4232-b011-f249d9d10685 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:07:21 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:07:21 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:07:21 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/59a2aec7-1b39-4c6c-b67a-5ea90a1a4302/set_state "HTTP/1.1 201 Created"
2025-10-03 18:07:21 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/59a2aec7-1b39-4c6c-b67a-5ea90a1a4302 "HTTP/1.1 200 OK"
2025-10-03 18:07:21 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:07:21 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/aba95944-47d3-4eb7-86a2-fc3b3f1ba70e "HTTP/1.1 200 OK"
2025-10-03 18:07:21 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:07:21 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:07:22 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:07:22 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:07:22 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:07:22 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:07:22 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:07:22 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:07:22 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:07:22 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:07:22 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:07:22 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:07:22 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:07:22 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:07:22 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 18:07:22 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:07:22 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 18:07:22 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:07:22 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:07:22 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 18:07:22 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:07:22 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:07:22 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 18:07:22 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 18:07:22 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_1.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_1.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=1)
2025-10-03 18:07:22 - src.models.predict - INFO - âœ“ Loaded model for horizon 1 from local file
2025-10-03 18:07:22 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_2
2025-10-03 18:07:22 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 2: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_2.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_2.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=2)
2025-10-03 18:07:22 - src.models.predict - INFO - âœ“ Loaded model for horizon 2 from local file
2025-10-03 18:07:22 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_3
2025-10-03 18:07:22 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 3: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_3.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_3.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=3)
2025-10-03 18:07:22 - src.models.predict - INFO - âœ“ Loaded model for horizon 3 from local file
2025-10-03 18:07:22 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_4
2025-10-03 18:07:22 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 4: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_4.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_4.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=4)
2025-10-03 18:07:22 - src.models.predict - INFO - âœ“ Loaded model for horizon 4 from local file
2025-10-03 18:07:22 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_5
2025-10-03 18:07:22 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 5: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_5.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_5.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=5)
2025-10-03 18:07:22 - src.models.predict - INFO - âœ“ Loaded model for horizon 5 from local file
2025-10-03 18:07:22 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_6
2025-10-03 18:07:22 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 6: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_6.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_6.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=6)
2025-10-03 18:07:22 - src.models.predict - INFO - âœ“ Loaded model for horizon 6 from local file
2025-10-03 18:07:22 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_7
2025-10-03 18:07:22 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 7: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:07:22 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_7.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_7.pkl
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:07:22 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=7)
2025-10-03 18:07:22 - src.models.predict - INFO - âœ“ Loaded model for horizon 7 from local file
2025-10-03 18:07:22 - src.models.predict - WARNING - Used local file fallback for model loading (running in local/test mode)
2025-10-03 18:07:22 - src.models.predict - INFO - Preparing features for prediction
2025-10-03 18:07:22 - src.models.predict - INFO - Base date for predictions: 2025-10-03
2025-10-03 18:07:22 - src.models.predict - INFO - Prepared features for 7 prediction days
2025-10-03 18:07:22 - src.models.predict - INFO - Prediction date range: 2025-10-04 to 2025-10-10
2025-10-03 18:07:22 - src.models.predict - INFO - Total columns in prediction features: 58
2025-10-03 18:07:22 - src.models.predict - INFO - All columns: ['Date', 'Patients_per_day', 'Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d', 'day_of_week_sin', 'day_of_week_cos', 'day_of_month_sin', 'day_of_month_cos', 'month_sin', 'month_cos', 'day_of_year_sin', 'day_of_year_cos', 'is_weekend']
2025-10-03 18:07:22 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:07:22 - src.models.predict - INFO - Feature columns selected: 56 features
2025-10-03 18:07:22 - src.models.predict - INFO - All feature columns: ['Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d', 'day_of_week_sin', 'day_of_week_cos', 'day_of_month_sin', 'day_of_month_cos', 'month_sin', 'month_cos', 'day_of_year_sin', 'day_of_year_cos', 'is_weekend']
2025-10-03 18:07:22 - src.models.predict - INFO - Excluded columns present: Date=True, Patients_per_day=True, target=False
2025-10-03 18:07:27 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:07:27 - src.models.predict - INFO - Feature columns selected: 56 features
2025-10-03 18:07:27 - src.models.predict - INFO - All feature columns: ['Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d', 'day_of_week_sin', 'day_of_week_cos', 'day_of_month_sin', 'day_of_month_cos', 'month_sin', 'month_cos', 'day_of_year_sin', 'day_of_year_cos', 'is_weekend']
2025-10-03 18:07:27 - src.models.predict - INFO - Excluded columns present: Date=True, Patients_per_day=True, target=False
2025-10-03 18:07:32 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:07:32 - src.models.predict - INFO - Feature columns selected: 56 features
2025-10-03 18:07:32 - src.models.predict - INFO - All feature columns: ['Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d', 'day_of_week_sin', 'day_of_week_cos', 'day_of_month_sin', 'day_of_month_cos', 'month_sin', 'month_cos', 'day_of_year_sin', 'day_of_year_cos', 'is_weekend']
2025-10-03 18:07:32 - src.models.predict - INFO - Excluded columns present: Date=True, Patients_per_day=True, target=False
2025-10-03 18:07:37 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:07:37 - src.models.predict - INFO - Feature columns selected: 56 features
2025-10-03 18:07:37 - src.models.predict - INFO - All feature columns: ['Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d', 'day_of_week_sin', 'day_of_week_cos', 'day_of_month_sin', 'day_of_month_cos', 'month_sin', 'month_cos', 'day_of_year_sin', 'day_of_year_cos', 'is_weekend']
2025-10-03 18:07:37 - src.models.predict - INFO - Excluded columns present: Date=True, Patients_per_day=True, target=False
2025-10-03 18:07:37 - prefect.task_runs - ERROR - Task run failed with exception: LightGBMError('The number of features in data (56) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.') - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 244, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (56) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 18:07:38 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:07:38 - prefect.task_runs - ERROR - Finished in state Failed('Task run encountered an exception LightGBMError: The number of features in data (56) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
2025-10-03 18:07:38 - prefect.flow_runs - ERROR - Prediction flow failed: The number of features in data (56) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 18:07:38 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 18:07:38 - prefect.flow_runs - ERROR - Encountered exception during execution: LightGBMError('The number of features in data (56) is not the same as it was in training data (47).\nYou can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 194, in prediction_flow
    predictions = generate_predictions(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 244, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1204, in predict
    preds, nrow = self.__pred_for_np2d(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1361, in __pred_for_np2d
    return self.__inner_predict_np2d(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1307, in __inner_predict_np2d
    _safe_call(
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 313, in _safe_call
    raise LightGBMError(_LIB.LGBM_GetLastError().decode("utf-8"))
lightgbm.basic.LightGBMError: The number of features in data (56) is not the same as it was in training data (47).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
2025-10-03 18:07:38 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:07:38 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/59a2aec7-1b39-4c6c-b67a-5ea90a1a4302/set_state "HTTP/1.1 201 Created"
2025-10-03 18:07:38 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/59a2aec7-1b39-4c6c-b67a-5ea90a1a4302/set_state "HTTP/1.1 200 OK"
2025-10-03 18:07:39 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:08:29 - root - INFO - Logging configured successfully
2025-10-03 18:08:29 - root - INFO - Log level: INFO
2025-10-03 18:08:29 - root - INFO - Console logging: enabled
2025-10-03 18:08:29 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 18:08:29 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:08:29 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=76004db5-c929-4163-a3f0-5b4c02423380 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:08:29 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:08:29 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:08:29 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/e07d159d-67ed-41fa-b66d-0c30e0b732b4/set_state "HTTP/1.1 201 Created"
2025-10-03 18:08:29 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/e07d159d-67ed-41fa-b66d-0c30e0b732b4 "HTTP/1.1 200 OK"
2025-10-03 18:08:29 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:08:29 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 18:08:30 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:08:30 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:08:30 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:08:30 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:08:30 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:08:30 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:08:30 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:08:30 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:08:30 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:08:30 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:08:30 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:08:30 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:08:30 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:08:30 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:08:30 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 18:08:30 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:08:30 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 18:08:30 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:08:30 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:08:30 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 18:08:30 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:08:30 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:08:30 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 18:08:30 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 18:08:31 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 18:08:31 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:08:31 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 18:08:31 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 18:08:31 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:08:31 - src.models.train - INFO - Features: 47
2025-10-03 18:08:31 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:08:31 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:31 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:31 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:08:31 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:31 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:31 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:08:31 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:31 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:31 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:08:31 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:31 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:32 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:08:32 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:32 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:32 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:08:32 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:32 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:32 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:08:32 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:32 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:33 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:08:33 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:33 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:33 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:08:33 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:33 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:33 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:08:33 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:33 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:08:34 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:08:34 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 18:08:34 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:08:34 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:08:34 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:08:34 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:08:34 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 18:08:34 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:08:34 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 18:08:34 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 18:08:34 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 18:08:34 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 18:08:34 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 18:08:34 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:08:34 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 18:08:34 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 18:08:34 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:08:34 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_1
2025-10-03 18:08:34 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:34 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:34 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 1, stage Staging
2025-10-03 18:08:34 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:08:34 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:08:34 - src.models.model_promotion - INFO - Test MAE: 7.3256, Threshold: 15.0000
2025-10-03 18:08:34 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.3256 < 15.0000)
2025-10-03 18:08:34 - src.models.train - INFO - Starting training for horizon 2 days
2025-10-03 18:08:34 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:08:34 - src.models.train - INFO - Creating shifted target for horizon=2 days
2025-10-03 18:08:34 - src.models.train - INFO - Created target for horizon 2: 1188 samples (2 rows removed due to shifting)
2025-10-03 18:08:34 - src.models.train - INFO - Data split: Train=712 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:08:34 - src.models.train - INFO - Features: 47
2025-10-03 18:08:34 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:34 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:35 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:36 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:36 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:36 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=f26fe13c-7c37-4428-801c-e07c0c0a076b "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:08:36 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:08:36 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:36 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:36 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:36 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:36 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:37 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:08:37 - src.models.train - INFO - Best validation MAE: 6.2331
2025-10-03 18:08:37 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 7, 'num_leaves': 20, 'learning_rate': 0.1788532743297921, 'min_child_samples': 30, 'subsample': 0.8500000000000001, 'colsample_bytree': 0.65, 'reg_alpha': 5.2, 'reg_lambda': 5.5, 'min_child_weight': 0.0054880470007660455}
2025-10-03 18:08:37 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=2)
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:37 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:08:37 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:08:37 - src.models.evaluation - INFO - Evaluation: MAE=8.66, RMSE=11.60, Coverage=89.6%, Width=31.71
2025-10-03 18:08:37 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:08:37 - src.models.train - INFO -   MAE: 8.6611
2025-10-03 18:08:37 - src.models.train - INFO -   RMSE: 11.5989
2025-10-03 18:08:37 - src.models.train - INFO -   Coverage: 89.58%
2025-10-03 18:08:37 - src.models.train - INFO -   Interval Width: 31.71
2025-10-03 18:08:37 - src.models.train - INFO - Training complete for horizon 2
2025-10-03 18:08:37 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:08:37 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.2331, test_mae=8.6611, test_rmse=11.5989, test_coverage=0.8958, test_interval_width=31.7143
2025-10-03 18:08:37 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 2: MAE=8.66, RMSE=11.60
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_2.pkl
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Model saved successfully (204.9 KB)
2025-10-03 18:08:37 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:08:37 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_2
2025-10-03 18:08:37 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:37 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:37 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 2, stage Staging
2025-10-03 18:08:37 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:08:37 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:08:37 - src.models.model_promotion - INFO - Test MAE: 8.6611, Threshold: 15.0000
2025-10-03 18:08:37 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.6611 < 15.0000)
2025-10-03 18:08:37 - src.models.train - INFO - Starting training for horizon 3 days
2025-10-03 18:08:37 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:08:37 - src.models.train - INFO - Creating shifted target for horizon=3 days
2025-10-03 18:08:37 - src.models.train - INFO - Created target for horizon 3: 1187 samples (3 rows removed due to shifting)
2025-10-03 18:08:37 - src.models.train - INFO - Data split: Train=712 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.1%)
2025-10-03 18:08:37 - src.models.train - INFO - Features: 47
2025-10-03 18:08:37 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:37 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:38 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:38 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:39 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:39 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:39 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:39 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:39 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:40 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:08:40 - src.models.train - INFO - Best validation MAE: 6.5140
2025-10-03 18:08:40 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:08:40 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=3)
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:08:40 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:08:40 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:08:41 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:08:41 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:08:41 - src.models.evaluation - INFO - Evaluation: MAE=7.54, RMSE=10.88, Coverage=94.6%, Width=40.68
2025-10-03 18:08:41 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:08:41 - src.models.train - INFO -   MAE: 7.5393
2025-10-03 18:08:41 - src.models.train - INFO -   RMSE: 10.8759
2025-10-03 18:08:41 - src.models.train - INFO -   Coverage: 94.56%
2025-10-03 18:08:41 - src.models.train - INFO -   Interval Width: 40.68
2025-10-03 18:08:41 - src.models.train - INFO - Training complete for horizon 3
2025-10-03 18:08:41 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:08:41 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5140, test_mae=7.5393, test_rmse=10.8759, test_coverage=0.9456, test_interval_width=40.6843
2025-10-03 18:08:41 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 3: MAE=7.54, RMSE=10.88
2025-10-03 18:08:41 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_3.pkl
2025-10-03 18:08:41 - src.models.lightgbm_model - INFO - Model saved successfully (188.8 KB)
2025-10-03 18:08:41 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:08:41 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_3
2025-10-03 18:08:41 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:41 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:41 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 3, stage Staging
2025-10-03 18:08:41 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:08:41 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:08:41 - src.models.model_promotion - INFO - Test MAE: 7.5393, Threshold: 15.0000
2025-10-03 18:08:41 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5393 < 15.0000)
2025-10-03 18:08:41 - src.models.train - INFO - Starting training for horizon 4 days
2025-10-03 18:08:41 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:08:41 - src.models.train - INFO - Creating shifted target for horizon=4 days
2025-10-03 18:08:41 - src.models.train - INFO - Created target for horizon 4: 1186 samples (4 rows removed due to shifting)
2025-10-03 18:08:41 - src.models.train - INFO - Data split: Train=711 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.2%)
2025-10-03 18:08:41 - src.models.train - INFO - Features: 47
2025-10-03 18:08:41 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:08:41 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:41 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:41 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:41 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:41 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:41 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:41 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:41 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:42 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:42 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:43 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:43 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:43 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:43 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:43 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:44 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:44 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:08:44 - src.models.train - INFO - Best validation MAE: 6.6654
2025-10-03 18:08:44 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:08:44 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:08:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:08:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=4)
2025-10-03 18:08:44 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:44 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:08:44 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:08:44 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:08:44 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:08:44 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:08:44 - src.models.evaluation - INFO - Evaluation: MAE=7.57, RMSE=11.08, Coverage=95.4%, Width=38.35
2025-10-03 18:08:44 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:08:44 - src.models.train - INFO -   MAE: 7.5740
2025-10-03 18:08:44 - src.models.train - INFO -   RMSE: 11.0843
2025-10-03 18:08:44 - src.models.train - INFO -   Coverage: 95.40%
2025-10-03 18:08:44 - src.models.train - INFO -   Interval Width: 38.35
2025-10-03 18:08:44 - src.models.train - INFO - Training complete for horizon 4
2025-10-03 18:08:44 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:08:44 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.6654, test_mae=7.5740, test_rmse=11.0843, test_coverage=0.9540, test_interval_width=38.3513
2025-10-03 18:08:44 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 4: MAE=7.57, RMSE=11.08
2025-10-03 18:08:44 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_4.pkl
2025-10-03 18:08:44 - src.models.lightgbm_model - INFO - Model saved successfully (663.3 KB)
2025-10-03 18:08:44 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:08:44 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_4
2025-10-03 18:08:44 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:44 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:44 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 4, stage Staging
2025-10-03 18:08:44 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:08:44 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:08:44 - src.models.model_promotion - INFO - Test MAE: 7.5740, Threshold: 15.0000
2025-10-03 18:08:44 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5740 < 15.0000)
2025-10-03 18:08:44 - src.models.train - INFO - Starting training for horizon 5 days
2025-10-03 18:08:44 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:08:44 - src.models.train - INFO - Creating shifted target for horizon=5 days
2025-10-03 18:08:44 - src.models.train - INFO - Created target for horizon 5: 1185 samples (5 rows removed due to shifting)
2025-10-03 18:08:44 - src.models.train - INFO - Data split: Train=711 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:08:44 - src.models.train - INFO - Features: 47
2025-10-03 18:08:44 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:08:44 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:44 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:45 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:45 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:45 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:45 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:45 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:46 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:46 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:46 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:08:46 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:46 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:46 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:47 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:47 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:47 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:47 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:48 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:08:48 - src.models.train - INFO - Best validation MAE: 6.5851
2025-10-03 18:08:48 - src.models.train - INFO - Best parameters: {'n_estimators': 220, 'max_depth': 12, 'num_leaves': 150, 'learning_rate': 0.030405325392865647, 'min_child_samples': 20, 'subsample': 0.55, 'colsample_bytree': 0.5, 'reg_alpha': 8.700000000000001, 'reg_lambda': 6.0, 'min_child_weight': 0.6796578090758157}
2025-10-03 18:08:48 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=5)
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:08:48 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:08:48 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:08:48 - src.models.evaluation - INFO - Evaluation: MAE=8.03, RMSE=11.11, Coverage=95.8%, Width=46.27
2025-10-03 18:08:48 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:08:48 - src.models.train - INFO -   MAE: 8.0314
2025-10-03 18:08:48 - src.models.train - INFO -   RMSE: 11.1115
2025-10-03 18:08:48 - src.models.train - INFO -   Coverage: 95.80%
2025-10-03 18:08:48 - src.models.train - INFO -   Interval Width: 46.27
2025-10-03 18:08:48 - src.models.train - INFO - Training complete for horizon 5
2025-10-03 18:08:48 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:08:48 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5851, test_mae=8.0314, test_rmse=11.1115, test_coverage=0.9580, test_interval_width=46.2685
2025-10-03 18:08:48 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 5: MAE=8.03, RMSE=11.11
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_5.pkl
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Model saved successfully (492.5 KB)
2025-10-03 18:08:48 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:08:48 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_5
2025-10-03 18:08:48 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:48 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:48 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 5, stage Staging
2025-10-03 18:08:48 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:08:48 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:08:48 - src.models.model_promotion - INFO - Test MAE: 8.0314, Threshold: 15.0000
2025-10-03 18:08:48 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.0314 < 15.0000)
2025-10-03 18:08:48 - src.models.train - INFO - Starting training for horizon 6 days
2025-10-03 18:08:48 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:08:48 - src.models.train - INFO - Creating shifted target for horizon=6 days
2025-10-03 18:08:48 - src.models.train - INFO - Created target for horizon 6: 1184 samples (6 rows removed due to shifting)
2025-10-03 18:08:48 - src.models.train - INFO - Data split: Train=710 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:08:48 - src.models.train - INFO - Features: 47
2025-10-03 18:08:48 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:48 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:49 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:50 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:08:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:50 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:08:50 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:08:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:50 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:08:50 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:50 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:08:51 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:08:51 - src.models.train - INFO - Best validation MAE: 6.5153
2025-10-03 18:08:51 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:08:51 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=6)
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:08:51 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:08:51 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:08:52 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:08:52 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:08:52 - src.models.evaluation - INFO - Evaluation: MAE=7.51, RMSE=10.84, Coverage=94.1%, Width=42.82
2025-10-03 18:08:52 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:08:52 - src.models.train - INFO -   MAE: 7.5070
2025-10-03 18:08:52 - src.models.train - INFO -   RMSE: 10.8431
2025-10-03 18:08:52 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:08:52 - src.models.train - INFO -   Interval Width: 42.82
2025-10-03 18:08:52 - src.models.train - INFO - Training complete for horizon 6
2025-10-03 18:08:52 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:08:52 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5153, test_mae=7.5070, test_rmse=10.8431, test_coverage=0.9412, test_interval_width=42.8245
2025-10-03 18:08:52 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 6: MAE=7.51, RMSE=10.84
2025-10-03 18:08:52 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_6.pkl
2025-10-03 18:08:52 - src.models.lightgbm_model - INFO - Model saved successfully (187.9 KB)
2025-10-03 18:08:52 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:08:52 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_6
2025-10-03 18:08:52 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:52 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:52 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 6, stage Staging
2025-10-03 18:08:52 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:08:52 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:08:52 - src.models.model_promotion - INFO - Test MAE: 7.5070, Threshold: 15.0000
2025-10-03 18:08:52 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5070 < 15.0000)
2025-10-03 18:08:52 - src.models.train - INFO - Starting training for horizon 7 days
2025-10-03 18:08:52 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:08:52 - src.models.train - INFO - Creating shifted target for horizon=7 days
2025-10-03 18:08:52 - src.models.train - INFO - Created target for horizon 7: 1183 samples (7 rows removed due to shifting)
2025-10-03 18:08:52 - src.models.train - INFO - Data split: Train=709 (59.9%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:08:52 - src.models.train - INFO - Features: 47
2025-10-03 18:08:52 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:08:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:52 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:08:52 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:08:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:52 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:08:52 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:52 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:53 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:08:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:53 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:08:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:53 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:08:53 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:53 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:54 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:08:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:54 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:08:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:54 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:08:54 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:54 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:55 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:08:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:08:55 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:08:55 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:08:55 - src.models.train - INFO - Best validation MAE: 6.3625
2025-10-03 18:08:55 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:08:55 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:08:55 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:08:55 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=7)
2025-10-03 18:08:55 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:08:55 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:08:55 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:08:55 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:08:56 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:08:56 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:08:56 - src.models.evaluation - INFO - Evaluation: MAE=7.62, RMSE=10.94, Coverage=94.1%, Width=38.87
2025-10-03 18:08:56 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:08:56 - src.models.train - INFO -   MAE: 7.6238
2025-10-03 18:08:56 - src.models.train - INFO -   RMSE: 10.9354
2025-10-03 18:08:56 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:08:56 - src.models.train - INFO -   Interval Width: 38.87
2025-10-03 18:08:56 - src.models.train - INFO - Training complete for horizon 7
2025-10-03 18:08:56 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:08:56 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3625, test_mae=7.6238, test_rmse=10.9354, test_coverage=0.9412, test_interval_width=38.8694
2025-10-03 18:08:56 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 7: MAE=7.62, RMSE=10.94
2025-10-03 18:08:56 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_7.pkl
2025-10-03 18:08:56 - src.models.lightgbm_model - INFO - Model saved successfully (640.7 KB)
2025-10-03 18:08:56 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:08:56 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_7
2025-10-03 18:08:56 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:56 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:08:56 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 7, stage Staging
2025-10-03 18:08:56 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Test MAE: 7.6238, Threshold: 15.0000
2025-10-03 18:08:56 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.6238 < 15.0000)
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_1
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_2
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_3
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_4
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_5
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_6
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_7
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:08:56 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:08:56 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/artifacts/ "HTTP/1.1 201 Created"
2025-10-03 18:08:56 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - success
2025-10-03 18:08:56 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/e07d159d-67ed-41fa-b66d-0c30e0b732b4/set_state "HTTP/1.1 201 Created"
2025-10-03 18:08:56 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:08:56 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=d90932c0-a65f-456b-b533-7aaf59809203 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:08:56 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:08:56 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:08:56 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/7af0842c-f97d-4917-94d3-bb234ce7c8b6/set_state "HTTP/1.1 201 Created"
2025-10-03 18:08:56 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/7af0842c-f97d-4917-94d3-bb234ce7c8b6 "HTTP/1.1 200 OK"
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:08:56 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/aba95944-47d3-4eb7-86a2-fc3b3f1ba70e "HTTP/1.1 200 OK"
2025-10-03 18:08:56 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:08:56 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:08:56 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:08:56 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:08:56 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:08:56 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 18:08:56 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:08:57 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 18:08:57 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:08:57 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:08:57 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 18:08:57 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:08:57 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:08:57 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 18:08:57 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 18:08:57 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_1.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_1.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=1)
2025-10-03 18:08:57 - src.models.predict - INFO - âœ“ Loaded model for horizon 1 from local file
2025-10-03 18:08:57 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_2
2025-10-03 18:08:57 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 2: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_2.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_2.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=2)
2025-10-03 18:08:57 - src.models.predict - INFO - âœ“ Loaded model for horizon 2 from local file
2025-10-03 18:08:57 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_3
2025-10-03 18:08:57 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 3: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_3.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_3.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=3)
2025-10-03 18:08:57 - src.models.predict - INFO - âœ“ Loaded model for horizon 3 from local file
2025-10-03 18:08:57 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_4
2025-10-03 18:08:57 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 4: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_4.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_4.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=4)
2025-10-03 18:08:57 - src.models.predict - INFO - âœ“ Loaded model for horizon 4 from local file
2025-10-03 18:08:57 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_5
2025-10-03 18:08:57 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 5: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_5.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_5.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=5)
2025-10-03 18:08:57 - src.models.predict - INFO - âœ“ Loaded model for horizon 5 from local file
2025-10-03 18:08:57 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_6
2025-10-03 18:08:57 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 6: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_6.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_6.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=6)
2025-10-03 18:08:57 - src.models.predict - INFO - âœ“ Loaded model for horizon 6 from local file
2025-10-03 18:08:57 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_7
2025-10-03 18:08:57 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 7: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:08:57 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_7.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_7.pkl
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:08:57 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=7)
2025-10-03 18:08:57 - src.models.predict - INFO - âœ“ Loaded model for horizon 7 from local file
2025-10-03 18:08:57 - src.models.predict - WARNING - Used local file fallback for model loading (running in local/test mode)
2025-10-03 18:08:57 - src.models.predict - INFO - Preparing features for prediction
2025-10-03 18:08:57 - src.models.predict - INFO - Base date for predictions: 2025-10-03
2025-10-03 18:08:57 - src.models.predict - INFO - Prepared features for 7 prediction days
2025-10-03 18:08:57 - src.models.predict - INFO - Prediction date range: 2025-10-04 to 2025-10-10
2025-10-03 18:08:57 - src.models.predict - INFO - Total columns in prediction features: 49
2025-10-03 18:08:57 - src.models.predict - INFO - All columns: ['Date', 'Patients_per_day', 'Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d']
2025-10-03 18:08:57 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:08:57 - src.models.predict - INFO - Feature columns selected: 47 features
2025-10-03 18:08:57 - src.models.predict - INFO - All feature columns: ['Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d']
2025-10-03 18:08:57 - src.models.predict - INFO - Excluded columns present: Date=True, Patients_per_day=True, target=False
2025-10-03 18:09:02 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:09:02 - src.models.predict - INFO - Feature columns selected: 47 features
2025-10-03 18:09:02 - src.models.predict - INFO - All feature columns: ['Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d']
2025-10-03 18:09:02 - src.models.predict - INFO - Excluded columns present: Date=True, Patients_per_day=True, target=False
2025-10-03 18:09:07 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:09:07 - src.models.predict - INFO - Feature columns selected: 47 features
2025-10-03 18:09:07 - src.models.predict - INFO - All feature columns: ['Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d']
2025-10-03 18:09:07 - src.models.predict - INFO - Excluded columns present: Date=True, Patients_per_day=True, target=False
2025-10-03 18:09:12 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:09:12 - src.models.predict - INFO - Feature columns selected: 47 features
2025-10-03 18:09:12 - src.models.predict - INFO - All feature columns: ['Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d']
2025-10-03 18:09:12 - src.models.predict - INFO - Excluded columns present: Date=True, Patients_per_day=True, target=False
2025-10-03 18:09:12 - prefect.task_runs - ERROR - Task run failed with exception: ValueError('pandas dtypes must be int, float or bool.\nFields with bad pandas dtypes: Day_of_week_1: object, Day_of_week_2: object, Day_of_week_3: object, Day_of_week_4: object, Day_of_week_5: object, Day_of_week_6: object') - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 249, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1158, in predict
    data = _data_from_pandas(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 868, in _data_from_pandas
    _pandas_to_numpy(data, target_dtype=target_dtype),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 814, in _pandas_to_numpy
    _check_for_bad_pandas_dtypes(data.dtypes)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 805, in _check_for_bad_pandas_dtypes
    raise ValueError(
ValueError: pandas dtypes must be int, float or bool.
Fields with bad pandas dtypes: Day_of_week_1: object, Day_of_week_2: object, Day_of_week_3: object, Day_of_week_4: object, Day_of_week_5: object, Day_of_week_6: object
2025-10-03 18:09:12 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:09:12 - prefect.task_runs - ERROR - Finished in state Failed('Task run encountered an exception ValueError: pandas dtypes must be int, float or bool.\nFields with bad pandas dtypes: Day_of_week_1: object, Day_of_week_2: object, Day_of_week_3: object, Day_of_week_4: object, Day_of_week_5: object, Day_of_week_6: object')
2025-10-03 18:09:12 - prefect.flow_runs - ERROR - Prediction flow failed: pandas dtypes must be int, float or bool.
Fields with bad pandas dtypes: Day_of_week_1: object, Day_of_week_2: object, Day_of_week_3: object, Day_of_week_4: object, Day_of_week_5: object, Day_of_week_6: object
2025-10-03 18:09:12 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 18:09:12 - prefect.flow_runs - ERROR - Encountered exception during execution: ValueError('pandas dtypes must be int, float or bool.\nFields with bad pandas dtypes: Day_of_week_1: object, Day_of_week_2: object, Day_of_week_3: object, Day_of_week_4: object, Day_of_week_5: object, Day_of_week_6: object')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 194, in prediction_flow
    predictions = generate_predictions(
                  ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/predict.py", line 249, in generate_predictions
    pred = model.predict(X, return_intervals=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/lightgbm_model.py", line 186, in predict
    point_preds = self.point_model.predict(X)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/sklearn.py", line 1144, in predict
    return self._Booster.predict(  # type: ignore[union-attr]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 4767, in predict
    return predictor.predict(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 1158, in predict
    data = _data_from_pandas(
           ^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 868, in _data_from_pandas
    _pandas_to_numpy(data, target_dtype=target_dtype),
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 814, in _pandas_to_numpy
    _check_for_bad_pandas_dtypes(data.dtypes)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/lightgbm/basic.py", line 805, in _check_for_bad_pandas_dtypes
    raise ValueError(
ValueError: pandas dtypes must be int, float or bool.
Fields with bad pandas dtypes: Day_of_week_1: object, Day_of_week_2: object, Day_of_week_3: object, Day_of_week_4: object, Day_of_week_5: object, Day_of_week_6: object
2025-10-03 18:09:12 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:09:12 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/7af0842c-f97d-4917-94d3-bb234ce7c8b6/set_state "HTTP/1.1 201 Created"
2025-10-03 18:09:12 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/7af0842c-f97d-4917-94d3-bb234ce7c8b6/set_state "HTTP/1.1 200 OK"
2025-10-03 18:09:14 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:09:53 - prefect.flow_runs - ERROR - Crash detected! Execution was aborted by a termination signal.
2025-10-03 18:09:53 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/7af0842c-f97d-4917-94d3-bb234ce7c8b6/set_state "HTTP/1.1 201 Created"
2025-10-03 18:09:53 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:09:58 - root - INFO - Logging configured successfully
2025-10-03 18:09:58 - root - INFO - Log level: INFO
2025-10-03 18:09:58 - root - INFO - Console logging: enabled
2025-10-03 18:09:58 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 18:09:58 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:09:58 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=460a58c0-44e0-468d-99bd-aef79520f20f "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:09:58 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:09:58 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:09:58 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/69affa35-96e7-4c3f-a06e-0e02012cc799/set_state "HTTP/1.1 201 Created"
2025-10-03 18:09:58 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/69affa35-96e7-4c3f-a06e-0e02012cc799 "HTTP/1.1 200 OK"
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:09:58 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:09:58 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:09:58 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:09:58 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:09:58 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:09:58 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 18:09:58 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:09:59 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 18:09:59 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:09:59 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:09:59 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 18:09:59 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:09:59 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:09:59 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 18:09:59 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 18:09:59 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 18:09:59 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:09:59 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 18:09:59 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 18:09:59 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:09:59 - src.models.train - INFO - Features: 47
2025-10-03 18:09:59 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:09:59 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:09:59 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:00 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:01 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:10:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:01 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:10:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:01 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:10:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:10:02 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:10:02 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 18:10:02 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:10:02 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:10:02 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:10:02 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:10:02 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:10:02 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 18:10:02 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:10:02 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 18:10:02 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 18:10:02 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 18:10:02 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 18:10:02 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 18:10:02 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:10:03 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 18:10:03 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 18:10:03 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 18:10:03 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 18:10:03 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:03 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_1
2025-10-03 18:10:03 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:03 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:03 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 1, stage Staging
2025-10-03 18:10:03 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:10:03 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:10:03 - src.models.model_promotion - INFO - Test MAE: 7.3256, Threshold: 15.0000
2025-10-03 18:10:03 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.3256 < 15.0000)
2025-10-03 18:10:03 - src.models.train - INFO - Starting training for horizon 2 days
2025-10-03 18:10:03 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:10:03 - src.models.train - INFO - Creating shifted target for horizon=2 days
2025-10-03 18:10:03 - src.models.train - INFO - Created target for horizon 2: 1188 samples (2 rows removed due to shifting)
2025-10-03 18:10:03 - src.models.train - INFO - Data split: Train=712 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:10:03 - src.models.train - INFO - Features: 47
2025-10-03 18:10:03 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:10:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:03 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:03 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:05 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=f0aff919-17bf-48d7-8329-79dd08818d48 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:10:05 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:10:05 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:05 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:06 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:10:06 - src.models.train - INFO - Best validation MAE: 6.2331
2025-10-03 18:10:06 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 7, 'num_leaves': 20, 'learning_rate': 0.1788532743297921, 'min_child_samples': 30, 'subsample': 0.8500000000000001, 'colsample_bytree': 0.65, 'reg_alpha': 5.2, 'reg_lambda': 5.5, 'min_child_weight': 0.0054880470007660455}
2025-10-03 18:10:06 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=2)
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:06 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:10:06 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:10:06 - src.models.evaluation - INFO - Evaluation: MAE=8.66, RMSE=11.60, Coverage=89.6%, Width=31.71
2025-10-03 18:10:06 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:10:06 - src.models.train - INFO -   MAE: 8.6611
2025-10-03 18:10:06 - src.models.train - INFO -   RMSE: 11.5989
2025-10-03 18:10:06 - src.models.train - INFO -   Coverage: 89.58%
2025-10-03 18:10:06 - src.models.train - INFO -   Interval Width: 31.71
2025-10-03 18:10:06 - src.models.train - INFO - Training complete for horizon 2
2025-10-03 18:10:06 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:10:06 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.2331, test_mae=8.6611, test_rmse=11.5989, test_coverage=0.8958, test_interval_width=31.7143
2025-10-03 18:10:06 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 2: MAE=8.66, RMSE=11.60
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_2.pkl
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Model saved successfully (204.9 KB)
2025-10-03 18:10:06 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:06 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_2
2025-10-03 18:10:06 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:06 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:06 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 2, stage Staging
2025-10-03 18:10:06 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:10:06 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:10:06 - src.models.model_promotion - INFO - Test MAE: 8.6611, Threshold: 15.0000
2025-10-03 18:10:06 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.6611 < 15.0000)
2025-10-03 18:10:06 - src.models.train - INFO - Starting training for horizon 3 days
2025-10-03 18:10:06 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:10:06 - src.models.train - INFO - Creating shifted target for horizon=3 days
2025-10-03 18:10:06 - src.models.train - INFO - Created target for horizon 3: 1187 samples (3 rows removed due to shifting)
2025-10-03 18:10:06 - src.models.train - INFO - Data split: Train=712 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.1%)
2025-10-03 18:10:06 - src.models.train - INFO - Features: 47
2025-10-03 18:10:06 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:07 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:08 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:08 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:09 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:10:09 - src.models.train - INFO - Best validation MAE: 6.5140
2025-10-03 18:10:09 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:10:09 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=3)
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:10:09 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:10:09 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:10:09 - src.models.evaluation - INFO - Evaluation: MAE=7.54, RMSE=10.88, Coverage=94.6%, Width=40.68
2025-10-03 18:10:09 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:10:09 - src.models.train - INFO -   MAE: 7.5393
2025-10-03 18:10:09 - src.models.train - INFO -   RMSE: 10.8759
2025-10-03 18:10:09 - src.models.train - INFO -   Coverage: 94.56%
2025-10-03 18:10:09 - src.models.train - INFO -   Interval Width: 40.68
2025-10-03 18:10:09 - src.models.train - INFO - Training complete for horizon 3
2025-10-03 18:10:09 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:10:09 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5140, test_mae=7.5393, test_rmse=10.8759, test_coverage=0.9456, test_interval_width=40.6843
2025-10-03 18:10:09 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 3: MAE=7.54, RMSE=10.88
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_3.pkl
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Model saved successfully (188.8 KB)
2025-10-03 18:10:09 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:09 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_3
2025-10-03 18:10:09 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:09 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:09 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 3, stage Staging
2025-10-03 18:10:09 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:10:09 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:10:09 - src.models.model_promotion - INFO - Test MAE: 7.5393, Threshold: 15.0000
2025-10-03 18:10:09 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5393 < 15.0000)
2025-10-03 18:10:09 - src.models.train - INFO - Starting training for horizon 4 days
2025-10-03 18:10:09 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:10:09 - src.models.train - INFO - Creating shifted target for horizon=4 days
2025-10-03 18:10:09 - src.models.train - INFO - Created target for horizon 4: 1186 samples (4 rows removed due to shifting)
2025-10-03 18:10:09 - src.models.train - INFO - Data split: Train=711 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.2%)
2025-10-03 18:10:09 - src.models.train - INFO - Features: 47
2025-10-03 18:10:09 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:10 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:10 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:10 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:11 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:10:11 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:11 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:11 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:12 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:12 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:12 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:13 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:13 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:10:13 - src.models.train - INFO - Best validation MAE: 6.6654
2025-10-03 18:10:13 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:10:13 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:10:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:10:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=4)
2025-10-03 18:10:13 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:13 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:10:13 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:10:13 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:10:13 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:10:13 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:10:13 - src.models.evaluation - INFO - Evaluation: MAE=7.57, RMSE=11.08, Coverage=95.4%, Width=38.35
2025-10-03 18:10:13 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:10:13 - src.models.train - INFO -   MAE: 7.5740
2025-10-03 18:10:13 - src.models.train - INFO -   RMSE: 11.0843
2025-10-03 18:10:13 - src.models.train - INFO -   Coverage: 95.40%
2025-10-03 18:10:13 - src.models.train - INFO -   Interval Width: 38.35
2025-10-03 18:10:13 - src.models.train - INFO - Training complete for horizon 4
2025-10-03 18:10:13 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:10:13 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.6654, test_mae=7.5740, test_rmse=11.0843, test_coverage=0.9540, test_interval_width=38.3513
2025-10-03 18:10:13 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 4: MAE=7.57, RMSE=11.08
2025-10-03 18:10:13 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_4.pkl
2025-10-03 18:10:13 - src.models.lightgbm_model - INFO - Model saved successfully (663.3 KB)
2025-10-03 18:10:13 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:13 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_4
2025-10-03 18:10:13 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:13 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:13 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 4, stage Staging
2025-10-03 18:10:13 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:10:13 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:10:13 - src.models.model_promotion - INFO - Test MAE: 7.5740, Threshold: 15.0000
2025-10-03 18:10:13 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5740 < 15.0000)
2025-10-03 18:10:13 - src.models.train - INFO - Starting training for horizon 5 days
2025-10-03 18:10:13 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:10:13 - src.models.train - INFO - Creating shifted target for horizon=5 days
2025-10-03 18:10:13 - src.models.train - INFO - Created target for horizon 5: 1185 samples (5 rows removed due to shifting)
2025-10-03 18:10:13 - src.models.train - INFO - Data split: Train=711 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:10:13 - src.models.train - INFO - Features: 47
2025-10-03 18:10:13 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:10:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:14 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:14 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:14 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:15 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:10:15 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:15 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:15 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:16 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:16 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:16 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:16 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:16 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:16 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:17 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:10:17 - src.models.train - INFO - Best validation MAE: 6.5851
2025-10-03 18:10:17 - src.models.train - INFO - Best parameters: {'n_estimators': 220, 'max_depth': 12, 'num_leaves': 150, 'learning_rate': 0.030405325392865647, 'min_child_samples': 20, 'subsample': 0.55, 'colsample_bytree': 0.5, 'reg_alpha': 8.700000000000001, 'reg_lambda': 6.0, 'min_child_weight': 0.6796578090758157}
2025-10-03 18:10:17 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=5)
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:10:17 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:10:17 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:10:17 - src.models.evaluation - INFO - Evaluation: MAE=8.03, RMSE=11.11, Coverage=95.8%, Width=46.27
2025-10-03 18:10:17 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:10:17 - src.models.train - INFO -   MAE: 8.0314
2025-10-03 18:10:17 - src.models.train - INFO -   RMSE: 11.1115
2025-10-03 18:10:17 - src.models.train - INFO -   Coverage: 95.80%
2025-10-03 18:10:17 - src.models.train - INFO -   Interval Width: 46.27
2025-10-03 18:10:17 - src.models.train - INFO - Training complete for horizon 5
2025-10-03 18:10:17 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:10:17 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5851, test_mae=8.0314, test_rmse=11.1115, test_coverage=0.9580, test_interval_width=46.2685
2025-10-03 18:10:17 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 5: MAE=8.03, RMSE=11.11
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_5.pkl
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Model saved successfully (492.5 KB)
2025-10-03 18:10:17 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:17 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_5
2025-10-03 18:10:17 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:17 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:17 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 5, stage Staging
2025-10-03 18:10:17 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:10:17 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:10:17 - src.models.model_promotion - INFO - Test MAE: 8.0314, Threshold: 15.0000
2025-10-03 18:10:17 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.0314 < 15.0000)
2025-10-03 18:10:17 - src.models.train - INFO - Starting training for horizon 6 days
2025-10-03 18:10:17 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:10:17 - src.models.train - INFO - Creating shifted target for horizon=6 days
2025-10-03 18:10:17 - src.models.train - INFO - Created target for horizon 6: 1184 samples (6 rows removed due to shifting)
2025-10-03 18:10:17 - src.models.train - INFO - Data split: Train=710 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:10:17 - src.models.train - INFO - Features: 47
2025-10-03 18:10:17 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:19 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:10:19 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:10:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:19 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:10:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:19 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:10:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:10:20 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:10:20 - src.models.train - INFO - Best validation MAE: 6.5153
2025-10-03 18:10:20 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:10:20 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=6)
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:10:20 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:10:20 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:10:21 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:10:21 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:10:21 - src.models.evaluation - INFO - Evaluation: MAE=7.51, RMSE=10.84, Coverage=94.1%, Width=42.82
2025-10-03 18:10:21 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:10:21 - src.models.train - INFO -   MAE: 7.5070
2025-10-03 18:10:21 - src.models.train - INFO -   RMSE: 10.8431
2025-10-03 18:10:21 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:10:21 - src.models.train - INFO -   Interval Width: 42.82
2025-10-03 18:10:21 - src.models.train - INFO - Training complete for horizon 6
2025-10-03 18:10:21 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:10:21 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5153, test_mae=7.5070, test_rmse=10.8431, test_coverage=0.9412, test_interval_width=42.8245
2025-10-03 18:10:21 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 6: MAE=7.51, RMSE=10.84
2025-10-03 18:10:21 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_6.pkl
2025-10-03 18:10:21 - src.models.lightgbm_model - INFO - Model saved successfully (187.9 KB)
2025-10-03 18:10:21 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:21 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_6
2025-10-03 18:10:21 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:21 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:21 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 6, stage Staging
2025-10-03 18:10:21 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:10:21 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:10:21 - src.models.model_promotion - INFO - Test MAE: 7.5070, Threshold: 15.0000
2025-10-03 18:10:21 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5070 < 15.0000)
2025-10-03 18:10:21 - src.models.train - INFO - Starting training for horizon 7 days
2025-10-03 18:10:21 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:10:21 - src.models.train - INFO - Creating shifted target for horizon=7 days
2025-10-03 18:10:21 - src.models.train - INFO - Created target for horizon 7: 1183 samples (7 rows removed due to shifting)
2025-10-03 18:10:21 - src.models.train - INFO - Data split: Train=709 (59.9%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:10:21 - src.models.train - INFO - Features: 47
2025-10-03 18:10:21 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:10:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:21 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:10:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:21 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:10:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:23 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:10:23 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:10:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:23 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:10:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:10:24 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:10:24 - src.models.train - INFO - Best validation MAE: 6.3625
2025-10-03 18:10:24 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:10:24 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=7)
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:10:24 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:10:24 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:10:24 - src.models.evaluation - INFO - Evaluation: MAE=7.62, RMSE=10.94, Coverage=94.1%, Width=38.87
2025-10-03 18:10:24 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:10:24 - src.models.train - INFO -   MAE: 7.6238
2025-10-03 18:10:24 - src.models.train - INFO -   RMSE: 10.9354
2025-10-03 18:10:24 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:10:24 - src.models.train - INFO -   Interval Width: 38.87
2025-10-03 18:10:24 - src.models.train - INFO - Training complete for horizon 7
2025-10-03 18:10:24 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:10:24 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3625, test_mae=7.6238, test_rmse=10.9354, test_coverage=0.9412, test_interval_width=38.8694
2025-10-03 18:10:24 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 7: MAE=7.62, RMSE=10.94
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_7.pkl
2025-10-03 18:10:24 - src.models.lightgbm_model - INFO - Model saved successfully (640.7 KB)
2025-10-03 18:10:24 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:24 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_7
2025-10-03 18:10:24 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:24 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:10:24 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 7, stage Staging
2025-10-03 18:10:24 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Test MAE: 7.6238, Threshold: 15.0000
2025-10-03 18:10:24 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.6238 < 15.0000)
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_1
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_2
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_3
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_4
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_5
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_6
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:10:24 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_7
2025-10-03 18:10:24 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:10:25 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:10:25 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:10:25 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/artifacts/ "HTTP/1.1 201 Created"
2025-10-03 18:10:25 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - success
2025-10-03 18:10:25 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/69affa35-96e7-4c3f-a06e-0e02012cc799/set_state "HTTP/1.1 201 Created"
2025-10-03 18:10:25 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:10:25 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=a6ee1740-d25a-4aaa-995d-54b9268284e4 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:10:25 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:10:25 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:10:25 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/35c87e5e-3a28-4cd7-8110-2f9fcc1b5606/set_state "HTTP/1.1 201 Created"
2025-10-03 18:10:25 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/35c87e5e-3a28-4cd7-8110-2f9fcc1b5606 "HTTP/1.1 200 OK"
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:10:25 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/aba95944-47d3-4eb7-86a2-fc3b3f1ba70e "HTTP/1.1 200 OK"
2025-10-03 18:10:25 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:10:25 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:10:25 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:10:25 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:10:25 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:10:25 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 18:10:25 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:10:25 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 18:10:25 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:10:25 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:10:25 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 18:10:25 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:10:25 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:10:25 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:10:25 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:10:25 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:10:25 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:10:25 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:10:25 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:10:25 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:10:25 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:10:25 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:10:25 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:10:26 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:10:26 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:10:26 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:10:26 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:10:26 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:10:26 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:10:26 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:10:26 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:10:26 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:10:26 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 18:10:26 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 18:10:26 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_1.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_1.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=1)
2025-10-03 18:10:26 - src.models.predict - INFO - âœ“ Loaded model for horizon 1 from local file
2025-10-03 18:10:26 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_2
2025-10-03 18:10:26 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 2: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_2.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_2.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=2)
2025-10-03 18:10:26 - src.models.predict - INFO - âœ“ Loaded model for horizon 2 from local file
2025-10-03 18:10:26 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_3
2025-10-03 18:10:26 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 3: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_3.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_3.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=3)
2025-10-03 18:10:26 - src.models.predict - INFO - âœ“ Loaded model for horizon 3 from local file
2025-10-03 18:10:26 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_4
2025-10-03 18:10:26 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 4: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_4.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_4.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=4)
2025-10-03 18:10:26 - src.models.predict - INFO - âœ“ Loaded model for horizon 4 from local file
2025-10-03 18:10:26 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_5
2025-10-03 18:10:26 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 5: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_5.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_5.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=5)
2025-10-03 18:10:26 - src.models.predict - INFO - âœ“ Loaded model for horizon 5 from local file
2025-10-03 18:10:26 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_6
2025-10-03 18:10:26 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 6: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_6.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_6.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=6)
2025-10-03 18:10:26 - src.models.predict - INFO - âœ“ Loaded model for horizon 6 from local file
2025-10-03 18:10:26 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_7
2025-10-03 18:10:26 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 7: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:10:26 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_7.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_7.pkl
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:10:26 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=7)
2025-10-03 18:10:26 - src.models.predict - INFO - âœ“ Loaded model for horizon 7 from local file
2025-10-03 18:10:26 - src.models.predict - WARNING - Used local file fallback for model loading (running in local/test mode)
2025-10-03 18:10:26 - src.models.predict - INFO - Preparing features for prediction
2025-10-03 18:10:26 - src.models.predict - INFO - Base date for predictions: 2025-10-03
2025-10-03 18:10:26 - src.models.predict - INFO - Prepared features for 7 prediction days
2025-10-03 18:10:26 - src.models.predict - INFO - Prediction date range: 2025-10-04 to 2025-10-10
2025-10-03 18:10:26 - src.models.predict - INFO - Total columns in prediction features: 49
2025-10-03 18:10:26 - src.models.predict - INFO - All columns: ['Date', 'Patients_per_day', 'Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d']
2025-10-03 18:10:26 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:10:26 - src.models.predict - INFO - Feature columns selected: 47 features
2025-10-03 18:10:26 - src.models.predict - INFO - All feature columns: ['Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d']
2025-10-03 18:10:26 - src.models.predict - INFO - Excluded columns present: Date=True, Patients_per_day=True, target=False
2025-10-03 18:10:26 - src.models.predict - INFO - Generated 7 predictions
2025-10-03 18:10:26 - src.models.predict - INFO - Prediction range: 52.0 to 71.0 patients
2025-10-03 18:10:26 - src.monitoring.metrics_collector - INFO - Recorded prediction metrics: 7 predictions in 0.09s
2025-10-03 18:10:26 - src.models.prediction_output - INFO - Saving predictions to CSV
2025-10-03 18:10:26 - src.models.prediction_output - INFO - Predictions saved to: data/predictions/predictions_20251003_181026.csv
2025-10-03 18:10:26 - src.models.prediction_output - INFO - File size: 0.8 KB, Rows: 7
2025-10-03 18:10:26 - src.models.prediction_output - INFO - Logging prediction metadata to MLflow
2025-10-03 18:10:26 - src.models.prediction_output - ERROR - Failed to log prediction metadata to MLflow: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:26 - src.models.prediction_output - INFO - Logging prediction metadata to MLflow
2025-10-03 18:10:26 - src.models.prediction_output - ERROR - Failed to log prediction metadata to MLflow: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:26 - src.models.prediction_output - INFO - Logging prediction metadata to MLflow
2025-10-03 18:10:26 - src.models.prediction_output - ERROR - Failed to log prediction metadata to MLflow: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:26 - prefect.task_runs - ERROR - Task run failed with exception: OSError(30, 'Read-only file system') - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/prediction_output.py", line 182, in log_prediction_metadata_to_mlflow
    mlflow.log_artifact(predictions_csv)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/fluent.py", line 1429, in log_artifact
    MlflowClient().log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/client.py", line 2497, in log_artifact
    self._tracking_client.log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/_tracking_service/client.py", line 674, in log_artifact
    artifact_repo.log_artifact(local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/store/artifact/local_artifact_repo.py", line 44, in log_artifact
    mkdir(artifact_dir)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 209, in mkdir
    raise e
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 206, in mkdir
    os.makedirs(target, exist_ok=True)
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  [Previous line repeated 1 more time]
  File "<frozen os>", line 225, in makedirs
OSError: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:26 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:10:26 - prefect.task_runs - ERROR - Finished in state Failed("Task run encountered an exception OSError: [Errno 30] Read-only file system: '/mlflow'")
2025-10-03 18:10:26 - prefect.flow_runs - ERROR - Prediction flow failed: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:26 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 18:10:26 - prefect.flow_runs - ERROR - Encountered exception during execution: OSError(30, 'Read-only file system')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 247, in prediction_flow
    mlflow_run_id = log_prediction_metadata_to_mlflow(predictions)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/prediction_output.py", line 182, in log_prediction_metadata_to_mlflow
    mlflow.log_artifact(predictions_csv)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/fluent.py", line 1429, in log_artifact
    MlflowClient().log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/client.py", line 2497, in log_artifact
    self._tracking_client.log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/_tracking_service/client.py", line 674, in log_artifact
    artifact_repo.log_artifact(local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/store/artifact/local_artifact_repo.py", line 44, in log_artifact
    mkdir(artifact_dir)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 209, in mkdir
    raise e
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 206, in mkdir
    os.makedirs(target, exist_ok=True)
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  [Previous line repeated 1 more time]
  File "<frozen os>", line 225, in makedirs
OSError: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:10:26 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:10:26 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/35c87e5e-3a28-4cd7-8110-2f9fcc1b5606/set_state "HTTP/1.1 201 Created"
2025-10-03 18:10:26 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/35c87e5e-3a28-4cd7-8110-2f9fcc1b5606/set_state "HTTP/1.1 200 OK"
2025-10-03 18:10:27 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:11:26 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/35c87e5e-3a28-4cd7-8110-2f9fcc1b5606/set_state "HTTP/1.1 201 Created"
2025-10-03 18:11:26 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/35c87e5e-3a28-4cd7-8110-2f9fcc1b5606 "HTTP/1.1 200 OK"
2025-10-03 18:11:26 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:11:27 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:11:27 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:11:27 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:11:27 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:11:27 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:11:27 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:11:27 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:11:27 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:11:27 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:11:27 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:11:27 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:11:27 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:11:27 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:11:27 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:11:27 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 18:11:27 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:11:27 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 18:11:27 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:11:27 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:11:27 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 18:11:27 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:11:27 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:11:27 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 18:11:27 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 18:11:27 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:11:27 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:11:27 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_1.pkl
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_1.pkl
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=1)
2025-10-03 18:11:27 - src.models.predict - INFO - âœ“ Loaded model for horizon 1 from local file
2025-10-03 18:11:27 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_2
2025-10-03 18:11:27 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:11:27 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 2: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:11:27 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_2.pkl
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_2.pkl
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=2)
2025-10-03 18:11:27 - src.models.predict - INFO - âœ“ Loaded model for horizon 2 from local file
2025-10-03 18:11:27 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_3
2025-10-03 18:11:27 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:11:27 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 3: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:11:27 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_3.pkl
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_3.pkl
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=3)
2025-10-03 18:11:27 - src.models.predict - INFO - âœ“ Loaded model for horizon 3 from local file
2025-10-03 18:11:27 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_4
2025-10-03 18:11:27 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:11:27 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 4: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:11:27 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_4.pkl
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_4.pkl
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=4)
2025-10-03 18:11:27 - src.models.predict - INFO - âœ“ Loaded model for horizon 4 from local file
2025-10-03 18:11:27 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_5
2025-10-03 18:11:27 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:11:27 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 5: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:11:27 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_5.pkl
2025-10-03 18:11:27 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_5.pkl
2025-10-03 18:11:28 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:11:28 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=5)
2025-10-03 18:11:28 - src.models.predict - INFO - âœ“ Loaded model for horizon 5 from local file
2025-10-03 18:11:28 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_6
2025-10-03 18:11:28 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:11:28 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 6: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:11:28 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_6.pkl
2025-10-03 18:11:28 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_6.pkl
2025-10-03 18:11:28 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:11:28 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=6)
2025-10-03 18:11:28 - src.models.predict - INFO - âœ“ Loaded model for horizon 6 from local file
2025-10-03 18:11:28 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_7
2025-10-03 18:11:28 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:11:28 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 7: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:11:28 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_7.pkl
2025-10-03 18:11:28 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_7.pkl
2025-10-03 18:11:28 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:11:28 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=7)
2025-10-03 18:11:28 - src.models.predict - INFO - âœ“ Loaded model for horizon 7 from local file
2025-10-03 18:11:28 - src.models.predict - WARNING - Used local file fallback for model loading (running in local/test mode)
2025-10-03 18:11:28 - src.models.predict - INFO - Preparing features for prediction
2025-10-03 18:11:28 - src.models.predict - INFO - Base date for predictions: 2025-10-03
2025-10-03 18:11:28 - src.models.predict - INFO - Prepared features for 7 prediction days
2025-10-03 18:11:28 - src.models.predict - INFO - Prediction date range: 2025-10-04 to 2025-10-10
2025-10-03 18:11:28 - src.models.predict - INFO - Total columns in prediction features: 49
2025-10-03 18:11:28 - src.models.predict - INFO - All columns: ['Date', 'Patients_per_day', 'Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d']
2025-10-03 18:11:28 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:11:28 - src.models.predict - INFO - Feature columns selected: 47 features
2025-10-03 18:11:28 - src.models.predict - INFO - All feature columns: ['Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d']
2025-10-03 18:11:28 - src.models.predict - INFO - Excluded columns present: Date=True, Patients_per_day=True, target=False
2025-10-03 18:11:28 - src.models.predict - INFO - Generated 7 predictions
2025-10-03 18:11:28 - src.models.predict - INFO - Prediction range: 52.0 to 71.0 patients
2025-10-03 18:11:28 - src.monitoring.metrics_collector - INFO - Recorded prediction metrics: 7 predictions in 0.09s
2025-10-03 18:11:28 - src.models.prediction_output - INFO - Saving predictions to CSV
2025-10-03 18:11:28 - src.models.prediction_output - INFO - Predictions saved to: data/predictions/predictions_20251003_181128.csv
2025-10-03 18:11:28 - src.models.prediction_output - INFO - File size: 0.8 KB, Rows: 7
2025-10-03 18:11:28 - src.models.prediction_output - INFO - Logging prediction metadata to MLflow
2025-10-03 18:11:28 - src.models.prediction_output - ERROR - Failed to log prediction metadata to MLflow: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:11:28 - src.models.prediction_output - INFO - Logging prediction metadata to MLflow
2025-10-03 18:11:28 - src.models.prediction_output - ERROR - Failed to log prediction metadata to MLflow: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:11:28 - src.models.prediction_output - INFO - Logging prediction metadata to MLflow
2025-10-03 18:11:28 - src.models.prediction_output - ERROR - Failed to log prediction metadata to MLflow: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:11:28 - prefect.task_runs - ERROR - Task run failed with exception: OSError(30, 'Read-only file system') - Retries are exhausted
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/prediction_output.py", line 182, in log_prediction_metadata_to_mlflow
    mlflow.log_artifact(predictions_csv)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/fluent.py", line 1429, in log_artifact
    MlflowClient().log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/client.py", line 2497, in log_artifact
    self._tracking_client.log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/_tracking_service/client.py", line 674, in log_artifact
    artifact_repo.log_artifact(local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/store/artifact/local_artifact_repo.py", line 44, in log_artifact
    mkdir(artifact_dir)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 209, in mkdir
    raise e
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 206, in mkdir
    os.makedirs(target, exist_ok=True)
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  [Previous line repeated 1 more time]
  File "<frozen os>", line 225, in makedirs
OSError: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:11:28 - prefect.task_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:11:28 - prefect.task_runs - ERROR - Finished in state Failed("Task run encountered an exception OSError: [Errno 30] Read-only file system: '/mlflow'")
2025-10-03 18:11:28 - prefect.flow_runs - ERROR - Prediction flow failed: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:11:28 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - failure
2025-10-03 18:11:28 - prefect.flow_runs - ERROR - Encountered exception during execution: OSError(30, 'Read-only file system')
Traceback (most recent call last):
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 781, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 1395, in run_flow_sync
    engine.call_flow_fn()
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/flow_engine.py", line 801, in call_flow_fn
    result = call_with_parameters(self.flow.fn, self.parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/flows/prediction_flow.py", line 247, in prediction_flow
    mlflow_run_id = log_prediction_metadata_to_mlflow(predictions)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/tasks.py", line 1139, in __call__
    return run_task(
           ^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1739, in run_task
    return run_task_sync(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1514, in run_task_sync
    return engine.state if return_type == "state" else engine.result()
                                                       ^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 493, in result
    raise self._raised
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 871, in run_context
    yield self
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 1512, in run_task_sync
    engine.call_task_fn(txn)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/task_engine.py", line 888, in call_task_fn
    result = call_with_parameters(self.task.fn, parameters)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/prefect/utilities/callables.py", line 210, in call_with_parameters
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^
  File "/Users/olivergroth/Documents/GitHub/Region-V/src/models/prediction_output.py", line 182, in log_prediction_metadata_to_mlflow
    mlflow.log_artifact(predictions_csv)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/fluent.py", line 1429, in log_artifact
    MlflowClient().log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/client.py", line 2497, in log_artifact
    self._tracking_client.log_artifact(run_id, local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/tracking/_tracking_service/client.py", line 674, in log_artifact
    artifact_repo.log_artifact(local_path, artifact_path)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/store/artifact/local_artifact_repo.py", line 44, in log_artifact
    mkdir(artifact_dir)
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 209, in mkdir
    raise e
  File "/Users/olivergroth/Documents/GitHub/Region-V/.venv/lib/python3.11/site-packages/mlflow/utils/file_utils.py", line 206, in mkdir
    os.makedirs(target, exist_ok=True)
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  File "<frozen os>", line 215, in makedirs
  [Previous line repeated 1 more time]
  File "<frozen os>", line 225, in makedirs
OSError: [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:11:28 - prefect.flow_runs - WARNING - Failed to write result: [Errno 30] Read-only file system: '/prefect' Execution will continue, but the result has not been written
2025-10-03 18:11:28 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/35c87e5e-3a28-4cd7-8110-2f9fcc1b5606/set_state "HTTP/1.1 201 Created"
2025-10-03 18:11:28 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/35c87e5e-3a28-4cd7-8110-2f9fcc1b5606/set_state "HTTP/1.1 200 OK"
2025-10-03 18:11:29 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:12:00 - root - INFO - Logging configured successfully
2025-10-03 18:12:00 - root - INFO - Log level: INFO
2025-10-03 18:12:00 - root - INFO - Console logging: enabled
2025-10-03 18:12:00 - root - INFO - File logging: enabled (logs/app.log)
2025-10-03 18:12:00 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:12:00 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=143e06d7-c0da-4cee-ba75-196b2222301e "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:12:00 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:12:00 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:12:00 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/a7d4f883-12f5-4aba-8422-56186752d40f/set_state "HTTP/1.1 201 Created"
2025-10-03 18:12:00 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/a7d4f883-12f5-4aba-8422-56186752d40f "HTTP/1.1 200 OK"
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:12:00 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/ec93815b-5cd4-401c-b0aa-6b81240c2187 "HTTP/1.1 200 OK"
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:12:00 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:12:00 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:12:00 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:12:00 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:12:00 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-09-22
2025-10-03 18:12:00 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:12:01 - src.data.weather_integration - INFO - Successfully fetched weather data: 1218 days
2025-10-03 18:12:01 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:12:01 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:12:01 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-09-22
2025-10-03 18:12:01 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:12:01 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:12:01 - src.utils.mlflow_utils - INFO - Setting MLflow experiment: ER_Patient_Forecasting
2025-10-03 18:12:01 - src.utils.mlflow_utils - INFO - Using experiment: ER_Patient_Forecasting (ID: 1)
2025-10-03 18:12:01 - src.models.train - INFO - Starting training for horizon 1 days
2025-10-03 18:12:01 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:12:01 - src.models.train - INFO - Creating shifted target for horizon=1 days
2025-10-03 18:12:01 - src.models.train - INFO - Created target for horizon 1: 1189 samples (1 rows removed due to shifting)
2025-10-03 18:12:01 - src.models.train - INFO - Data split: Train=713 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:12:01 - src.models.train - INFO - Features: 47
2025-10-03 18:12:01 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:12:01 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:01 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:02 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:03 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:12:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:03 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:12:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:03 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:12:03 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:03 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:12:04 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:12:04 - src.models.train - INFO - Best validation MAE: 6.3611
2025-10-03 18:12:04 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:12:04 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Point model trained with 713 samples
2025-10-03 18:12:04 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:12:04 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:12:04 - src.models.evaluation - INFO - Evaluation: MAE=7.33, RMSE=10.50, Coverage=94.6%, Width=42.17
2025-10-03 18:12:04 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:12:04 - src.models.train - INFO -   MAE: 7.3256
2025-10-03 18:12:04 - src.models.train - INFO -   RMSE: 10.4966
2025-10-03 18:12:04 - src.models.train - INFO -   Coverage: 94.58%
2025-10-03 18:12:04 - src.models.train - INFO -   Interval Width: 42.17
2025-10-03 18:12:04 - src.models.train - INFO - Training complete for horizon 1
2025-10-03 18:12:04 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:12:04 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3611, test_mae=7.3256, test_rmse=10.4966, test_coverage=0.9458, test_interval_width=42.1705
2025-10-03 18:12:04 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 1: MAE=7.33, RMSE=10.50
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_1.pkl
2025-10-03 18:12:04 - src.models.lightgbm_model - INFO - Model saved successfully (189.4 KB)
2025-10-03 18:12:04 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:12:04 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_1
2025-10-03 18:12:04 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:04 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:04 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 1, stage Staging
2025-10-03 18:12:04 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:12:04 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:12:04 - src.models.model_promotion - INFO - Test MAE: 7.3256, Threshold: 15.0000
2025-10-03 18:12:04 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.3256 < 15.0000)
2025-10-03 18:12:05 - src.models.train - INFO - Starting training for horizon 2 days
2025-10-03 18:12:05 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:12:05 - src.models.train - INFO - Creating shifted target for horizon=2 days
2025-10-03 18:12:05 - src.models.train - INFO - Created target for horizon 2: 1188 samples (2 rows removed due to shifting)
2025-10-03 18:12:05 - src.models.train - INFO - Data split: Train=712 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=240 (20.2%)
2025-10-03 18:12:05 - src.models.train - INFO - Features: 47
2025-10-03 18:12:05 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:12:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:05 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:05 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:05 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:05 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:05 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:06 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:06 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:06 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:06 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:06 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=110c9b8e-8e50-4507-a50b-d9abfedc5574 "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:12:06 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:12:07 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:07 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:07 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:07 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:07 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:08 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:12:08 - src.models.train - INFO - Best validation MAE: 6.2331
2025-10-03 18:12:08 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 7, 'num_leaves': 20, 'learning_rate': 0.1788532743297921, 'min_child_samples': 30, 'subsample': 0.8500000000000001, 'colsample_bytree': 0.65, 'reg_alpha': 5.2, 'reg_lambda': 5.5, 'min_child_weight': 0.0054880470007660455}
2025-10-03 18:12:08 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=2)
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:08 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:12:08 - src.models.evaluation - INFO - Evaluating model on 240 test samples
2025-10-03 18:12:08 - src.models.evaluation - INFO - Evaluation: MAE=8.66, RMSE=11.60, Coverage=89.6%, Width=31.71
2025-10-03 18:12:08 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:12:08 - src.models.train - INFO -   MAE: 8.6611
2025-10-03 18:12:08 - src.models.train - INFO -   RMSE: 11.5989
2025-10-03 18:12:08 - src.models.train - INFO -   Coverage: 89.58%
2025-10-03 18:12:08 - src.models.train - INFO -   Interval Width: 31.71
2025-10-03 18:12:08 - src.models.train - INFO - Training complete for horizon 2
2025-10-03 18:12:08 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:12:08 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.2331, test_mae=8.6611, test_rmse=11.5989, test_coverage=0.8958, test_interval_width=31.7143
2025-10-03 18:12:08 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 2: MAE=8.66, RMSE=11.60
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_2.pkl
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Model saved successfully (204.9 KB)
2025-10-03 18:12:08 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:12:08 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_2
2025-10-03 18:12:08 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:08 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:08 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 2, stage Staging
2025-10-03 18:12:08 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:12:08 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:12:08 - src.models.model_promotion - INFO - Test MAE: 8.6611, Threshold: 15.0000
2025-10-03 18:12:08 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.6611 < 15.0000)
2025-10-03 18:12:08 - src.models.train - INFO - Starting training for horizon 3 days
2025-10-03 18:12:08 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:12:08 - src.models.train - INFO - Creating shifted target for horizon=3 days
2025-10-03 18:12:08 - src.models.train - INFO - Created target for horizon 3: 1187 samples (3 rows removed due to shifting)
2025-10-03 18:12:08 - src.models.train - INFO - Data split: Train=712 (60.0%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.1%)
2025-10-03 18:12:08 - src.models.train - INFO - Features: 47
2025-10-03 18:12:08 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:08 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:08 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:09 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:10 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:10 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:10 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:10 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:10 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:11 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:12:11 - src.models.train - INFO - Best validation MAE: 6.5140
2025-10-03 18:12:11 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:12:11 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=3)
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Point model trained with 712 samples
2025-10-03 18:12:11 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:12:11 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:12:12 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:12:12 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:12:12 - src.models.evaluation - INFO - Evaluation: MAE=7.54, RMSE=10.88, Coverage=94.6%, Width=40.68
2025-10-03 18:12:12 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:12:12 - src.models.train - INFO -   MAE: 7.5393
2025-10-03 18:12:12 - src.models.train - INFO -   RMSE: 10.8759
2025-10-03 18:12:12 - src.models.train - INFO -   Coverage: 94.56%
2025-10-03 18:12:12 - src.models.train - INFO -   Interval Width: 40.68
2025-10-03 18:12:12 - src.models.train - INFO - Training complete for horizon 3
2025-10-03 18:12:12 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:12:12 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5140, test_mae=7.5393, test_rmse=10.8759, test_coverage=0.9456, test_interval_width=40.6843
2025-10-03 18:12:12 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 3: MAE=7.54, RMSE=10.88
2025-10-03 18:12:12 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_3.pkl
2025-10-03 18:12:12 - src.models.lightgbm_model - INFO - Model saved successfully (188.8 KB)
2025-10-03 18:12:12 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:12:12 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_3
2025-10-03 18:12:12 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:12 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:12 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 3, stage Staging
2025-10-03 18:12:12 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:12:12 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:12:12 - src.models.model_promotion - INFO - Test MAE: 7.5393, Threshold: 15.0000
2025-10-03 18:12:12 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5393 < 15.0000)
2025-10-03 18:12:12 - src.models.train - INFO - Starting training for horizon 4 days
2025-10-03 18:12:12 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:12:12 - src.models.train - INFO - Creating shifted target for horizon=4 days
2025-10-03 18:12:12 - src.models.train - INFO - Created target for horizon 4: 1186 samples (4 rows removed due to shifting)
2025-10-03 18:12:12 - src.models.train - INFO - Data split: Train=711 (59.9%), Val=118 (9.9%), Calib=118 (9.9%), Test=239 (20.2%)
2025-10-03 18:12:12 - src.models.train - INFO - Features: 47
2025-10-03 18:12:12 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:12:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:12 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:12 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:12 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:12 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:13 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:12:13 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:13 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:13 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:13 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:13 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:14 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:14 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:14 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:14 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:14 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:15 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:15 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:15 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:12:15 - src.models.train - INFO - Best validation MAE: 6.6654
2025-10-03 18:12:15 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:12:15 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:12:15 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:12:15 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=4)
2025-10-03 18:12:16 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:16 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:12:16 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:12:16 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:12:16 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:12:16 - src.models.evaluation - INFO - Evaluating model on 239 test samples
2025-10-03 18:12:16 - src.models.evaluation - INFO - Evaluation: MAE=7.57, RMSE=11.08, Coverage=95.4%, Width=38.35
2025-10-03 18:12:16 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:12:16 - src.models.train - INFO -   MAE: 7.5740
2025-10-03 18:12:16 - src.models.train - INFO -   RMSE: 11.0843
2025-10-03 18:12:16 - src.models.train - INFO -   Coverage: 95.40%
2025-10-03 18:12:16 - src.models.train - INFO -   Interval Width: 38.35
2025-10-03 18:12:16 - src.models.train - INFO - Training complete for horizon 4
2025-10-03 18:12:16 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:12:16 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.6654, test_mae=7.5740, test_rmse=11.0843, test_coverage=0.9540, test_interval_width=38.3513
2025-10-03 18:12:16 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 4: MAE=7.57, RMSE=11.08
2025-10-03 18:12:16 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_4.pkl
2025-10-03 18:12:16 - src.models.lightgbm_model - INFO - Model saved successfully (663.3 KB)
2025-10-03 18:12:16 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:12:16 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_4
2025-10-03 18:12:16 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:16 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:16 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 4, stage Staging
2025-10-03 18:12:16 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:12:16 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:12:16 - src.models.model_promotion - INFO - Test MAE: 7.5740, Threshold: 15.0000
2025-10-03 18:12:16 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5740 < 15.0000)
2025-10-03 18:12:16 - src.models.train - INFO - Starting training for horizon 5 days
2025-10-03 18:12:16 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:12:16 - src.models.train - INFO - Creating shifted target for horizon=5 days
2025-10-03 18:12:16 - src.models.train - INFO - Created target for horizon 5: 1185 samples (5 rows removed due to shifting)
2025-10-03 18:12:16 - src.models.train - INFO - Data split: Train=711 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:12:16 - src.models.train - INFO - Features: 47
2025-10-03 18:12:16 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:12:16 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:16 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:17 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:17 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:18 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:18 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:18 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:18 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:19 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:19 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:19 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:19 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:12:19 - src.models.train - INFO - Best validation MAE: 6.5851
2025-10-03 18:12:19 - src.models.train - INFO - Best parameters: {'n_estimators': 220, 'max_depth': 12, 'num_leaves': 150, 'learning_rate': 0.030405325392865647, 'min_child_samples': 20, 'subsample': 0.55, 'colsample_bytree': 0.5, 'reg_alpha': 8.700000000000001, 'reg_lambda': 6.0, 'min_child_weight': 0.6796578090758157}
2025-10-03 18:12:19 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:12:19 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:12:19 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=5)
2025-10-03 18:12:20 - src.models.lightgbm_model - INFO - Point model trained with 711 samples
2025-10-03 18:12:20 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:12:20 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:12:20 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:12:20 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:12:20 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:12:20 - src.models.evaluation - INFO - Evaluation: MAE=8.03, RMSE=11.11, Coverage=95.8%, Width=46.27
2025-10-03 18:12:20 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:12:20 - src.models.train - INFO -   MAE: 8.0314
2025-10-03 18:12:20 - src.models.train - INFO -   RMSE: 11.1115
2025-10-03 18:12:20 - src.models.train - INFO -   Coverage: 95.80%
2025-10-03 18:12:20 - src.models.train - INFO -   Interval Width: 46.27
2025-10-03 18:12:20 - src.models.train - INFO - Training complete for horizon 5
2025-10-03 18:12:20 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:12:20 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5851, test_mae=8.0314, test_rmse=11.1115, test_coverage=0.9580, test_interval_width=46.2685
2025-10-03 18:12:20 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 5: MAE=8.03, RMSE=11.11
2025-10-03 18:12:20 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_5.pkl
2025-10-03 18:12:20 - src.models.lightgbm_model - INFO - Model saved successfully (492.5 KB)
2025-10-03 18:12:20 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:12:20 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_5
2025-10-03 18:12:20 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:20 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:20 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 5, stage Staging
2025-10-03 18:12:20 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:12:20 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:12:20 - src.models.model_promotion - INFO - Test MAE: 8.0314, Threshold: 15.0000
2025-10-03 18:12:20 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (8.0314 < 15.0000)
2025-10-03 18:12:20 - src.models.train - INFO - Starting training for horizon 6 days
2025-10-03 18:12:20 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:12:20 - src.models.train - INFO - Creating shifted target for horizon=6 days
2025-10-03 18:12:20 - src.models.train - INFO - Created target for horizon 6: 1184 samples (6 rows removed due to shifting)
2025-10-03 18:12:20 - src.models.train - INFO - Data split: Train=710 (60.0%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:12:20 - src.models.train - INFO - Features: 47
2025-10-03 18:12:20 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:12:20 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:20 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:21 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:21 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:22 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:12:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:22 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:12:22 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:22 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:12:23 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:12:23 - src.models.train - INFO - Best validation MAE: 6.5153
2025-10-03 18:12:23 - src.models.train - INFO - Best parameters: {'n_estimators': 100, 'max_depth': 10, 'num_leaves': 160, 'learning_rate': 0.024566974547738343, 'min_child_samples': 80, 'subsample': 0.75, 'colsample_bytree': 0.75, 'reg_alpha': 4.3, 'reg_lambda': 0.2, 'min_child_weight': 0.0027012557725439087}
2025-10-03 18:12:23 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:12:23 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=6)
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Point model trained with 710 samples
2025-10-03 18:12:24 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:12:24 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:12:24 - src.models.evaluation - INFO - Evaluation: MAE=7.51, RMSE=10.84, Coverage=94.1%, Width=42.82
2025-10-03 18:12:24 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:12:24 - src.models.train - INFO -   MAE: 7.5070
2025-10-03 18:12:24 - src.models.train - INFO -   RMSE: 10.8431
2025-10-03 18:12:24 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:12:24 - src.models.train - INFO -   Interval Width: 42.82
2025-10-03 18:12:24 - src.models.train - INFO - Training complete for horizon 6
2025-10-03 18:12:24 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:12:24 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.5153, test_mae=7.5070, test_rmse=10.8431, test_coverage=0.9412, test_interval_width=42.8245
2025-10-03 18:12:24 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 6: MAE=7.51, RMSE=10.84
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_6.pkl
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Model saved successfully (187.9 KB)
2025-10-03 18:12:24 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:12:24 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_6
2025-10-03 18:12:24 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:24 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:24 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 6, stage Staging
2025-10-03 18:12:24 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:12:24 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:12:24 - src.models.model_promotion - INFO - Test MAE: 7.5070, Threshold: 15.0000
2025-10-03 18:12:24 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.5070 < 15.0000)
2025-10-03 18:12:24 - src.models.train - INFO - Starting training for horizon 7 days
2025-10-03 18:12:24 - src.models.train - INFO - Data shape: (1190, 49), Optuna trials: 10
2025-10-03 18:12:24 - src.models.train - INFO - Creating shifted target for horizon=7 days
2025-10-03 18:12:24 - src.models.train - INFO - Created target for horizon 7: 1183 samples (7 rows removed due to shifting)
2025-10-03 18:12:24 - src.models.train - INFO - Data split: Train=709 (59.9%), Val=118 (10.0%), Calib=118 (10.0%), Test=238 (20.1%)
2025-10-03 18:12:24 - src.models.train - INFO - Features: 47
2025-10-03 18:12:24 - src.models.train - INFO - Starting Optuna hyperparameter search (10 trials)
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:24 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:25 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-03 18:12:25 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:12:25 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:25 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:25 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:12:25 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:25 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:25 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:12:25 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:25 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:26 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:12:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:26 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:26 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:12:26 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:26 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:27 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:12:27 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:27 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:28 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:12:28 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:28 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=1)
2025-10-03 18:12:28 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:12:28 - src.models.train - INFO - Optuna search complete!
2025-10-03 18:12:28 - src.models.train - INFO - Best validation MAE: 6.3625
2025-10-03 18:12:28 - src.models.train - INFO - Best parameters: {'n_estimators': 330, 'max_depth': 4, 'num_leaves': 70, 'learning_rate': 0.008082071885709252, 'min_child_samples': 50, 'subsample': 0.9, 'colsample_bytree': 0.6, 'reg_alpha': 5.1000000000000005, 'reg_lambda': 5.9, 'min_child_weight': 0.0015339162591163618}
2025-10-03 18:12:28 - src.models.train - INFO - Training final model with best parameters
2025-10-03 18:12:28 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:12:28 - src.models.lightgbm_model - INFO - Training point prediction model (horizon=7)
2025-10-03 18:12:28 - src.models.lightgbm_model - INFO - Point model trained with 709 samples
2025-10-03 18:12:28 - src.models.train - INFO - Training quantile models for confidence intervals
2025-10-03 18:12:28 - src.models.lightgbm_model - INFO - Training quantile regression models for confidence intervals
2025-10-03 18:12:28 - src.models.lightgbm_model - INFO - Quantiles: 0.025, 0.975 (95% CI)
2025-10-03 18:12:28 - src.models.lightgbm_model - INFO - Quantile models trained successfully
2025-10-03 18:12:28 - src.models.evaluation - INFO - Evaluating model on 238 test samples
2025-10-03 18:12:28 - src.models.evaluation - INFO - Evaluation: MAE=7.62, RMSE=10.94, Coverage=94.1%, Width=38.87
2025-10-03 18:12:28 - src.models.train - INFO - Test set evaluation:
2025-10-03 18:12:28 - src.models.train - INFO -   MAE: 7.6238
2025-10-03 18:12:28 - src.models.train - INFO -   RMSE: 10.9354
2025-10-03 18:12:28 - src.models.train - INFO -   Coverage: 94.12%
2025-10-03 18:12:28 - src.models.train - INFO -   Interval Width: 38.87
2025-10-03 18:12:28 - src.models.train - INFO - Training complete for horizon 7
2025-10-03 18:12:29 - src.utils.mlflow_utils - INFO - Logged 10 parameters to MLflow
2025-10-03 18:12:29 - src.utils.mlflow_utils - INFO - Logged metrics: best_val_mae=6.3625, test_mae=7.6238, test_rmse=10.9354, test_coverage=0.9412, test_interval_width=38.8694
2025-10-03 18:12:29 - src.monitoring.metrics_collector - INFO - Recorded training metrics for horizon 7: MAE=7.62, RMSE=10.94
2025-10-03 18:12:29 - src.models.lightgbm_model - INFO - Saving model to: models/forecaster_horizon_7.pkl
2025-10-03 18:12:29 - src.models.lightgbm_model - INFO - Model saved successfully (640.7 KB)
2025-10-03 18:12:29 - prefect.flow_runs - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:12:29 - src.utils.mlflow_utils - INFO - Registering model: er_forecast_horizon_7
2025-10-03 18:12:29 - src.utils.mlflow_utils - ERROR - Failed to register model: API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:29 - prefect.flow_runs - WARNING - Could not register model in MLflow (running locally): API request to endpoint /api/2.0/mlflow/logged-models/search failed with error code 404 != 200. Response body: '<!doctype html>
<html lang=en>
<title>404 Not Found</title>
<h1>Not Found</h1>
<p>The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.</p>
'
2025-10-03 18:12:29 - src.monitoring.metrics_collector - INFO - Recorded model registration: horizon 7, stage Staging
2025-10-03 18:12:29 - src.models.model_promotion - INFO - No production model found
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Evaluating model for promotion
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Test MAE: 7.6238, Threshold: 15.0000
2025-10-03 18:12:29 - src.models.model_promotion - INFO - âœ“ Model meets quality threshold (7.6238 < 15.0000)
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_1
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_2
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_3
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_4
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_5
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_6
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Archiving old model versions for: er_forecast_horizon_7
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Keeping most recent 52 versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - Found 0 total versions
2025-10-03 18:12:29 - src.models.model_promotion - INFO - No models to archive
2025-10-03 18:12:29 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/artifacts/ "HTTP/1.1 201 Created"
2025-10-03 18:12:29 - src.monitoring.metrics_collector - INFO - Recorded flow run status: training_flow - success
2025-10-03 18:12:29 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/a7d4f883-12f5-4aba-8422-56186752d40f/set_state "HTTP/1.1 201 Created"
2025-10-03 18:12:29 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/admin/version "HTTP/1.1 200 OK"
2025-10-03 18:12:29 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/csrf-token?client=11ccd73b-b6d0-4a9f-a1d7-9b53514e982b "HTTP/1.1 422 Unprocessable Entity"
2025-10-03 18:12:29 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flows/ "HTTP/1.1 200 OK"
2025-10-03 18:12:29 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/ "HTTP/1.1 201 Created"
2025-10-03 18:12:29 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/528b6c49-a1bc-44c0-8bda-ca2614904d56/set_state "HTTP/1.1 201 Created"
2025-10-03 18:12:29 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flow_runs/528b6c49-a1bc-44c0-8bda-ca2614904d56 "HTTP/1.1 200 OK"
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Loading raw data from: data/raw/emergency_visits.csv
2025-10-03 18:12:29 - httpx - INFO - HTTP Request: GET http://localhost:4200/api/flows/aba95944-47d3-4eb7-86a2-fc3b3f1ba70e "HTTP/1.1 200 OK"
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Successfully loaded 261,533 rows from data/raw/emergency_visits.csv
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Removing duplicates from 261,533 rows
2025-10-03 18:12:29 - src.data.preprocessing - WARNING - Found 189,003 duplicate rows (72.27%)
2025-10-03 18:12:29 - src.data.preprocessing - INFO - After removing duplicates: 72,530 rows remain
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Aggregating patient visits to daily counts
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Aggregated to 1,208 days
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Date range: 2022-05-24 00:00:00 to 2025-09-22 00:00:00
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Average patients per day: 60.0
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Min patients per day: 26
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Max patients per day: 104
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Checking for missing dates in time series
2025-10-03 18:12:29 - src.data.preprocessing - WARNING - Found 10 missing dates (0.82%)
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Filled 10 missing dates with 0 patient counts
2025-10-03 18:12:29 - src.data.preprocessing - INFO - Final time series: 1,218 days from 2022-05-24 to 2025-09-22
2025-10-03 18:12:29 - src.data.weather_integration - INFO - Fetching weather data from 2022-05-24 to 2025-10-03
2025-10-03 18:12:29 - src.data.weather_integration - INFO - Location: lat=59.6099, lon=16.5448
2025-10-03 18:12:30 - src.data.weather_integration - INFO - Successfully fetched weather data: 1229 days
2025-10-03 18:12:30 - src.data.weather_integration - INFO - Merging weather data with patient visit data
2025-10-03 18:12:30 - src.data.weather_integration - INFO - Patient data range: 2022-05-24 to 2025-09-22
2025-10-03 18:12:30 - src.data.weather_integration - INFO - Weather data range: 2022-05-24 to 2025-10-03
2025-10-03 18:12:30 - src.data.weather_integration - INFO - No missing weather data - perfect merge!
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Starting comprehensive feature engineering pipeline
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Adding date and time features with cyclic encoding
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Added 12 date/time features
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Adding weekend indicator
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Weekend days: 348/1218 (28.6%)
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Adding rolling statistics for windows: [3, 14, 30]
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Added 6 rolling statistics features
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Adding Fourier features for periods: [365.25, 7, 3.5, 2.3]
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Added 14 Fourier features
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Adding lag features: [1, 2, 3, 7, 14, 21, 28]
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Added 7 lag features
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Adding change features
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Added change features
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Feature engineering complete: added 42 features
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Final shape: (1218, 49)
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Removing rows with NaN values from feature engineering
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Found NaN values in 15 columns: ['patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg']...
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Rows with NaN: 28/1218 (2.3%)
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Removed 28 rows with NaN values
2025-10-03 18:12:30 - src.data.feature_engineering - INFO - Remaining rows: 1190
2025-10-03 18:12:30 - src.models.predict - INFO - Loading production models from MLflow Model Registry
2025-10-03 18:12:30 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_1
2025-10-03 18:12:30 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 1: No production model found for 'er_forecast_horizon_1'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_1.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_1.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=1 days
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=1)
2025-10-03 18:12:30 - src.models.predict - INFO - âœ“ Loaded model for horizon 1 from local file
2025-10-03 18:12:30 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_2
2025-10-03 18:12:30 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 2: No production model found for 'er_forecast_horizon_2'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_2.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_2.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=2 days
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=2)
2025-10-03 18:12:30 - src.models.predict - INFO - âœ“ Loaded model for horizon 2 from local file
2025-10-03 18:12:30 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_3
2025-10-03 18:12:30 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 3: No production model found for 'er_forecast_horizon_3'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_3.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_3.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=3 days
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=3)
2025-10-03 18:12:30 - src.models.predict - INFO - âœ“ Loaded model for horizon 3 from local file
2025-10-03 18:12:30 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_4
2025-10-03 18:12:30 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 4: No production model found for 'er_forecast_horizon_4'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_4.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_4.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=4 days
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=4)
2025-10-03 18:12:30 - src.models.predict - INFO - âœ“ Loaded model for horizon 4 from local file
2025-10-03 18:12:30 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_5
2025-10-03 18:12:30 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 5: No production model found for 'er_forecast_horizon_5'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_5.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_5.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=5 days
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=5)
2025-10-03 18:12:30 - src.models.predict - INFO - âœ“ Loaded model for horizon 5 from local file
2025-10-03 18:12:30 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_6
2025-10-03 18:12:30 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 6: No production model found for 'er_forecast_horizon_6'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_6.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_6.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=6 days
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=6)
2025-10-03 18:12:30 - src.models.predict - INFO - âœ“ Loaded model for horizon 6 from local file
2025-10-03 18:12:30 - src.utils.mlflow_utils - INFO - Loading production model: er_forecast_horizon_7
2025-10-03 18:12:30 - src.utils.mlflow_utils - ERROR - Failed to load production model: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - WARNING - Failed to load model from MLflow for horizon 7: No production model found for 'er_forecast_horizon_7'. Please promote a model to Production stage first.
2025-10-03 18:12:30 - src.models.predict - INFO - Falling back to local model file: models/forecaster_horizon_7.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Loading model from: models/forecaster_horizon_7.pkl
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Initialized LightGBMForecaster for horizon=7 days
2025-10-03 18:12:30 - src.models.lightgbm_model - INFO - Model loaded successfully (horizon=7)
2025-10-03 18:12:30 - src.models.predict - INFO - âœ“ Loaded model for horizon 7 from local file
2025-10-03 18:12:30 - src.models.predict - WARNING - Used local file fallback for model loading (running in local/test mode)
2025-10-03 18:12:30 - src.models.predict - INFO - Preparing features for prediction
2025-10-03 18:12:30 - src.models.predict - INFO - Base date for predictions: 2025-10-03
2025-10-03 18:12:30 - src.models.predict - INFO - Prepared features for 7 prediction days
2025-10-03 18:12:30 - src.models.predict - INFO - Prediction date range: 2025-10-04 to 2025-10-10
2025-10-03 18:12:30 - src.models.predict - INFO - Total columns in prediction features: 49
2025-10-03 18:12:30 - src.models.predict - INFO - All columns: ['Date', 'Patients_per_day', 'Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d']
2025-10-03 18:12:30 - src.models.predict - INFO - Generating batch predictions for next 7 days
2025-10-03 18:12:30 - src.models.predict - INFO - Feature columns selected: 47 features
2025-10-03 18:12:30 - src.models.predict - INFO - All feature columns: ['Temp_Max', 'Temp_Min', 'Temp_Mean', 'Precipitation', 'Snowfall', 'Day_of_week_sin', 'Day_of_week_cos', 'Month_sin', 'Month_cos', 'Day_of_month_sin', 'Day_of_month_cos', 'Day_of_week_1', 'Day_of_week_2', 'Day_of_week_3', 'Day_of_week_4', 'Day_of_week_5', 'Day_of_week_6', 'Weekend', 'patients_3d_avg', 'patients_3d_std', 'patients_14d_avg', 'patients_14d_std', 'patients_30d_avg', 'patients_30d_std', 'annual_sin_1', 'annual_cos_1', 'annual_sin_2', 'annual_cos_2', 'annual_sin_3', 'annual_cos_3', 'weekly_sin_1', 'weekly_cos_1', 'weekly_sin_2', 'weekly_cos_2', 'half_week_sin_1', 'half_week_cos_1', 'short_cycle_sin_1', 'short_cycle_cos_1', 'patients_lag_1', 'patients_lag_2', 'patients_lag_3', 'patients_lag_7', 'patients_lag_14', 'patients_lag_21', 'patients_lag_28', 'patients_change_1d', 'patients_change_7d']
2025-10-03 18:12:30 - src.models.predict - INFO - Excluded columns present: Date=True, Patients_per_day=True, target=False
2025-10-03 18:12:30 - src.models.predict - INFO - Generated 7 predictions
2025-10-03 18:12:30 - src.models.predict - INFO - Prediction range: 52.0 to 71.0 patients
2025-10-03 18:12:30 - src.monitoring.metrics_collector - INFO - Recorded prediction metrics: 7 predictions in 0.09s
2025-10-03 18:12:30 - src.models.prediction_output - INFO - Saving predictions to CSV
2025-10-03 18:12:30 - src.models.prediction_output - INFO - Predictions saved to: data/predictions/predictions_20251003_181230.csv
2025-10-03 18:12:30 - src.models.prediction_output - INFO - File size: 0.8 KB, Rows: 7
2025-10-03 18:12:30 - src.models.prediction_output - INFO - Logging prediction metadata to MLflow
2025-10-03 18:12:30 - src.models.prediction_output - WARNING - Skipping MLflow artifact logging (running locally): [Errno 30] Read-only file system: '/mlflow'
2025-10-03 18:12:30 - src.models.prediction_output - INFO - Prediction metadata logged to MLflow run: 50be122dd8d74f768c19f080a77727b9
2025-10-03 18:12:30 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/artifacts/ "HTTP/1.1 201 Created"
2025-10-03 18:12:30 - src.monitoring.metrics_collector - INFO - Recorded flow run status: prediction_flow - success
2025-10-03 18:12:30 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/flow_runs/528b6c49-a1bc-44c0-8bda-ca2614904d56/set_state "HTTP/1.1 201 Created"
2025-10-03 18:12:30 - httpx - INFO - HTTP Request: POST http://localhost:4200/api/logs/ "HTTP/1.1 201 Created"
2025-10-06 09:14:43 - root - INFO - Logging configured successfully
2025-10-06 09:14:43 - root - INFO - Log level: INFO
2025-10-06 09:14:43 - root - INFO - Console logging: enabled
2025-10-06 09:14:43 - root - INFO - File logging: enabled (logs/app.log)
2025-10-06 09:14:43 - src.monitoring.metrics_collector - INFO - Initializing metrics with default values...
2025-10-06 09:14:43 - src.monitoring.metrics_collector - INFO - Metrics initialization complete
2025-10-06 09:14:43 - src.monitoring.metrics_collector - INFO - Metrics server started on port 8000
2025-10-06 09:14:43 - src.monitoring.metrics_collector - INFO - Metrics available at http://0.0.0.0:8000/metrics
2025-10-06 09:14:43 - __main__ - INFO - Metrics server running. Press Ctrl+C to stop.
